(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))r(u);new MutationObserver(u=>{for(const i of u)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(u){const i={};return u.integrity&&(i.integrity=u.integrity),u.referrerPolicy&&(i.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?i.credentials="include":u.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(u){if(u.ep)return;u.ep=!0;const i=n(u);fetch(u.href,i)}})();function P(t){this.content=t}P.prototype={constructor:P,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,u=r.find(t),i=r.content.slice();return u==-1?i.push(n||t,e):(i[u+1]=e,n&&(i[u]=n)),new P(i)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new P(n)},addToStart:function(t,e){return new P([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new P(n)},addBefore:function(t,e,n){var r=this.remove(e),u=r.content.slice(),i=r.find(t);return u.splice(i==-1?u.length:i,0,e,n),new P(u)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=P.from(t),t.size?new P(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=P.from(t),t.size?new P(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=P.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};P.from=function(t){if(t instanceof P)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new P(e)};function ji(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let u=t.child(r),i=e.child(r);if(u==i){n+=u.nodeSize;continue}if(!u.sameMarkup(i))return n;if(u.isText&&u.text!=i.text){for(let s=0;u.text[s]==i.text[s];s++)n++;return n}if(u.content.size||i.content.size){let s=ji(u.content,i.content,n+1);if(s!=null)return s}n+=u.nodeSize}}function Ui(t,e,n,r){for(let u=t.childCount,i=e.childCount;;){if(u==0||i==0)return u==i?null:{a:n,b:r};let s=t.child(--u),o=e.child(--i),l=s.nodeSize;if(s==o){n-=l,r-=l;continue}if(!s.sameMarkup(o))return{a:n,b:r};if(s.isText&&s.text!=o.text){let a=0,c=Math.min(s.text.length,o.text.length);for(;a<c&&s.text[s.text.length-a-1]==o.text[o.text.length-a-1];)a++,n--,r--;return{a:n,b:r}}if(s.content.size||o.content.size){let a=Ui(s.content,o.content,n-1,r-1);if(a)return a}n-=l,r-=l}}class x{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,u=0,i){for(let s=0,o=0;o<n;s++){let l=this.content[s],a=o+l.nodeSize;if(a>e&&r(l,u+o,i||null,s)!==!1&&l.content.size){let c=o+1;l.nodesBetween(Math.max(0,e-c),Math.min(l.content.size,n-c),r,u+c)}o=a}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,u){let i="",s=!0;return this.nodesBetween(e,n,(o,l)=>{let a=o.isText?o.text.slice(Math.max(e,l)-l,n-l):o.isLeaf?u?typeof u=="function"?u(o):u:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&a||o.isTextblock)&&r&&(s?s=!1:i+=r),i+=a},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,u=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(u[u.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)u.push(e.content[i]);return new x(u,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],u=0;if(n>e)for(let i=0,s=0;s<n;i++){let o=this.content[i],l=s+o.nodeSize;l>e&&((s<e||l>n)&&(o.isText?o=o.cut(Math.max(0,e-s),Math.min(o.text.length,n-s)):o=o.cut(Math.max(0,e-s-1),Math.min(o.content.size,n-s-1))),r.push(o),u+=o.nodeSize),s=l}return new x(r,u)}cutByIndex(e,n){return e==n?x.empty:e==0&&n==this.content.length?this:new x(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let u=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return u[e]=n,new x(u,i)}addToStart(e){return new x([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new x(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let u=this.content[n];e(u,r,n),r+=u.nodeSize}}findDiffStart(e,n=0){return ji(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return Ui(this,e,n,r)}findIndex(e,n=-1){if(e==0)return sn(0,e);if(e==this.size)return sn(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,u=0;;r++){let i=this.child(r),s=u+i.nodeSize;if(s>=e)return s==e||n>0?sn(r+1,s):sn(r,u);u=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return x.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new x(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return x.empty;let n,r=0;for(let u=0;u<e.length;u++){let i=e[u];r+=i.nodeSize,u&&i.isText&&e[u-1].sameMarkup(i)?(n||(n=e.slice(0,u)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new x(n||e,r)}static from(e){if(!e)return x.empty;if(e instanceof x)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new x([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}x.empty=new x([],0);const Jn={index:0,offset:0};function sn(t,e){return Jn.index=t,Jn.offset=e,Jn}function xn(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!xn(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!xn(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}class M{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let u=0;u<e.length;u++){let i=e[u];if(this.eq(i))return e;if(this.type.excludes(i.type))n||(n=e.slice(0,u));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(n||(n=e.slice(0,u)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&xn(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let u=r.create(n.attrs);return r.checkAttrs(u.attrs),u}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return M.none;if(e instanceof M)return[e];let n=e.slice();return n.sort((r,u)=>r.type.rank-u.type.rank),n}}M.none=[];class yn extends Error{}class k{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=Zi(this.content,e+this.openStart,n);return r&&new k(r,this.openStart,this.openEnd)}removeBetween(e,n){return new k(Ki(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return k.empty;let r=n.openStart||0,u=n.openEnd||0;if(typeof r!="number"||typeof u!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new k(x.fromJSON(e,n.content),r,u)}static maxOpen(e,n=!0){let r=0,u=0;for(let i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.lastChild)u++;return new k(e,r,u)}}k.empty=new k(x.empty,0,0);function Ki(t,e,n){let{index:r,offset:u}=t.findIndex(e),i=t.maybeChild(r),{index:s,offset:o}=t.findIndex(n);if(u==e||i.isText){if(o!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(Ki(i.content,e-u-1,n-u-1)))}function Zi(t,e,n,r){let{index:u,offset:i}=t.findIndex(e),s=t.maybeChild(u);if(i==e||s.isText)return t.cut(0,e).append(n).append(t.cut(e));let o=Zi(s.content,e-i-1,n);return o&&t.replaceChild(u,s.copy(o))}function nl(t,e,n){if(n.openStart>t.depth)throw new yn("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new yn("Inconsistent open depths");return Gi(t,e,n,0)}function Gi(t,e,n,r){let u=t.index(r),i=t.node(r);if(u==e.index(r)&&r<t.depth-n.openStart){let s=Gi(t,e,n,r+1);return i.copy(i.content.replaceChild(u,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,o=s.content;return Ge(s,o.cut(0,t.parentOffset).append(n.content).append(o.cut(e.parentOffset)))}else{let{start:s,end:o}=rl(n,t);return Ge(i,Yi(t,s,o,e,r))}else return Ge(i,kn(t,e,r))}function Qi(t,e){if(!e.type.compatibleContent(t.type))throw new yn("Cannot join "+e.type.name+" onto "+t.type.name)}function kr(t,e,n){let r=t.node(n);return Qi(r,e.node(n)),r}function Ze(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Nt(t,e,n,r){let u=(e||t).node(n),i=0,s=e?e.index(n):u.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Ze(t.nodeAfter,r),i++));for(let o=i;o<s;o++)Ze(u.child(o),r);e&&e.depth==n&&e.textOffset&&Ze(e.nodeBefore,r)}function Ge(t,e){return t.type.checkContent(e),t.copy(e)}function Yi(t,e,n,r,u){let i=t.depth>u&&kr(t,e,u+1),s=r.depth>u&&kr(n,r,u+1),o=[];return Nt(null,t,u,o),i&&s&&e.index(u)==n.index(u)?(Qi(i,s),Ze(Ge(i,Yi(t,e,n,r,u+1)),o)):(i&&Ze(Ge(i,kn(t,e,u+1)),o),Nt(e,n,u,o),s&&Ze(Ge(s,kn(n,r,u+1)),o)),Nt(r,null,u,o),new x(o)}function kn(t,e,n){let r=[];if(Nt(null,t,n,r),t.depth>n){let u=kr(t,e,n+1);Ze(Ge(u,kn(t,e,n+1)),r)}return Nt(e,null,n,r),new x(r)}function rl(t,e){let n=e.depth-t.openStart,u=e.node(n).copy(t.content);for(let i=n-1;i>=0;i--)u=e.node(i).copy(x.from(u));return{start:u.resolveNoCache(t.openStart+n),end:u.resolveNoCache(u.content.size-t.openEnd-n)}}class Pt{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],u=e.child(n);return r?e.child(n).cut(r):u}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],u=n==0?0:this.path[n*3-1]+1;for(let i=0;i<e;i++)u+=r.child(i).nodeSize;return u}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return M.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),u=e.maybeChild(n);if(!r){let o=r;r=u,u=o}let i=r.marks;for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!u||!i[s].isInSet(u.marks))&&(i=i[s--].removeFromSet(i));return i}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,u=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!u||!r[i].isInSet(u.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Cn(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],u=0,i=n;for(let s=e;;){let{index:o,offset:l}=s.content.findIndex(i),a=i-l;if(r.push(s,o,u+l),!a||(s=s.child(o),s.isText))break;i=a-1,u+=l+1}return new Pt(n,r,i)}static resolveCached(e,n){let r=xu.get(e);if(r)for(let i=0;i<r.elts.length;i++){let s=r.elts[i];if(s.pos==n)return s}else xu.set(e,r=new ul);let u=r.elts[r.i]=Pt.resolve(e,n);return r.i=(r.i+1)%il,u}}class ul{constructor(){this.elts=[],this.i=0}}const il=12,xu=new WeakMap;class Cn{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const sl=Object.create(null);let Qe=class Cr{constructor(e,n,r,u=M.none){this.type=e,this.attrs=n,this.marks=u,this.content=r||x.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,u=0){this.content.nodesBetween(e,n,r,u,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,u){return this.content.textBetween(e,n,r,u)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&xn(this.attrs,n||e.defaultAttrs||sl)&&M.sameSet(this.marks,r||M.none)}copy(e=null){return e==this.content?this:new Cr(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Cr(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return k.empty;let u=this.resolve(e),i=this.resolve(n),s=r?0:u.sharedDepth(n),o=u.start(s),a=u.node(s).content.cut(u.pos-o,i.pos-o);return new k(a,u.depth-s,i.depth-s)}replace(e,n,r){return nl(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:u}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(u==e||n.isText)return n;e-=u+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let u=this.content.child(n-1);return{node:u,index:n-1,offset:r-u.nodeSize}}resolve(e){return Pt.resolveCached(this,e)}resolveNoCache(e){return Pt.resolve(this,e)}rangeHasMark(e,n,r){let u=!1;return n>e&&this.nodesBetween(e,n,i=>(r.isInSet(i.marks)&&(u=!0),!u)),u}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Xi(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=x.empty,u=0,i=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,u,i),o=s&&s.matchFragment(this.content,n);if(!o||!o.validEnd)return!1;for(let l=u;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,u){if(u&&!this.type.allowsMarks(u))return!1;let i=this.contentMatchAt(e).matchType(r),s=i&&i.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=M.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!M.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let u=x.fromJSON(e,n.content),i=e.nodeType(n.type).create(n.attrs,u,r);return i.type.checkAttrs(i.attrs),i}};Qe.prototype.text=void 0;class Dn extends Qe{constructor(e,n,r,u){if(super(e,n,null,u),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Xi(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Dn(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Dn(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Xi(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class tt{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new ol(e,n);if(r.next==null)return tt.empty;let u=es(r);r.next&&r.err("Unexpected trailing text");let i=pl(hl(u));return ml(i,r),i}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let u=this;for(let i=n;u&&i<r;i++)u=u.matchType(e.child(i).type);return u}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let u=[this];function i(s,o){let l=s.matchFragment(e,r);if(l&&(!n||l.validEnd))return x.from(o.map(a=>a.createAndFill()));for(let a=0;a<s.next.length;a++){let{type:c,next:f}=s.next[a];if(!(c.isText||c.hasRequiredAttrs())&&u.indexOf(f)==-1){u.push(f);let h=i(f,o.concat(c));if(h)return h}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let u=r.shift(),i=u.match;if(i.matchType(e)){let s=[];for(let o=u;o.type;o=o.via)s.push(o.type);return s.reverse()}for(let s=0;s<i.next.length;s++){let{type:o,next:l}=i.next[s];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in n)&&(!u.type||l.validEnd)&&(r.push({match:o.contentMatch,type:o,via:u}),n[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let u=0;u<r.next.length;u++)e.indexOf(r.next[u].next)==-1&&n(r.next[u].next)}return n(this),e.map((r,u)=>{let i=u+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)i+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return i}).join(`
`)}}tt.empty=new tt(!0);class ol{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function es(t){let e=[];do e.push(ll(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function ll(t){let e=[];do e.push(al(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function al(t){let e=dl(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=cl(t,e);else break;return e}function yu(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function cl(t,e){let n=yu(t),r=n;return t.eat(",")&&(t.next!="}"?r=yu(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function fl(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let u=[];for(let i in n){let s=n[i];s.isInGroup(e)&&u.push(s)}return u.length==0&&t.err("No node type or group '"+e+"' found"),u}function dl(t){if(t.eat("(")){let e=es(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=fl(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function hl(t){let e=[[]];return u(i(t,0),n()),e;function n(){return e.push([])-1}function r(s,o,l){let a={term:l,to:o};return e[s].push(a),a}function u(s,o){s.forEach(l=>l.to=o)}function i(s,o){if(s.type=="choice")return s.exprs.reduce((l,a)=>l.concat(i(a,o)),[]);if(s.type=="seq")for(let l=0;;l++){let a=i(s.exprs[l],o);if(l==s.exprs.length-1)return a;u(a,o=n())}else if(s.type=="star"){let l=n();return r(o,l),u(i(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=n();return u(i(s.expr,o),l),u(i(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(o)].concat(i(s.expr,o));if(s.type=="range"){let l=o;for(let a=0;a<s.min;a++){let c=n();u(i(s.expr,l),c),l=c}if(s.max==-1)u(i(s.expr,l),l);else for(let a=s.min;a<s.max;a++){let c=n();r(l,c),u(i(s.expr,l),c),l=c}return[r(l)]}else{if(s.type=="name")return[r(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function ts(t,e){return e-t}function ku(t,e){let n=[];return r(e),n.sort(ts);function r(u){let i=t[u];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(u);for(let s=0;s<i.length;s++){let{term:o,to:l}=i[s];!o&&n.indexOf(l)==-1&&r(l)}}}function pl(t){let e=Object.create(null);return n(ku(t,0));function n(r){let u=[];r.forEach(s=>{t[s].forEach(({term:o,to:l})=>{if(!o)return;let a;for(let c=0;c<u.length;c++)u[c][0]==o&&(a=u[c][1]);ku(t,l).forEach(c=>{a||u.push([o,a=[]]),a.indexOf(c)==-1&&a.push(c)})})});let i=e[r.join(",")]=new tt(r.indexOf(t.length-1)>-1);for(let s=0;s<u.length;s++){let o=u[s][1].sort(ts);i.next.push({type:u[s][0],next:e[o.join(",")]||n(o)})}return i}}function ml(t,e){for(let n=0,r=[t];n<r.length;n++){let u=r[n],i=!u.validEnd,s=[];for(let o=0;o<u.next.length;o++){let{type:l,next:a}=u.next[o];s.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(a)==-1&&r.push(a)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function ns(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function rs(t,e){let n=Object.create(null);for(let r in t){let u=e&&e[r];if(u===void 0){let i=t[r];if(i.hasDefault)u=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=u}return n}function us(t,e,n,r){for(let u in e)if(!(u in t))throw new RangeError(`Unsupported attribute ${u} for ${n} of type ${u}`);for(let u in t){let i=t[u];i.validate&&i.validate(e[u])}}function is(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new bl(t,r,e[r]);return n}let Cu=class ss{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=is(e,r.attrs),this.defaultAttrs=ns(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==tt.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:rs(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Qe(this,this.computeAttrs(e),x.from(n),M.setFrom(r))}createChecked(e=null,n,r){return n=x.from(n),this.checkContent(n),new Qe(this,this.computeAttrs(e),n,M.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=x.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let u=this.contentMatch.matchFragment(n),i=u&&u.fillBefore(x.empty,!0);return i?new Qe(this,e,n.append(i),M.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){us(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:M.none:e}static compile(e,n){let r=Object.create(null);e.forEach((i,s)=>r[i]=new ss(i,n,s));let u=n.spec.topNode||"doc";if(!r[u])throw new RangeError("Schema is missing its top node type ('"+u+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function gl(t,e,n){let r=n.split("|");return u=>{let i=u===null?"null":typeof u;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${i}`)}}class bl{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?gl(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class In{constructor(e,n,r,u){this.name=e,this.rank=n,this.schema=r,this.spec=u,this.attrs=is(e,u.attrs),this.excluded=null;let i=ns(this.attrs);this.instance=i?new M(this,i):null}create(e=null){return!e&&this.instance?this.instance:new M(this,rs(this.attrs,e))}static compile(e,n){let r=Object.create(null),u=0;return e.forEach((i,s)=>r[i]=new In(i,u++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){us(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class xl{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let u in e)n[u]=e[u];n.nodes=P.from(e.nodes),n.marks=P.from(e.marks||{}),this.nodes=Cu.compile(this.spec.nodes,this),this.marks=In.compile(this.spec.marks,this);let r=Object.create(null);for(let u in this.nodes){if(u in this.marks)throw new RangeError(u+" can not be both a node and a mark");let i=this.nodes[u],s=i.spec.content||"",o=i.spec.marks;if(i.contentMatch=r[s]||(r[s]=tt.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=o=="_"?null:o?Du(this,o.split(" ")):o==""||!i.inlineContent?[]:null}for(let u in this.marks){let i=this.marks[u],s=i.spec.excludes;i.excluded=s==null?[i]:s==""?[]:Du(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,u){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Cu){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,u)}text(e,n){let r=this.nodes.text;return new Dn(r,r.defaultAttrs,e,M.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return Qe.fromJSON(this,e)}markFromJSON(e){return M.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Du(t,e){let n=[];for(let r=0;r<e.length;r++){let u=e[r],i=t.marks[u],s=i;if(i)n.push(i);else for(let o in t.marks){let l=t.marks[o];(u=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(u)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function yl(t){return t.tag!=null}function kl(t){return t.style!=null}class Lt{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(u=>{if(yl(u))this.tags.push(u);else if(kl(u)){let i=/[^=]*/.exec(u.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(u)}}),this.normalizeLists=!this.tags.some(u=>{if(!/^(ul|ol)\b/.test(u.tag)||!u.node)return!1;let i=e.nodes[u.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new _u(this,n,!1);return r.addAll(e,M.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new _u(this,n,!0);return r.addAll(e,M.none,n.from,n.to),k.maxOpen(r.finish())}matchTag(e,n,r){for(let u=r?this.tags.indexOf(r)+1:0;u<this.tags.length;u++){let i=this.tags[u];if(wl(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){let s=i.getAttrs(e);if(s===!1)continue;i.attrs=s||void 0}return i}}}matchStyle(e,n,r,u){for(let i=u?this.styles.indexOf(u)+1:0;i<this.styles.length;i++){let s=this.styles[i],o=s.style;if(!(o.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=n))){if(s.getAttrs){let l=s.getAttrs(n);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let n=[];function r(u){let i=u.priority==null?50:u.priority,s=0;for(;s<n.length;s++){let o=n[s];if((o.priority==null?50:o.priority)<i)break}n.splice(s,0,u)}for(let u in e.marks){let i=e.marks[u].spec.parseDOM;i&&i.forEach(s=>{r(s=Eu(s)),s.mark||s.ignore||s.clearMark||(s.mark=u)})}for(let u in e.nodes){let i=e.nodes[u].spec.parseDOM;i&&i.forEach(s=>{r(s=Eu(s)),s.node||s.ignore||s.mark||(s.node=u)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Lt(e,Lt.schemaRules(e)))}}const ls={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Cl={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},as={ol:!0,ul:!0},qt=1,Dr=2,hn=4;function wu(t,e,n){return e!=null?(e?qt:0)|(e==="full"?Dr:0):t&&t.whitespace=="pre"?qt|Dr:n&-5}class on{constructor(e,n,r,u,i,s){this.type=e,this.attrs=n,this.marks=r,this.solid=u,this.options=s,this.content=[],this.activeMarks=M.none,this.match=i||(s&hn?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(x.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,u;return(u=r.findWrapping(e.type))?(this.match=r,u):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&qt)){let r=this.content[this.content.length-1],u;if(r&&r.isText&&(u=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==u[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-u[0].length))}}let n=x.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(x.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!ls.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class _u{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let u=n.topNode,i,s=wu(null,n.preserveWhitespace,0)|(r?hn:0);u?i=new on(u.type,u.attrs,M.none,!0,n.topMatch||u.type.contentMatch,s):r?i=new on(null,null,M.none,!0,null,s):i=new on(e.schema.topNodeType,null,M.none,!0,null,s),this.nodes=[i],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,u=this.top,i=u.options&Dr?"full":this.localPreserveWS||(u.options&qt)>0;if(i==="full"||u.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)i!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=u.content[u.content.length-1],o=e.previousSibling;(!s||o&&o.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let u=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),o;as.hasOwnProperty(s)&&this.parser.normalizeLists&&Dl(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,r));e:if(l?l.ignore:Cl.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let a,c=this.needsBlock;if(ls.hasOwnProperty(s))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),a=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let f=l&&l.skip?n:this.readStyles(e,n);f&&this.addAll(e,f),a&&this.sync(i),this.needsBlock=c}else{let a=this.readStyles(e,n);a&&this.addElementByRule(e,l,a,l.consuming===!1?o:void 0)}this.localPreserveWS=u}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let u=0;u<this.parser.matchedStyles.length;u++){let i=this.parser.matchedStyles[u],s=r.getPropertyValue(i);if(s)for(let o=void 0;;){let l=this.parser.matchStyle(i,s,this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(a=>!l.clearMark(a)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)o=l;else break}}return n}addElementByRule(e,n,r,u){let i,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r)||this.leafFallback(e,r);else{let l=this.enter(s,n.attrs||null,r,n.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(u)this.addElement(e,r,u);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(o)&&this.open--}addAll(e,n,r,u){let i=r||0;for(let s=r?e.childNodes[r]:e.firstChild,o=u==null?null:e.childNodes[u];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s,n);this.findAtPoint(e,i)}findPlace(e,n){let r,u;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!r||r.length>o.length)&&(r=o,u=s,!o.length)||s.solid)break}if(!r)return null;this.sync(u);for(let i=0;i<r.length;i++)n=this.enterInner(r[i],null,n,!1);return n}insertNode(e,n){if(e.isInline&&this.needsBlock&&!this.top.type){let u=this.textblockFromContext();u&&(n=this.enterInner(u,null,n))}let r=this.findPlace(e,n);if(r){this.closeExtra();let u=this.top;u.match&&(u.match=u.match.matchType(e.type));let i=M.none;for(let s of r.concat(e.marks))(u.type?u.type.allowsMarkType(s.type):Su(s.type,e.type))&&(i=s.addToSet(i));return u.content.push(e.mark(i)),!0}return!1}enter(e,n,r,u){let i=this.findPlace(e.create(n),r);return i&&(i=this.enterInner(e,n,r,!0,u)),i}enterInner(e,n,r,u=!1,i){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=wu(e,i,s.options);s.options&hn&&s.content.length==0&&(o|=hn);let l=M.none;return r=r.filter(a=>(s.type?s.type.allowsMarkType(a.type):Su(a.type,e))?(l=a.addToSet(l),!1):!0),this.nodes.push(new on(e,n,l,u,null,o)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=qt)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let u=r.length-1;u>=0;u--)e+=r[u].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let u=0;u<this.find.length;u++)this.find[u].pos==null&&e.nodeType==1&&e.contains(this.find[u].node)&&n.compareDocumentPosition(this.find[u].node)&(r?2:4)&&(this.find[u].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,u=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(u?0:1),s=(o,l)=>{for(;o>=0;o--){let a=n[o];if(a==""){if(o==n.length-1||o==0)continue;for(;l>=i;l--)if(s(o-1,l))return!0;return!1}else{let c=l>0||l==0&&u?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!c||c.name!=a&&!c.isInGroup(a))return!1;l--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function Dl(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&as.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function wl(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Eu(t){let e={};for(let n in t)e[n]=t[n];return e}function Su(t,e){let n=e.schema.nodes;for(let r in n){let u=n[r];if(!u.allowsMarkType(t))continue;let i=[],s=o=>{i.push(o);for(let l=0;l<o.edgeCount;l++){let{type:a,next:c}=o.edge(l);if(a==e||i.indexOf(c)<0&&s(c))return!0}};if(s(u.contentMatch))return!0}}class wt{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=jn(n).createDocumentFragment());let u=r,i=[];return e.forEach(s=>{if(i.length||s.marks.length){let o=0,l=0;for(;o<i.length&&l<s.marks.length;){let a=s.marks[l];if(!this.marks[a.type.name]){l++;continue}if(!a.eq(i[o][0])||a.type.spec.spanning===!1)break;o++,l++}for(;o<i.length;)u=i.pop()[1];for(;l<s.marks.length;){let a=s.marks[l++],c=this.serializeMark(a,s.isInline,n);c&&(i.push([a,u]),u.appendChild(c.dom),u=c.contentDOM||c.dom)}}u.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:u}=pn(jn(n),this.nodes[e.type.name](e),null,e.attrs);if(u){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,u)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let u=e.marks.length-1;u>=0;u--){let i=this.serializeMark(e.marks[u],e.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,n,r={}){let u=this.marks[e.type.name];return u&&pn(jn(r),u(e,n),null,e.attrs)}static renderSpec(e,n,r=null,u){return pn(e,n,r,u)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new wt(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=Au(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return Au(e.marks)}}function Au(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function jn(t){return t.document||window.document}const Mu=new WeakMap;function _l(t){let e=Mu.get(t);return e===void 0&&Mu.set(t,e=El(t)),e}function El(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let u=0;u<r.length;u++)n(r[u]);else for(let u in r)n(r[u])}return n(t),e}function pn(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let u=e[0],i;if(typeof u!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=_l(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=u.indexOf(" ");s>0&&(n=u.slice(0,s),u=u.slice(s+1));let o,l=n?t.createElementNS(n,u):t.createElement(u),a=e[1],c=1;if(a&&typeof a=="object"&&a.nodeType==null&&!Array.isArray(a)){c=2;for(let f in a)if(a[f]!=null){let h=f.indexOf(" ");h>0?l.setAttributeNS(f.slice(0,h),f.slice(h+1),a[f]):l.setAttribute(f,a[f])}}for(let f=c;f<e.length;f++){let h=e[f];if(h===0){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:d}=pn(t,h,n,r);if(l.appendChild(p),d){if(o)throw new RangeError("Multiple content holes");o=d}}}return{dom:l,contentDOM:o}}const cs=65535,fs=Math.pow(2,16);function Sl(t,e){return t+e*fs}function Ou(t){return t&cs}function Al(t){return(t-(t&cs))/fs}const ds=1,hs=2,mn=4,ps=8;class wr{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&ps)>0}get deletedBefore(){return(this.delInfo&(ds|mn))>0}get deletedAfter(){return(this.delInfo&(hs|mn))>0}get deletedAcross(){return(this.delInfo&mn)>0}}class ee{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&ee.empty)return ee.empty}recover(e){let n=0,r=Ou(e);if(!this.inverted)for(let u=0;u<r;u++)n+=this.ranges[u*3+2]-this.ranges[u*3+1];return this.ranges[r*3]+n+Al(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let u=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?u:0);if(l>e)break;let a=this.ranges[o+i],c=this.ranges[o+s],f=l+a;if(e<=f){let h=a?e==l?-1:e==f?1:n:n,p=l+u+(h<0?0:c);if(r)return p;let d=e==(n<0?l:f)?null:Sl(o/3,e-l),m=e==l?hs:e==f?ds:mn;return(n<0?e!=l:e!=f)&&(m|=ps),new wr(p,m,d)}u+=c-a}return r?e+u:new wr(e+u,0,null)}touches(e,n){let r=0,u=Ou(n),i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?r:0);if(l>e)break;let a=this.ranges[o+i],c=l+a;if(e<=c&&o==u*3)return!0;r+=this.ranges[o+s]-a}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let u=0,i=0;u<this.ranges.length;u+=3){let s=this.ranges[u],o=s-(this.inverted?i:0),l=s+(this.inverted?0:i),a=this.ranges[u+n],c=this.ranges[u+r];e(o,o+a,l,l+c),i+=c-a}}invert(){return new ee(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?ee.empty:new ee(e<0?[0,-e,0]:[0,0,e])}}ee.empty=new ee([]);class Vt{constructor(e,n,r=0,u=e?e.length:0){this.mirror=n,this.from=r,this.to=u,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Vt(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let u=e.getMirror(n);this.appendMap(e._maps[n],u!=null&&u<n?r+u:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let u=e.getMirror(n);this.appendMap(e._maps[n].invert(),u!=null&&u>n?r-u-1:void 0)}}invert(){let e=new Vt;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let u=0;for(let i=this.from;i<this.to;i++){let s=this._maps[i],o=s.mapResult(e,n);if(o.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(o.recover);continue}}u|=o.delInfo,e=o.pos}return r?e:new wr(e,u,null)}}const Un=Object.create(null);class j{getMap(){return ee.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Un[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Un)throw new RangeError("Duplicate use of step JSON ID "+e);return Un[e]=n,n.prototype.jsonID=e,n}}class v{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new v(e,null)}static fail(e){return new v(null,e)}static fromReplace(e,n,r,u){try{return v.ok(e.replace(n,r,u))}catch(i){if(i instanceof yn)return v.fail(i.message);throw i}}}function jr(t,e,n){let r=[];for(let u=0;u<t.childCount;u++){let i=t.child(u);i.content.size&&(i=i.copy(jr(i.content,e,i))),i.isInline&&(i=e(i,n,u)),r.push(i)}return x.fromArray(r)}class Re extends j{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),u=r.node(r.sharedDepth(this.to)),i=new k(jr(n.content,(s,o)=>!s.isAtom||!o.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),u),n.openStart,n.openEnd);return v.fromReplace(e,this.from,this.to,i)}invert(){return new me(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Re(n.pos,r.pos,this.mark)}merge(e){return e instanceof Re&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Re(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Re(n.from,n.to,e.markFromJSON(n.mark))}}j.jsonID("addMark",Re);class me extends j{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new k(jr(n.content,u=>u.mark(this.mark.removeFromSet(u.marks)),e),n.openStart,n.openEnd);return v.fromReplace(e,this.from,this.to,r)}invert(){return new Re(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new me(n.pos,r.pos,this.mark)}merge(e){return e instanceof me&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new me(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new me(n.from,n.to,e.markFromJSON(n.mark))}}j.jsonID("removeMark",me);class Be extends j{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return v.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return v.fromReplace(e,this.pos,this.pos+1,new k(x.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let u=0;u<n.marks.length;u++)if(!n.marks[u].isInSet(r))return new Be(this.pos,n.marks[u]);return new Be(this.pos,this.mark)}}return new gt(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Be(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Be(n.pos,e.markFromJSON(n.mark))}}j.jsonID("addNodeMark",Be);class gt extends j{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return v.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return v.fromReplace(e,this.pos,this.pos+1,new k(x.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Be(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new gt(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new gt(n.pos,e.markFromJSON(n.mark))}}j.jsonID("removeNodeMark",gt);class H extends j{constructor(e,n,r,u=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=u}apply(e){return this.structure&&_r(e,this.from,this.to)?v.fail("Structure replace would overwrite content"):v.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new ee([this.from,this.to-this.from,this.slice.size])}invert(e){return new H(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new H(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof H)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?k.empty:new k(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new H(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?k.empty:new k(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new H(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new H(n.from,n.to,k.fromJSON(e,n.slice),!!n.structure)}}j.jsonID("replace",H);class V extends j{constructor(e,n,r,u,i,s,o=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=u,this.slice=i,this.insert=s,this.structure=o}apply(e){if(this.structure&&(_r(e,this.from,this.gapFrom)||_r(e,this.gapTo,this.to)))return v.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return v.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?v.fromReplace(e,this.from,this.to,r):v.fail("Content does not fit in gap")}getMap(){return new ee([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new V(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),u=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||u<n.pos||i>r.pos?null:new V(n.pos,r.pos,u,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new V(n.from,n.to,n.gapFrom,n.gapTo,k.fromJSON(e,n.slice),n.insert,!!n.structure)}}j.jsonID("replaceAround",V);function _r(t,e,n){let r=t.resolve(e),u=n-e,i=r.depth;for(;u>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,u--;if(u>0){let s=r.node(i).maybeChild(r.indexAfter(i));for(;u>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,u--}}return!1}function Ml(t,e,n,r){let u=[],i=[],s,o;t.doc.nodesBetween(e,n,(l,a,c)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let h=Math.max(a,e),p=Math.min(a+l.nodeSize,n),d=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(d)||(s&&s.to==h&&s.mark.eq(f[m])?s.to=p:u.push(s=new me(h,p,f[m])));o&&o.to==h?o.to=p:i.push(o=new Re(h,p,r))}}),u.forEach(l=>t.step(l)),i.forEach(l=>t.step(l))}function Ol(t,e,n,r){let u=[],i=0;t.doc.nodesBetween(e,n,(s,o)=>{if(!s.isInline)return;i++;let l=null;if(r instanceof In){let a=s.marks,c;for(;c=r.isInSet(a);)(l||(l=[])).push(c),a=c.removeFromSet(a)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let a=Math.min(o+s.nodeSize,n);for(let c=0;c<l.length;c++){let f=l[c],h;for(let p=0;p<u.length;p++){let d=u[p];d.step==i-1&&f.eq(u[p].style)&&(h=d)}h?(h.to=a,h.step=i):u.push({style:f,from:Math.max(o,e),to:a,step:i})}}}),u.forEach(s=>t.step(new me(s.from,s.to,s.style)))}function Ur(t,e,n,r=n.contentMatch,u=!0){let i=t.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),c=o+a.nodeSize,f=r.matchType(a.type);if(!f)s.push(new H(o,c,k.empty));else{r=f;for(let h=0;h<a.marks.length;h++)n.allowsMarkType(a.marks[h].type)||t.step(new me(o,c,a.marks[h]));if(u&&a.isText&&n.whitespace!="pre"){let h,p=/\r?\n|\r/g,d;for(;h=p.exec(a.text);)d||(d=new k(x.from(n.schema.text(" ",n.allowedMarks(a.marks))),0,0)),s.push(new H(o+h.index,o+h.index+h[0].length,d))}}o=c}if(!r.validEnd){let l=r.fillBefore(x.empty,!0);t.replace(o,o,new k(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function Tl(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Yt(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let u=t.$from.node(r),i=t.$from.index(r),s=t.$to.indexAfter(r);if(r<t.depth&&u.canReplace(i,s,n))return r;if(r==0||u.type.spec.isolating||!Tl(u,i,s))break}return null}function Fl(t,e,n){let{$from:r,$to:u,depth:i}=e,s=r.before(i+1),o=u.after(i+1),l=s,a=o,c=x.empty,f=0;for(let d=i,m=!1;d>n;d--)m||r.index(d)>0?(m=!0,c=x.from(r.node(d).copy(c)),f++):l--;let h=x.empty,p=0;for(let d=i,m=!1;d>n;d--)m||u.after(d+1)<u.end(d)?(m=!0,h=x.from(u.node(d).copy(h)),p++):a++;t.step(new V(l,a,s,o,new k(c.append(h),f,p),c.size-f,!0))}function Kr(t,e,n=null,r=t){let u=Nl(t,e),i=u&&vl(r,e);return i?u.map(Tu).concat({type:e,attrs:n}).concat(i.map(Tu)):null}function Tu(t){return{type:t,attrs:null}}function Nl(t,e){let{parent:n,startIndex:r,endIndex:u}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let s=i.length?i[0]:e;return n.canReplaceWith(r,u,s)?i:null}function vl(t,e){let{parent:n,startIndex:r,endIndex:u}=t,i=n.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let a=r;l&&a<u;a++)l=l.matchType(n.child(a).type);return!l||!l.validEnd?null:s}function Il(t,e,n){let r=x.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let o=n[s].type.contentMatch.matchFragment(r);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=x.from(n[s].type.create(n[s].attrs,r))}let u=e.start,i=e.end;t.step(new V(u,i,u,i,new k(r,0,0),n.length,!0))}function Rl(t,e,n,r,u){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(s,o)=>{let l=typeof u=="function"?u(s):u;if(s.isTextblock&&!s.hasMarkup(r,l)&&Bl(t.doc,t.mapping.slice(i).map(o),r)){let a=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",d=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!d?a=!1:!p&&d&&(a=!0)}a===!1&&gs(t,s,o,i),Ur(t,t.mapping.slice(i).map(o,1),r,void 0,a===null);let c=t.mapping.slice(i),f=c.map(o,1),h=c.map(o+s.nodeSize,1);return t.step(new V(f,h,f+1,h-1,new k(x.from(r.create(l,null,s.marks)),0,0),1,!0)),a===!0&&ms(t,s,o,i),!1}})}function ms(t,e,n,r){e.forEach((u,i)=>{if(u.isText){let s,o=/\r?\n|\r/g;for(;s=o.exec(u.text);){let l=t.mapping.slice(r).map(n+1+i+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function gs(t,e,n,r){e.forEach((u,i)=>{if(u.type==u.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+i);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function Bl(t,e,n){let r=t.resolve(e),u=r.index();return r.parent.canReplaceWith(u,u+1,n)}function zl(t,e,n,r,u){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let s=n.create(r,null,u||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,s);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new V(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new k(x.from(s),0,0),1,!0))}function dt(t,e,n=1,r){let u=t.resolve(e),i=u.depth-n,s=r&&r[r.length-1]||u.parent;if(i<0||u.parent.type.spec.isolating||!u.parent.canReplace(u.index(),u.parent.childCount)||!s.type.validContent(u.parent.content.cutByIndex(u.index(),u.parent.childCount)))return!1;for(let a=u.depth-1,c=n-2;a>i;a--,c--){let f=u.node(a),h=u.index(a);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(h,f.childCount),d=r&&r[c+1];d&&(p=p.replaceChild(0,d.type.create(d.attrs)));let m=r&&r[c]||f;if(!f.canReplace(h+1,f.childCount)||!m.type.validContent(p))return!1}let o=u.indexAfter(i),l=r&&r[0];return u.node(i).canReplaceWith(o,o,l?l.type:u.node(i+1).type)}function Pl(t,e,n=1,r){let u=t.doc.resolve(e),i=x.empty,s=x.empty;for(let o=u.depth,l=u.depth-n,a=n-1;o>l;o--,a--){i=x.from(u.node(o).copy(i));let c=r&&r[a];s=x.from(c?c.type.create(c.attrs,s):u.node(o).copy(s))}t.step(new H(e,e,new k(i.append(s),n,n),!0))}function _t(t,e){let n=t.resolve(e),r=n.index();return bs(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Ll(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let u=0;u<e.childCount;u++){let i=e.child(u),s=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(i.marks))return!1}return n.validEnd}function bs(t,e){return!!(t&&e&&!t.isLeaf&&Ll(t,e))}function xs(t,e,n=-1){let r=t.resolve(e);for(let u=r.depth;;u--){let i,s,o=r.index(u);if(u==r.depth?(i=r.nodeBefore,s=r.nodeAfter):n>0?(i=r.node(u+1),o++,s=r.node(u).maybeChild(o)):(i=r.node(u).maybeChild(o-1),s=r.node(u+1)),i&&!i.isTextblock&&bs(i,s)&&r.node(u).canReplace(o,o+1))return e;if(u==0)break;e=n<0?r.before(u):r.after(u)}}function ql(t,e,n){let r=null,{linebreakReplacement:u}=t.doc.type.schema,i=t.doc.resolve(e-n),s=i.node().type;if(u&&s.inlineContent){let c=s.whitespace=="pre",f=!!s.contentMatch.matchType(u);c&&!f?r=!1:!c&&f&&(r=!0)}let o=t.steps.length;if(r===!1){let c=t.doc.resolve(e+n);gs(t,c.node(),c.before(),o)}s.inlineContent&&Ur(t,e+n-1,s,i.node().contentMatchAt(i.index()),r==null);let l=t.mapping.slice(o),a=l.map(e-n);if(t.step(new H(a,l.map(e+n,-1),k.empty,!0)),r===!0){let c=t.doc.resolve(a);ms(t,c.node(),c.before(),t.steps.length)}return t}function Vl(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let u=r.depth-1;u>=0;u--){let i=r.index(u);if(r.node(u).canReplaceWith(i,i,n))return r.before(u+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let u=r.depth-1;u>=0;u--){let i=r.indexAfter(u);if(r.node(u).canReplaceWith(i,i,n))return r.after(u+1);if(i<r.node(u).childCount)return null}return null}function ys(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let u=n.content;for(let i=0;i<n.openStart;i++)u=u.firstChild.content;for(let i=1;i<=(n.openStart==0&&n.size?2:1);i++)for(let s=r.depth;s>=0;s--){let o=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(o>0?1:0),a=r.node(s),c=!1;if(i==1)c=a.canReplace(l,l,u);else{let f=a.contentMatchAt(l).findWrapping(u.firstChild.type);c=f&&a.canReplaceWith(l,l,f[0])}if(c)return o==0?r.pos:o<0?r.before(s+1):r.after(s+1)}return null}function Zr(t,e,n=e,r=k.empty){if(e==n&&!r.size)return null;let u=t.resolve(e),i=t.resolve(n);return ks(u,i,r)?new H(e,n,r):new $l(u,i,r).fit()}function ks(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class $l{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=x.empty;for(let u=0;u<=e.depth;u++){let i=e.node(u);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(u))})}for(let u=e.depth;u>0;u--)this.placed=x.from(e.node(u).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let a=this.findFittable();a?this.placeNodes(a):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,u=this.close(e<0?this.$to:r.doc.resolve(e));if(!u)return null;let i=this.placed,s=r.depth,o=u.depth;for(;s&&o&&i.childCount==1;)i=i.firstChild.content,s--,o--;let l=new k(i,s,o);return e>-1?new V(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new H(r.pos,u.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,u=this.unplaced.openEnd;r<e;r++){let i=n.firstChild;if(n.childCount>1&&(u=0),i.type.spec.isolating&&u<=r){e=r;break}n=i.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let u,i=null;r?(i=Kn(this.unplaced.content,r-1).firstChild,u=i.content):u=this.unplaced.content;let s=u.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:a}=this.frontier[o],c,f=null;if(n==1&&(s?a.matchType(s.type)||(f=a.fillBefore(x.from(s),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:o,parent:i,inject:f};if(n==2&&s&&(c=a.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:o,parent:i,wrap:c};if(i&&a.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,u=Kn(e,n);return!u.childCount||u.firstChild.isLeaf?!1:(this.unplaced=new k(e,n+1,Math.max(r,u.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,u=Kn(e,n);if(u.childCount<=1&&n>0){let i=e.size-n<=n+u.size;this.unplaced=new k(Ot(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new k(Ot(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:u,wrap:i}){for(;this.depth>n;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let s=this.unplaced,o=r?r.content:s.content,l=s.openStart-e,a=0,c=[],{match:f,type:h}=this.frontier[n];if(u){for(let m=0;m<u.childCount;m++)c.push(u.child(m));f=f.matchFragment(u)}let p=o.size+e-(s.content.size-s.openEnd);for(;a<o.childCount;){let m=o.child(a),g=f.matchType(m.type);if(!g)break;a++,(a>1||l==0||m.content.size)&&(f=g,c.push(Cs(m.mark(h.allowedMarks(m.marks)),a==1?l:0,a==o.childCount?p:-1)))}let d=a==o.childCount;d||(p=-1),this.placed=Tt(this.placed,n,x.from(c)),this.frontier[n].match=f,d&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=o;m<p;m++){let b=g.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),g=b.content}this.unplaced=d?e==0?k.empty:new k(Ot(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new k(Ot(s.content,e,a),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Zn(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,u=this.$to.after(r);for(;r>1&&u==this.$to.end(--r);)++u;return u}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:u}=this.frontier[n],i=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=Zn(e,n,u,r,i);if(s){for(let o=n-1;o>=0;o--){let{match:l,type:a}=this.frontier[o],c=Zn(e,o,a,l,!0);if(!c||c.childCount)continue e}return{depth:n,fit:s,move:i?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Tt(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let u=e.node(r),i=u.type.contentMatch.fillBefore(u.content,!0,e.index(r));this.openFrontierNode(u.type,u.attrs,i)}return e}openFrontierNode(e,n=null,r){let u=this.frontier[this.depth];u.match=u.match.matchType(e),this.placed=Tt(this.placed,this.depth,x.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(x.empty,!0);n.childCount&&(this.placed=Tt(this.placed,this.frontier.length,n))}}function Ot(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Ot(t.firstChild.content,e-1,n)))}function Tt(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Tt(t.lastChild.content,e-1,n)))}function Kn(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function Cs(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,Cs(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(x.empty,!0)))),t.copy(r)}function Zn(t,e,n,r,u){let i=t.node(e),s=u?t.indexAfter(e):t.index(e);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let o=r.fillBefore(i.content,!0,s);return o&&!Wl(n,i.content,s)?o:null}function Wl(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function Hl(t){return t.spec.defining||t.spec.definingForContent}function Jl(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let u=t.doc.resolve(e),i=t.doc.resolve(n);if(ks(u,i,r))return t.step(new H(e,n,r));let s=ws(u,t.doc.resolve(n));s[s.length-1]==0&&s.pop();let o=-(u.depth+1);s.unshift(o);for(let h=u.depth,p=u.pos-1;h>0;h--,p--){let d=u.node(h).type.spec;if(d.defining||d.definingAsContext||d.isolating)break;s.indexOf(h)>-1?o=h:u.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(o),a=[],c=r.openStart;for(let h=r.content,p=0;;p++){let d=h.firstChild;if(a.push(d),p==r.openStart)break;h=d.content}for(let h=c-1;h>=0;h--){let p=a[h],d=Hl(p.type);if(d&&!p.sameMarkup(u.node(Math.abs(o)-1)))c=h;else if(d||!p.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let p=(h+c+1)%(r.openStart+1),d=a[p];if(d)for(let m=0;m<s.length;m++){let g=s[(m+l)%s.length],b=!0;g<0&&(b=!1,g=-g);let y=u.node(g-1),C=u.index(g-1);if(y.canReplaceWith(C,C,d.type,d.marks))return t.replace(u.before(g),b?i.after(g):n,new k(Ds(r.content,0,r.openStart,p),p,r.openEnd))}}let f=t.steps.length;for(let h=s.length-1;h>=0&&(t.replace(e,n,r),!(t.steps.length>f));h--){let p=s[h];p<0||(e=u.before(p),n=i.after(p))}}function Ds(t,e,n,r,u){if(e<n){let i=t.firstChild;t=t.replaceChild(0,i.copy(Ds(i.content,e+1,n,r,i)))}if(e>r){let i=u.contentMatchAt(0),s=i.fillBefore(t).append(t);t=s.append(i.matchFragment(s).fillBefore(x.empty,!0))}return t}function jl(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let u=Vl(t.doc,e,r.type);u!=null&&(e=n=u)}t.replaceRange(e,n,new k(x.from(r),0,0))}function Ul(t,e,n){let r=t.doc.resolve(e),u=t.doc.resolve(n),i=ws(r,u);for(let s=0;s<i.length;s++){let o=i[s],l=s==i.length-1;if(l&&o==0||r.node(o).type.contentMatch.validEnd)return t.delete(r.start(o),u.end(o));if(o>0&&(l||r.node(o-1).canReplace(r.index(o-1),u.indexAfter(o-1))))return t.delete(r.before(o),u.after(o))}for(let s=1;s<=r.depth&&s<=u.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&u.end(s)-n!=u.depth-s&&r.start(s-1)==u.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),u.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function ws(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let u=r;u>=0;u--){let i=t.start(u);if(i<t.pos-(t.depth-u)||e.end(u)>e.pos+(e.depth-u)||t.node(u).type.spec.isolating||e.node(u).type.spec.isolating)break;(i==e.start(u)||u==t.depth&&u==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&u&&e.start(u-1)==i-1)&&n.push(u)}return n}class ht extends j{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return v.fail("No node at attribute step's position");let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let u=n.type.create(r,null,n.marks);return v.fromReplace(e,this.pos,this.pos+1,new k(x.from(u),0,n.isLeaf?0:1))}getMap(){return ee.empty}invert(e){return new ht(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ht(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ht(n.pos,n.attr,n.value)}}j.jsonID("attr",ht);class $t extends j{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let u in e.attrs)n[u]=e.attrs[u];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return v.ok(r)}getMap(){return ee.empty}invert(e){return new $t(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new $t(n.attr,n.value)}}j.jsonID("docAttr",$t);let bt=class extends Error{};bt=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};bt.prototype=Object.create(Error.prototype);bt.prototype.constructor=bt;bt.prototype.name="TransformError";class Kl{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Vt}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new bt(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=k.empty){let u=Zr(this.doc,e,n,r);return u&&this.step(u),this}replaceWith(e,n,r){return this.replace(e,n,new k(x.from(r),0,0))}delete(e,n){return this.replace(e,n,k.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return Jl(this,e,n,r),this}replaceRangeWith(e,n,r){return jl(this,e,n,r),this}deleteRange(e,n){return Ul(this,e,n),this}lift(e,n){return Fl(this,e,n),this}join(e,n=1){return ql(this,e,n),this}wrap(e,n){return Il(this,e,n),this}setBlockType(e,n=e,r,u=null){return Rl(this,e,n,r,u),this}setNodeMarkup(e,n,r=null,u){return zl(this,e,n,r,u),this}setNodeAttribute(e,n,r){return this.step(new ht(e,n,r)),this}setDocAttribute(e,n){return this.step(new $t(e,n)),this}addNodeMark(e,n){return this.step(new Be(e,n)),this}removeNodeMark(e,n){if(!(n instanceof M)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new gt(e,n)),this}split(e,n=1,r){return Pl(this,e,n,r),this}addMark(e,n,r){return Ml(this,e,n,r),this}removeMark(e,n,r){return Ol(this,e,n,r),this}clearIncompatible(e,n,r){return Ur(this,e,n,r),this}}const Gn=Object.create(null);class A{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new Zl(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=k.empty){let r=n.content.lastChild,u=null;for(let o=0;o<n.openEnd;o++)u=r,r=r.lastChild;let i=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:l,$to:a}=s[o],c=e.mapping.slice(i);e.replaceRange(c.map(l.pos),c.map(a.pos),o?k.empty:n),o==0&&vu(e,i,(r?r.isInline:u&&u.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,u=this.ranges;for(let i=0;i<u.length;i++){let{$from:s,$to:o}=u[i],l=e.mapping.slice(r),a=l.map(s.pos),c=l.map(o.pos);i?e.deleteRange(a,c):(e.replaceRangeWith(a,c,n),vu(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let u=e.parent.inlineContent?new O(e):at(e.node(0),e.parent,e.pos,e.index(),n,r);if(u)return u;for(let i=e.depth-1;i>=0;i--){let s=n<0?at(e.node(0),e.node(i),e.before(i+1),e.index(i),n,r):at(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new te(e.node(0))}static atStart(e){return at(e,e,0,0,1)||new te(e)}static atEnd(e){return at(e,e,e.content.size,e.childCount,-1)||new te(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Gn[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Gn)throw new RangeError("Duplicate use of selection JSON ID "+e);return Gn[e]=n,n.prototype.jsonID=e,n}getBookmark(){return O.between(this.$anchor,this.$head).getBookmark()}}A.prototype.visible=!0;class Zl{constructor(e,n){this.$from=e,this.$to=n}}let Fu=!1;function Nu(t){!Fu&&!t.parent.inlineContent&&(Fu=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class O extends A{constructor(e,n=e){Nu(e),Nu(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return A.near(r);let u=e.resolve(n.map(this.anchor));return new O(u.parent.inlineContent?u:r,r)}replace(e,n=k.empty){if(super.replace(e,n),n==k.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof O&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Rn(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new O(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let u=e.resolve(n);return new this(u,r==n?u:e.resolve(r))}static between(e,n,r){let u=e.pos-n.pos;if((!r||u)&&(r=u>=0?1:-1),!n.parent.inlineContent){let i=A.findFrom(n,r,!0)||A.findFrom(n,-r,!0);if(i)n=i.$head;else return A.near(n,r)}return e.parent.inlineContent||(u==0?e=n:(e=(A.findFrom(e,-r,!0)||A.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=u<0&&(e=n))),new O(e,n)}}A.jsonID("text",O);class Rn{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Rn(e.map(this.anchor),e.map(this.head))}resolve(e){return O.between(e.resolve(this.anchor),e.resolve(this.head))}}class w extends A{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:u}=n.mapResult(this.anchor),i=e.resolve(u);return r?A.near(i):new w(i)}content(){return new k(x.from(this.node),0,0)}eq(e){return e instanceof w&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Gr(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new w(e.resolve(n.anchor))}static create(e,n){return new w(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}w.prototype.visible=!1;A.jsonID("node",w);class Gr{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Rn(r,r):new Gr(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&w.isSelectable(r)?new w(n):A.near(n)}}class te extends A{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=k.empty){if(n==k.empty){e.delete(0,e.doc.content.size);let r=A.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new te(e)}map(e){return new te(e)}eq(e){return e instanceof te}getBookmark(){return Gl}}A.jsonID("all",te);const Gl={map(){return this},resolve(t){return new te(t)}};function at(t,e,n,r,u,i=!1){if(e.inlineContent)return O.create(t,n);for(let s=r-(u>0?0:1);u>0?s<e.childCount:s>=0;s+=u){let o=e.child(s);if(o.isAtom){if(!i&&w.isSelectable(o))return w.create(t,n-(u<0?o.nodeSize:0))}else{let l=at(t,o,n+u,u<0?o.childCount:0,u,i);if(l)return l}n+=o.nodeSize*u}return null}function vu(t,e,n){let r=t.steps.length-1;if(r<e)return;let u=t.steps[r];if(!(u instanceof H||u instanceof V))return;let i=t.mapping.maps[r],s;i.forEach((o,l,a,c)=>{s==null&&(s=c)}),t.setSelection(A.near(t.doc.resolve(s),n))}const Iu=1,Ru=2,Bu=4;class Ql extends Kl{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Iu)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&Iu)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Ru,this}ensureMarks(e){return M.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Ru)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||M.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let u=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(u.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let i=this.storedMarks;if(!i){let s=this.doc.resolve(n);i=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,u.text(e,i)),this.selection.empty||this.setSelection(A.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Bu,this}get scrolledIntoView(){return(this.updated&Bu)>0}}function zu(t,e){return!e||!t?t:t.bind(e)}class Ft{constructor(e,n,r){this.name=e,this.init=zu(n.init,r),this.apply=zu(n.apply,r)}}const Yl=[new Ft("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Ft("selection",{init(t,e){return t.selection||A.atStart(e.doc)},apply(t){return t.selection}}),new Ft("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Ft("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Qn{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Yl.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Ft(r.key,r.spec.state,r))})}}class ft{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let u=this.config.plugins[r];if(u.spec.filterTransaction&&!u.spec.filterTransaction.call(u,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),u=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let l=u?u[s].n:0,a=u?u[s].state:this,c=l<n.length&&o.spec.appendTransaction.call(o,l?n.slice(l):n,a,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!u){u=[];for(let f=0;f<this.config.plugins.length;f++)u.push(f<s?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),i=!0}u&&(u[s]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new ft(this.config),r=this.config.fields;for(let u=0;u<r.length;u++){let i=r[u];n[i.name]=i.apply(e,this[i.name],this,n)}return n}get tr(){return new Ql(this)}static create(e){let n=new Qn(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ft(n);for(let u=0;u<n.fields.length;u++)r[n.fields[u].name]=n.fields[u].init(e,r);return r}reconfigure(e){let n=new Qn(this.schema,e.plugins),r=n.fields,u=new ft(n);for(let i=0;i<r.length;i++){let s=r[i].name;u[s]=this.hasOwnProperty(s)?this[s]:r[i].init(e,u)}return u}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let u=e[r],i=u.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(u,this[u.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let u=new Qn(e.schema,e.plugins),i=new ft(u);return u.fields.forEach(s=>{if(s.name=="doc")i.doc=Qe.fromJSON(e.schema,n.doc);else if(s.name=="selection")i.selection=A.fromJSON(i.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let o in r){let l=r[o],a=l.spec.state;if(l.key==s.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(n,o)){i[s.name]=a.fromJSON.call(l,e,n[o],i);return}}i[s.name]=s.init(e,i)}}),i}}function _s(t,e,n){for(let r in t){let u=t[r];u instanceof Function?u=u.bind(e):r=="handleDOMEvents"&&(u=_s(u,e,{})),n[r]=u}return n}class ut{constructor(e){this.spec=e,this.props={},e.props&&_s(e.props,this,this.props),this.key=e.key?e.key.key:Es("plugin")}getState(e){return e[this.key]}}const Yn=Object.create(null);function Es(t){return t in Yn?t+"$"+ ++Yn[t]:(Yn[t]=0,t+"$")}class Ss{constructor(e="key"){this.key=Es(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const L=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},xt=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Er=null;const we=function(t,e,n){let r=Er||(Er=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},Xl=function(){Er=null},nt=function(t,e,n,r){return n&&(Pu(t,e,n,r,-1)||Pu(t,e,n,r,1))},ea=/^(img|br|input|textarea|hr)$/i;function Pu(t,e,n,r,u){for(;;){if(t==n&&e==r)return!0;if(e==(u<0?0:se(t))){let i=t.parentNode;if(!i||i.nodeType!=1||Xt(t)||ea.test(t.nodeName)||t.contentEditable=="false")return!1;e=L(t)+(u<0?0:1),t=i}else if(t.nodeType==1){if(t=t.childNodes[e+(u<0?-1:0)],t.contentEditable=="false")return!1;e=u<0?se(t):0}else return!1}}function se(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ta(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=se(t)}else if(t.parentNode&&!Xt(t))e=L(t),t=t.parentNode;else return null}}function na(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Xt(t))e=L(t)+1,t=t.parentNode;else return null}}function ra(t,e,n){for(let r=e==0,u=e==se(t);r||u;){if(t==n)return!0;let i=L(t);if(t=t.parentNode,!t)return!1;r=r&&i==0,u=u&&i==se(t)}}function Xt(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Bn=function(t){return t.focusNode&&nt(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function je(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function ua(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function ia(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(se(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(se(r.startContainer),r.startOffset)}}}const xe=typeof navigator<"u"?navigator:null,Lu=typeof document<"u"?document:null,He=xe&&xe.userAgent||"",Sr=/Edge\/(\d+)/.exec(He),As=/MSIE \d/.exec(He),Ar=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(He),Y=!!(As||Ar||Sr),Le=As?document.documentMode:Ar?+Ar[1]:Sr?+Sr[1]:0,fe=!Y&&/gecko\/(\d+)/i.test(He);fe&&+(/Firefox\/(\d+)/.exec(He)||[0,0])[1];const Mr=!Y&&/Chrome\/(\d+)/.exec(He),J=!!Mr,Ms=Mr?+Mr[1]:0,U=!Y&&!!xe&&/Apple Computer/.test(xe.vendor),yt=U&&(/Mobile\/\w+/.test(He)||!!xe&&xe.maxTouchPoints>2),ue=yt||(xe?/Mac/.test(xe.platform):!1),sa=xe?/Win/.test(xe.platform):!1,Ee=/Android \d/.test(He),en=!!Lu&&"webkitFontSmoothing"in Lu.documentElement.style,oa=en?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function la(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function De(t,e){return typeof t=="number"?t:t[e]}function aa(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function qu(t,e,n){let r=t.someProp("scrollThreshold")||0,u=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=xt(s);continue}let o=s,l=o==i.body,a=l?la(i):aa(o),c=0,f=0;if(e.top<a.top+De(r,"top")?f=-(a.top-e.top+De(u,"top")):e.bottom>a.bottom-De(r,"bottom")&&(f=e.bottom-e.top>a.bottom-a.top?e.top+De(u,"top")-a.top:e.bottom-a.bottom+De(u,"bottom")),e.left<a.left+De(r,"left")?c=-(a.left-e.left+De(u,"left")):e.right>a.right-De(r,"right")&&(c=e.right-a.right+De(u,"right")),c||f)if(l)i.defaultView.scrollBy(c,f);else{let p=o.scrollLeft,d=o.scrollTop;f&&(o.scrollTop+=f),c&&(o.scrollLeft+=c);let m=o.scrollLeft-p,g=o.scrollTop-d;e={left:e.left-m,top:e.top-g,right:e.right-m,bottom:e.bottom-g}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:xt(s)}}function ca(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,u;for(let i=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let o=t.root.elementFromPoint(i,s);if(!o||o==t.dom||!t.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=n-20){r=o,u=l.top;break}}return{refDOM:r,refTop:u,stack:Os(t.dom)}}function Os(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=xt(r));return e}function fa({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;Ts(n,r==0?0:r-e)}function Ts(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:u,left:i}=t[n];r.scrollTop!=u+e&&(r.scrollTop=u+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let st=null;function da(t){if(t.setActive)return t.setActive();if(st)return t.focus(st);let e=Os(t);t.focus(st==null?{get preventScroll(){return st={preventScroll:!0},!0}}:void 0),st||(st=!1,Ts(e,0))}function Fs(t,e){let n,r=2e8,u,i=0,s=e.top,o=e.top,l,a;for(let c=t.firstChild,f=0;c;c=c.nextSibling,f++){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=we(c).getClientRects();else continue;for(let p=0;p<h.length;p++){let d=h[p];if(d.top<=s&&d.bottom>=o){s=Math.max(d.bottom,s),o=Math.min(d.top,o);let m=d.left>e.left?d.left-e.left:d.right<e.left?e.left-d.right:0;if(m<r){n=c,r=m,u=m&&n.nodeType==3?{left:d.right<e.left?d.right:d.left,top:e.top}:e,c.nodeType==1&&m&&(i=f+(e.left>=(d.left+d.right)/2?1:0));continue}}else d.top>e.top&&!l&&d.left<=e.left&&d.right>=e.left&&(l=c,a={left:Math.max(d.left,Math.min(d.right,e.left)),top:d.top});!n&&(e.left>=d.right&&e.top>=d.top||e.left>=d.left&&e.top>=d.bottom)&&(i=f+1)}}return!n&&l&&(n=l,u=a,r=0),n&&n.nodeType==3?ha(n,u):!n||r&&n.nodeType==1?{node:t,offset:i}:Fs(n,u)}function ha(t,e){let n=t.nodeValue.length,r=document.createRange();for(let u=0;u<n;u++){r.setEnd(t,u+1),r.setStart(t,u);let i=Me(r,1);if(i.top!=i.bottom&&Qr(e,i))return{node:t,offset:u+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}function Qr(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function pa(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function ma(t,e,n){let{node:r,offset:u}=Fs(e,n),i=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();i=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,u,i)}function ga(t,e,n,r){let u=-1;for(let i=e,s=!1;i!=t.dom;){let o=t.docView.nearestDesc(i,!0),l;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&(!s&&l.left>r.left||l.top>r.top?u=o.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(u=o.posAfter),s=!0),!o.contentDOM&&u<0&&!o.node.isText))return(o.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?o.posBefore:o.posAfter;i=o.dom.parentNode}return u>-1?u:t.docView.posFromDOM(e,n,-1)}function Ns(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let u=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=u;;){let s=t.childNodes[i];if(s.nodeType==1){let o=s.getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(Qr(e,a))return Ns(s,e,a)}}if((i=(i+1)%r)==u)break}return t}function ba(t,e){let n=t.dom.ownerDocument,r,u=0,i=ia(n,e.left,e.top);i&&({node:r,offset:u}=i);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),o;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let a=t.dom.getBoundingClientRect();if(!Qr(e,a)||(s=Ns(t.dom,e,a),!s))return null}if(U)for(let a=s;r&&a;a=xt(a))a.draggable&&(r=void 0);if(s=pa(s,e),r){if(fe&&r.nodeType==1&&(u=Math.min(u,r.childNodes.length),u<r.childNodes.length)){let c=r.childNodes[u],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&u++}let a;en&&u&&r.nodeType==1&&(a=r.childNodes[u-1]).nodeType==1&&a.contentEditable=="false"&&a.getBoundingClientRect().top>=e.top&&u--,r==t.dom&&u==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(u==0||r.nodeType!=1||r.childNodes[u-1].nodeName!="BR")&&(o=ga(t,r,u,e))}o==null&&(o=ma(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function Vu(t){return t.top<t.bottom||t.left<t.right}function Me(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(Vu(r))return r}return Array.prototype.find.call(n,Vu)||t.getBoundingClientRect()}const xa=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function vs(t,e,n){let{node:r,offset:u,atom:i}=t.docView.domFromPos(e,n<0?-1:1),s=en||fe;if(r.nodeType==3)if(s&&(xa.test(r.nodeValue)||(n<0?!u:u==r.nodeValue.length))){let l=Me(we(r,u,u),n);if(fe&&u&&/\s/.test(r.nodeValue[u-1])&&u<r.nodeValue.length){let a=Me(we(r,u-1,u-1),-1);if(a.top==l.top){let c=Me(we(r,u,u+1),-1);if(c.top!=l.top)return St(c,c.left<a.left)}}return l}else{let l=u,a=u,c=n<0?1:-1;return n<0&&!u?(a++,c=-1):n>=0&&u==r.nodeValue.length?(l--,c=1):n<0?l--:a++,St(Me(we(r,l,a),c),c<0)}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&u&&(n<0||u==se(r))){let l=r.childNodes[u-1];if(l.nodeType==1)return Xn(l.getBoundingClientRect(),!1)}if(i==null&&u<se(r)){let l=r.childNodes[u];if(l.nodeType==1)return Xn(l.getBoundingClientRect(),!0)}return Xn(r.getBoundingClientRect(),n>=0)}if(i==null&&u&&(n<0||u==se(r))){let l=r.childNodes[u-1],a=l.nodeType==3?we(l,se(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(a)return St(Me(a,1),!1)}if(i==null&&u<se(r)){let l=r.childNodes[u];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let a=l?l.nodeType==3?we(l,0,s?0:1):l.nodeType==1?l:null:null;if(a)return St(Me(a,-1),!0)}return St(Me(r.nodeType==3?we(r):r,-n),n>=0)}function St(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Xn(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Is(t,e,n){let r=t.state,u=t.root.activeElement;r!=e&&t.updateState(e),u!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),u!=t.dom&&u&&u.focus()}}function ya(t,e,n){let r=e.selection,u=n=="up"?r.$from:r.$to;return Is(t,e,()=>{let{node:i}=t.docView.domFromPos(u.pos,n=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(i,!0);if(!o)break;if(o.node.isBlock){i=o.contentDOM||o.dom;break}i=o.dom.parentNode}let s=vs(t,u.pos,1);for(let o=i.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=we(o,0,o.nodeValue.length).getClientRects();else continue;for(let a=0;a<l.length;a++){let c=l[a];if(c.bottom>c.top+1&&(n=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const ka=/[\u0590-\u08ac]/;function Ca(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let u=r.parentOffset,i=!u,s=u==r.parent.content.size,o=t.domSelection();return o?!ka.test(r.parent.textContent)||!o.modify?n=="left"||n=="backward"?i:s:Is(t,e,()=>{let{focusNode:l,focusOffset:a,anchorNode:c,anchorOffset:f}=t.domSelectionRange(),h=o.caretBidiLevel;o.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:d,focusOffset:m}=t.domSelectionRange(),g=d&&!p.contains(d.nodeType==1?d:d.parentNode)||l==d&&a==m;try{o.collapse(c,f),l&&(l!=c||a!=f)&&o.extend&&o.extend(l,a)}catch{}return h!=null&&(o.caretBidiLevel=h),g}):r.pos==r.start()||r.pos==r.end()}let $u=null,Wu=null,Hu=!1;function Da(t,e,n){return $u==e&&Wu==n?Hu:($u=e,Wu=n,Hu=n=="up"||n=="down"?ya(t,e,n):Ca(t,e,n))}const le=0,Ju=1,Ue=2,ye=3;class tn{constructor(e,n,r,u){this.parent=e,this.children=n,this.dom=r,this.contentDOM=u,this.dirty=le,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let u=this.children[n];if(u==e)return r;r+=u.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,s;if(e==this.contentDOM)i=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(s)+s.size:this.posAtStart}else{let i,s;if(e==this.contentDOM)i=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}let u;if(e==this.dom&&this.contentDOM)u=n>L(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))u=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let i=e;;i=i.parentNode){if(i==this.dom){u=!1;break}if(i.previousSibling)break}if(u==null&&n==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){u=!0;break}if(i.nextSibling)break}}return u??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,u=e;u;u=u.parentNode){let i=this.getDesc(u),s;if(i&&(!n||i.node))if(r&&(s=i.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return i}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let u=e;u;u=u.parentNode){let i=this.getDesc(u);if(i)return i.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let u=this.children[n],i=r+u.size;if(r==e&&i!=r){for(;!u.border&&u.children.length;)for(let s=0;s<u.children.length;s++){let o=u.children[s];if(o.size){u=o;break}}return u}if(e<i)return u.descAt(e-r-u.border);r=i}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,u=0;for(let i=0;r<this.children.length;r++){let s=this.children[r],o=i+s.size;if(o>e||s instanceof Bs){u=e-i;break}i=o}if(u)return this.children[r].domFromPos(u-this.children[r].border,n);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof Rs&&i.side>=0;r--);if(n<=0){let i,s=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,s=!1);return i&&n&&s&&!i.border&&!i.domAtom?i.domFromPos(i.size,n):{node:this.contentDOM,offset:i?L(i.dom)+1:0}}else{let i,s=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,s=!1);return i&&s&&!i.border&&!i.domAtom?i.domFromPos(0,n):{node:this.contentDOM,offset:i?L(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let u=-1,i=-1;for(let s=r,o=0;;o++){let l=this.children[o],a=s+l.size;if(u==-1&&e<=a){let c=s+l.border;if(e>=c&&n<=a-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,c);e=s;for(let f=o;f>0;f--){let h=this.children[f-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){u=L(h.dom)+1;break}e-=h.size}u==-1&&(u=0)}if(u>-1&&(a>n||o==this.children.length-1)){n=a;for(let c=o+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){i=L(f.dom);break}n+=f.size}i==-1&&(i=this.contentDOM.childNodes.length);break}s=a}return{node:this.contentDOM,from:e,to:n,fromOffset:u,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,u=!1){let i=Math.min(e,n),s=Math.max(e,n);for(let p=0,d=0;p<this.children.length;p++){let m=this.children[p],g=d+m.size;if(i>d&&s<g)return m.setSelection(e-d-m.border,n-d-m.border,r,u);d=g}let o=this.domFromPos(e,e?-1:1),l=n==e?o:this.domFromPos(n,n?-1:1),a=r.root.getSelection(),c=r.domSelectionRange(),f=!1;if((fe||U)&&e==n){let{node:p,offset:d}=o;if(p.nodeType==3){if(f=!!(d&&p.nodeValue[d-1]==`
`),f&&d==p.nodeValue.length)for(let m=p,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(o=l={node:g.parentNode,offset:L(g)+1});break}let b=m.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let m=p.childNodes[d-1];f=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(fe&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(u=!0)}if(!(u||f&&U)&&nt(o.node,o.offset,c.anchorNode,c.anchorOffset)&&nt(l.node,l.offset,c.focusNode,c.focusOffset))return;let h=!1;if((a.extend||e==n)&&!f){a.collapse(o.node,o.offset);try{e!=n&&a.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>n){let d=o;o=l,l=d}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(o.node,o.offset),a.removeAllRanges(),a.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,u=0;u<this.children.length;u++){let i=this.children[u],s=r+i.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let o=r+i.border,l=s-i.border;if(e>=o&&n<=l){this.dirty=e==r||n==s?Ue:Ju,e==o&&n==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=ye:i.markDirty(e-o,n-o);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Ue:ye}r=s}this.dirty=Ue}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Ue:Ju;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class Rs extends tn{constructor(e,n,r,u){let i,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!i)return u;if(i.parent)return i.parent.posBeforeChild(i)})),!n.type.spec.raw){if(s.nodeType!=1){let o=document.createElement("span");o.appendChild(s),s=o}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,i=this}matchesWidget(e){return this.dirty==le&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class wa extends tn{constructor(e,n,r,u){super(e,[],n,null),this.textDOM=r,this.text=u}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class rt extends tn{constructor(e,n,r,u,i){super(e,[],r,u),this.mark=n,this.spec=i}static create(e,n,r,u){let i=u.nodeViews[n.type.name],s=i&&i(n,u,r);return(!s||!s.dom)&&(s=wt.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new rt(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&ye||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ye&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=le){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=le}}slice(e,n,r){let u=rt.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=Tr(i,n,s,r)),e>0&&(i=Tr(i,0,e,r));for(let o=0;o<i.length;o++)i[o].parent=u;return u.children=i,u}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class qe extends tn{constructor(e,n,r,u,i,s,o,l,a){super(e,[],i,s),this.node=n,this.outerDeco=r,this.innerDeco=u,this.nodeDOM=o}static create(e,n,r,u,i,s){let o=i.nodeViews[n.type.name],l,a=o&&o(n,i,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,u),c=a&&a.dom,f=a&&a.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=wt.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!f&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let h=c;return c=Ls(c,r,n),a?l=new _a(e,n,r,u,c,f||null,h,a,i,s+1):n.isText?new zn(e,n,r,u,c,h,i):new qe(e,n,r,u,c,f||null,h,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>x.empty)}return e}matchesNode(e,n,r){return this.dirty==le&&e.eq(this.node)&&wn(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,u=n,i=e.composing?this.localCompositionInfo(e,n):null,s=i&&i.pos>-1?i:null,o=i&&i.pos<0,l=new Sa(this,s&&s.node,e);Oa(this.node,this.innerDeco,(a,c,f)=>{a.spec.marks?l.syncToMarks(a.spec.marks,r,e):a.type.side>=0&&!f&&l.syncToMarks(c==this.node.childCount?M.none:this.node.child(c).marks,r,e),l.placeWidget(a,e,u)},(a,c,f,h)=>{l.syncToMarks(a.marks,r,e);let p;l.findNodeMatch(a,c,f,h)||o&&e.state.selection.from>u&&e.state.selection.to<u+a.nodeSize&&(p=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(a,c,f,p,e)||l.updateNextNode(a,c,f,e,h,u)||l.addNode(a,c,f,e,u),u+=a.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Ue)&&(s&&this.protectLocalComposition(e,s),zs(this.contentDOM,this.children,e),yt&&Ta(this.dom))}localCompositionInfo(e,n){let{from:r,to:u}=e.state.selection;if(!(e.state.selection instanceof O)||r<n||u>n+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let s=i.nodeValue,o=Fa(this.node.content,s,r-n,u-n);return o<0?null:{node:i,pos:o,text:s}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:u}){if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new wa(this,i,n,u);e.input.compositionNodes.push(s),this.children=Tr(this.children,r,r+u.length,e,s)}update(e,n,r,u){return this.dirty==ye||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,u),!0)}updateInner(e,n,r,u){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(u,this.posAtStart),this.dirty=le}updateOuterDeco(e){if(wn(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Ps(this.dom,this.nodeDOM,Or(this.outerDeco,this.node,n),Or(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function ju(t,e,n,r,u){Ls(r,e,t);let i=new qe(void 0,t,e,n,r,r,r,u,0);return i.contentDOM&&i.updateChildren(u,0),i}class zn extends qe{constructor(e,n,r,u,i,s,o){super(e,n,r,u,i,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,u){return this.dirty==ye||this.dirty!=le&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=le||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,u.trackWrites==this.nodeDOM&&(u.trackWrites=null)),this.node=e,this.dirty=le,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let u=this.node.cut(e,n),i=document.createTextNode(u.text);return new zn(this.parent,u,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=ye)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Bs extends tn{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==le&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class _a extends qe{constructor(e,n,r,u,i,s,o,l,a,c){super(e,n,r,u,i,s,o,a,c),this.spec=l}update(e,n,r,u){if(this.dirty==ye)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,u),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,u)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,u){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,u)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function zs(t,e,n){let r=t.firstChild,u=!1;for(let i=0;i<e.length;i++){let s=e[i],o=s.dom;if(o.parentNode==t){for(;o!=r;)r=Uu(r),u=!0;r=r.nextSibling}else u=!0,t.insertBefore(o,r);if(s instanceof rt){let l=r?r.previousSibling:t.lastChild;zs(s.contentDOM,s.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=Uu(r),u=!0;u&&n.trackWrites==t&&(n.trackWrites=null)}const vt=function(t){t&&(this.nodeName=t)};vt.prototype=Object.create(null);const Ke=[new vt];function Or(t,e,n){if(t.length==0)return Ke;let r=n?Ke[0]:new vt,u=[r];for(let i=0;i<t.length;i++){let s=t[i].type.attrs;if(s){s.nodeName&&u.push(r=new vt(s.nodeName));for(let o in s){let l=s[o];l!=null&&(n&&u.length==1&&u.push(r=new vt(e.isInline?"span":"div")),o=="class"?r.class=(r.class?r.class+" ":"")+l:o=="style"?r.style=(r.style?r.style+";":"")+l:o!="nodeName"&&(r[o]=l))}}}return u}function Ps(t,e,n,r){if(n==Ke&&r==Ke)return e;let u=e;for(let i=0;i<r.length;i++){let s=r[i],o=n[i];if(i){let l;o&&o.nodeName==s.nodeName&&u!=t&&(l=u.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(u),o=Ke[0]),u=l}Ea(u,o||Ke[0],s)}return u}function Ea(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],u=n.class?n.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)u.indexOf(r[i])==-1&&t.classList.remove(r[i]);for(let i=0;i<u.length;i++)r.indexOf(u[i])==-1&&t.classList.add(u[i]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,u;for(;u=r.exec(e.style);)t.style.removeProperty(u[1])}n.style&&(t.style.cssText+=n.style)}}function Ls(t,e,n){return Ps(t,t,Ke,Or(e,n,t.nodeType!=1))}function wn(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Uu(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Sa{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Aa(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let u=0,i=this.stack.length>>1,s=Math.min(i,e.length);for(;u<s&&(u==i-1?this.top:this.stack[u+1<<1]).matchesMark(e[u])&&e[u].type.spec.spanning!==!1;)u++;for(;u<i;)this.destroyRest(),this.top.dirty=le,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let o=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let a=this.top.children[l];if(a.matchesMark(e[i])&&!this.isLocked(a.dom)){o=l;break}}if(o>-1)o>this.index&&(this.changed=!0,this.destroyBetween(this.index,o)),this.top=this.top.children[this.index];else{let l=rt.create(this.top,e[i],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,n,r,u){let i=-1,s;if(u>=this.preMatch.index&&(s=this.preMatch.matches[u-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))i=this.top.children.indexOf(s,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let a=this.top.children[o];if(a.matchesNode(e,n,r)&&!this.preMatch.matched.has(a)){i=o;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,n,r,u,i){let s=this.top.children[u];return s.dirty==ye&&s.dom==s.contentDOM&&(s.dirty=Ue),s.update(e,n,r,i)?(this.destroyBetween(this.index,u),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let u=this.index;u<this.top.children.length;u++)if(this.top.children[u]==r)return u}return-1}e=n}}updateNextNode(e,n,r,u,i,s){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof qe){let a=this.preMatch.matched.get(l);if(a!=null&&a!=i)return!1;let c=l.dom,f,h=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=ye&&wn(n,l.outerDeco));if(!h&&l.update(e,n,r,u))return this.destroyBetween(this.index,o),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!h&&(f=this.recreateWrapper(l,e,n,r,u,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Ue,f.updateChildren(u,s+1),f.dirty=le),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,u,i,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!wn(r,e.outerDeco)||!u.eq(e.innerDeco))return null;let o=qe.create(this.top,n,r,u,i,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let l of o.children)l.parent=o}return e.destroy(),o}addNode(e,n,r,u,i){let s=qe.create(this.top,e,n,r,u,i);s.contentDOM&&s.updateChildren(u,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let u=this.index<this.top.children.length?this.top.children[this.index]:null;if(u&&u.matchesWidget(e)&&(e==u.widget||!u.widget.type.toDOM.parentNode))this.index++;else{let i=new Rs(this.top,e,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof rt;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof zn)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((U||J)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let u=new Bs(this.top,[],r,null);n!=this.top?n.children.push(u):n.children.splice(this.index++,0,u),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Aa(t,e){let n=e,r=n.children.length,u=t.childCount,i=new Map,s=[];e:for(;u>0;){let o;for(;;)if(r){let a=n.children[r-1];if(a instanceof rt)n=a,r=a.children.length;else{o=a,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=o.node;if(l){if(l!=t.child(u-1))break;--u,i.set(o,u),s.push(o)}}return{index:u,matched:i,matches:s.reverse()}}function Ma(t,e){return t.type.side-e.type.side}function Oa(t,e,n,r){let u=e.locals(t),i=0;if(u.length==0){for(let a=0;a<t.childCount;a++){let c=t.child(a);r(c,u,e.forChild(i,c),a),i+=c.nodeSize}return}let s=0,o=[],l=null;for(let a=0;;){let c,f;for(;s<u.length&&u[s].to==i;){let g=u[s++];g.widget&&(c?(f||(f=[c])).push(g):c=g)}if(c)if(f){f.sort(Ma);for(let g=0;g<f.length;g++)n(f[g],a,!!l)}else n(c,a,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(a<t.childCount)p=a,h=t.child(a++);else break;for(let g=0;g<o.length;g++)o[g].to<=i&&o.splice(g--,1);for(;s<u.length&&u[s].from<=i&&u[s].to>i;)o.push(u[s++]);let d=i+h.nodeSize;if(h.isText){let g=d;s<u.length&&u[s].from<g&&(g=u[s].from);for(let b=0;b<o.length;b++)o[b].to<g&&(g=o[b].to);g<d&&(l=h.cut(g-i),h=h.cut(0,g-i),d=g,p=-1)}else for(;s<u.length&&u[s].to<d;)s++;let m=h.isInline&&!h.isLeaf?o.filter(g=>!g.inline):o.slice();r(h,m,e.forChild(i,h),p),i=d}}function Ta(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function Fa(t,e,n,r){for(let u=0,i=0;u<t.childCount&&i<=r;){let s=t.child(u++),o=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;u<t.childCount;){let a=t.child(u++);if(i+=a.nodeSize,!a.isText)break;l+=a.text}if(i>=n){if(i>=r&&l.slice(r-e.length-o,r-o)==e)return r-e.length;let a=o<r?l.lastIndexOf(e,r-o-1):-1;if(a>=0&&a+e.length+o>=n)return o+a;if(n==r&&l.length>=r+e.length-o&&l.slice(r-o,r-o+e.length)==e)return r}}return-1}function Tr(t,e,n,r,u){let i=[];for(let s=0,o=0;s<t.length;s++){let l=t[s],a=o,c=o+=l.size;a>=n||c<=e?i.push(l):(a<e&&i.push(l.slice(0,e-a,r)),u&&(i.push(u),u=void 0),c>n&&i.push(l.slice(n-a,l.size,r)))}return i}function Yr(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let u=t.docView.nearestDesc(n.focusNode),i=u&&u.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let o=r.resolve(s),l,a;if(Bn(n)){for(l=s;u&&!u.node;)u=u.parent;let f=u.node;if(u&&f.isAtom&&w.isSelectable(f)&&u.parent&&!(f.isInline&&ra(n.focusNode,n.focusOffset,u.dom))){let h=u.posBefore;a=new w(s==h?o:r.resolve(h))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let f=s,h=s;for(let p=0;p<n.rangeCount;p++){let d=n.getRangeAt(p);f=Math.min(f,t.docView.posFromDOM(d.startContainer,d.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(d.endContainer,d.endOffset,-1))}if(f<0)return null;[l,s]=h==t.state.selection.anchor?[h,f]:[f,h],o=r.resolve(s)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let c=r.resolve(l);if(!a){let f=e=="pointer"||t.state.selection.head<o.pos&&!i?1:-1;a=Xr(t,c,o,f)}return a}function qs(t){return t.editable?t.hasFocus():$s(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Se(t,e=!1){let n=t.state.selection;if(Vs(t,n),!!qs(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&J){let r=t.domSelectionRange(),u=t.domObserver.currentSelection;if(r.anchorNode&&u.anchorNode&&nt(r.anchorNode,r.anchorOffset,u.anchorNode,u.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)va(t);else{let{anchor:r,head:u}=n,i,s;Ku&&!(n instanceof O)&&(n.$from.parent.inlineContent||(i=Zu(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=Zu(t,n.to))),t.docView.setSelection(r,u,t,e),Ku&&(i&&Gu(i),s&&Gu(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Na(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Ku=U||J&&Ms<63;function Zu(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),u=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(U&&u&&u.contentEditable=="false")return er(u);if((!u||u.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(u)return er(u);if(i)return er(i)}}function er(t){return t.contentEditable="true",U&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Gu(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Na(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,u=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=u)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!qs(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function va(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,u=r.nodeName=="IMG";u?n.setStart(r.parentNode,L(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!u&&!t.state.selection.visible&&Y&&Le<=11&&(r.disabled=!0,r.disabled=!1)}function Vs(t,e){if(e instanceof w){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Qu(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Qu(t)}function Qu(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Xr(t,e,n,r){return t.someProp("createSelectionBetween",u=>u(t,e,n))||O.between(e,n,r)}function Yu(t){return t.editable&&!t.hasFocus()?!1:$s(t)}function $s(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Ia(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return nt(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Fr(t,e){let{$anchor:n,$head:r}=t.selection,u=e>0?n.max(r):n.min(r),i=u.parent.inlineContent?u.depth?t.doc.resolve(e>0?u.after():u.before()):null:u;return i&&A.findFrom(i,e)}function Oe(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Xu(t,e,n){let r=t.state.selection;if(r instanceof O)if(n.indexOf("s")>-1){let{$head:u}=r,i=u.textOffset?null:e<0?u.nodeBefore:u.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=t.state.doc.resolve(u.pos+i.nodeSize*(e<0?-1:1));return Oe(t,new O(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let u=Fr(t.state,e);return u&&u instanceof w?Oe(t,u):!1}else if(!(ue&&n.indexOf("m")>-1)){let u=r.$head,i=u.textOffset?null:e<0?u.nodeBefore:u.nodeAfter,s;if(!i||i.isText)return!1;let o=e<0?u.pos-i.nodeSize:u.pos;return i.isAtom||(s=t.docView.descAt(o))&&!s.contentDOM?w.isSelectable(i)?Oe(t,new w(e<0?t.state.doc.resolve(u.pos-i.nodeSize):u)):en?Oe(t,new O(t.state.doc.resolve(e<0?o:o+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof w&&r.node.isInline)return Oe(t,new O(e>0?r.$to:r.$from));{let u=Fr(t.state,e);return u?Oe(t,u):!1}}}function _n(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function It(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function ot(t,e){return e<0?Ra(t):Ba(t)}function Ra(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let u,i,s=!1;for(fe&&n.nodeType==1&&r<_n(n)&&It(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let o=n.childNodes[r-1];if(It(o,-1))u=n,i=--r;else if(o.nodeType==3)n=o,r=n.nodeValue.length;else break}}else{if(Ws(n))break;{let o=n.previousSibling;for(;o&&It(o,-1);)u=n.parentNode,i=L(o),o=o.previousSibling;if(o)n=o,r=_n(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?Nr(t,n,r):u&&Nr(t,u,i)}function Ba(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let u=_n(n),i,s;for(;;)if(r<u){if(n.nodeType!=1)break;let o=n.childNodes[r];if(It(o,1))i=n,s=++r;else break}else{if(Ws(n))break;{let o=n.nextSibling;for(;o&&It(o,1);)i=o.parentNode,s=L(o)+1,o=o.nextSibling;if(o)n=o,r=0,u=_n(n);else{if(n=n.parentNode,n==t.dom)break;r=u=0}}}i&&Nr(t,i,s)}function Ws(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function za(t,e){for(;t&&e==t.childNodes.length&&!Xt(t);)e=L(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function Pa(t,e){for(;t&&!e&&!Xt(t);)e=L(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Nr(t,e,n){if(e.nodeType!=3){let i,s;(s=za(e,n))?(e=s,n=0):(i=Pa(e,n))&&(e=i,n=i.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Bn(r)){let i=document.createRange();i.setEnd(e,n),i.setStart(e,n),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:u}=t;setTimeout(()=>{t.state==u&&Se(t)},50)}function ei(t,e){let n=t.state.doc.resolve(e);if(!(J||sa)&&n.parent.inlineContent){let u=t.coordsAtPos(e);if(e>n.start()){let i=t.coordsAtPos(e-1),s=(i.top+i.bottom)/2;if(s>u.top&&s<u.bottom&&Math.abs(i.left-u.left)>1)return i.left<u.left?"ltr":"rtl"}if(e<n.end()){let i=t.coordsAtPos(e+1),s=(i.top+i.bottom)/2;if(s>u.top&&s<u.bottom&&Math.abs(i.left-u.left)>1)return i.left>u.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function ti(t,e,n){let r=t.state.selection;if(r instanceof O&&!r.empty||n.indexOf("s")>-1||ue&&n.indexOf("m")>-1)return!1;let{$from:u,$to:i}=r;if(!u.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=Fr(t.state,e);if(s&&s instanceof w)return Oe(t,s)}if(!u.parent.inlineContent){let s=e<0?u:i,o=r instanceof te?A.near(s,e):A.findFrom(s,e);return o?Oe(t,o):!1}return!1}function ni(t,e){if(!(t.state.selection instanceof O))return!0;let{$head:n,$anchor:r,empty:u}=t.state.selection;if(!n.sameParent(r))return!0;if(!u)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let s=t.state.tr;return e<0?s.delete(n.pos-i.nodeSize,n.pos):s.delete(n.pos,n.pos+i.nodeSize),t.dispatch(s),!0}return!1}function ri(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function La(t){if(!U||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;ri(t,r,"true"),setTimeout(()=>ri(t,r,"false"),20)}return!1}function qa(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Va(t,e){let n=e.keyCode,r=qa(e);if(n==8||ue&&n==72&&r=="c")return ni(t,-1)||ot(t,-1);if(n==46&&!e.shiftKey||ue&&n==68&&r=="c")return ni(t,1)||ot(t,1);if(n==13||n==27)return!0;if(n==37||ue&&n==66&&r=="c"){let u=n==37?ei(t,t.state.selection.from)=="ltr"?-1:1:-1;return Xu(t,u,r)||ot(t,u)}else if(n==39||ue&&n==70&&r=="c"){let u=n==39?ei(t,t.state.selection.from)=="ltr"?1:-1:1;return Xu(t,u,r)||ot(t,u)}else{if(n==38||ue&&n==80&&r=="c")return ti(t,-1,r)||ot(t,-1);if(n==40||ue&&n==78&&r=="c")return La(t)||ti(t,1,r)||ot(t,1);if(r==(ue?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function eu(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:u,openEnd:i}=e;for(;u>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){u--,i--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=t.someProp("clipboardSerializer")||wt.fromSchema(t.state.schema),o=Zs(),l=o.createElement("div");l.appendChild(s.serializeFragment(r,{document:o}));let a=l.firstChild,c,f=0;for(;a&&a.nodeType==1&&(c=Ks[a.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let d=o.createElement(c[p]);for(;l.firstChild;)d.appendChild(l.firstChild);l.appendChild(d),f++}a=l.firstChild}a&&a.nodeType==1&&a.setAttribute("data-pm-slice",`${u} ${i}${f?` -${f}`:""} ${JSON.stringify(n)}`);let h=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function Hs(t,e,n,r,u){let i=u.parent.type.spec.code,s,o;if(!n&&!e)return null;let l=e&&(r||i||!n);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,i||r,t)}),i)return e?new k(x.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):k.empty;let f=t.someProp("clipboardTextParser",h=>h(e,u,r,t));if(f)o=f;else{let h=u.marks(),{schema:p}=t.state,d=wt.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=s.appendChild(document.createElement("p"));m&&g.appendChild(d.serializeNode(p.text(m,h)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),s=Ja(n),en&&ja(s);let a=s&&s.querySelector("[data-pm-slice]"),c=a&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(a.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||Lt.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||c),context:u,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!$a.test(h.parentNode.nodeName)?{ignore:!0}:null}})),c)o=Ua(ui(o,+c[1],+c[2]),c[4]);else if(o=k.maxOpen(Wa(o.content,u),!0),o.openStart||o.openEnd){let f=0,h=0;for(let p=o.content.firstChild;f<o.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=o.content.lastChild;h<o.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);o=ui(o,f,h)}return t.someProp("transformPasted",f=>{o=f(o,t)}),o}const $a=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Wa(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let u=e.node(n).contentMatchAt(e.index(n)),i,s=[];if(t.forEach(o=>{if(!s)return;let l=u.findWrapping(o.type),a;if(!l)return s=null;if(a=s.length&&i.length&&js(l,i,o,s[s.length-1],0))s[s.length-1]=a;else{s.length&&(s[s.length-1]=Us(s[s.length-1],i.length));let c=Js(o,l);s.push(c),u=u.matchType(c.type),i=l}}),s)return x.from(s)}return t}function Js(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,x.from(t));return t}function js(t,e,n,r,u){if(u<t.length&&u<e.length&&t[u]==e[u]){let i=js(t,e,n,r.lastChild,u+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(u==t.length-1?n.type:t[u+1]))return r.copy(r.content.append(x.from(Js(n,t,u+1))))}}function Us(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,Us(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(x.empty,!0);return t.copy(n.append(r))}function vr(t,e,n,r,u,i){let s=e<0?t.firstChild:t.lastChild,o=s.content;return t.childCount>1&&(i=0),u<r-1&&(o=vr(o,e,n,r,u+1,i)),u>=n&&(o=e<0?s.contentMatchAt(0).fillBefore(o,i<=u).append(o):o.append(s.contentMatchAt(s.childCount).fillBefore(x.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(o))}function ui(t,e,n){return e<t.openStart&&(t=new k(vr(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new k(vr(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const Ks={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ii=null;function Zs(){return ii||(ii=document.implementation.createHTMLDocument("title"))}let tr=null;function Ha(t){let e=window.trustedTypes;return e?(tr||(tr=e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),tr.createHTML(t)):t}function Ja(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=Zs().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),u;if((u=r&&Ks[r[1].toLowerCase()])&&(t=u.map(i=>"<"+i+">").join("")+t+u.map(i=>"</"+i+">").reverse().join("")),n.innerHTML=Ha(t),u)for(let i=0;i<u.length;i++)n=n.querySelector(u[i])||n;return n}function ja(t){let e=t.querySelectorAll(J?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Ua(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:u,openStart:i,openEnd:s}=t;for(let o=r.length-2;o>=0;o-=2){let l=n.nodes[r[o]];if(!l||l.hasRequiredAttrs())break;u=x.from(l.create(r[o+1],u)),i++,s++}return new k(u,i,s)}const K={},Z={},Ka={touchstart:!0,touchmove:!0};class Za{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Ga(t){for(let e in K){let n=K[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{Ya(t,r)&&!tu(t,r)&&(t.editable||!(r.type in Z))&&n(t,r)},Ka[e]?{passive:!0}:void 0)}U&&t.dom.addEventListener("input",()=>null),Ir(t)}function ze(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Qa(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Ir(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>tu(t,r))})}function tu(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function Ya(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Xa(t,e){!tu(t,e)&&K[e.type]&&(t.editable||!(e.type in Z))&&K[e.type](t,e)}Z.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Qs(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Ee&&J&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),yt&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",u=>u(t,je(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Va(t,n)?n.preventDefault():ze(t,"key")};Z.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Z.keypress=(t,e)=>{let n=e;if(Qs(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||ue&&n.metaKey)return;if(t.someProp("handleKeyPress",u=>u(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof O)||!r.$from.sameParent(r.$to)){let u=String.fromCharCode(n.charCode);!/[\r\n]/.test(u)&&!t.someProp("handleTextInput",i=>i(t,r.$from.pos,r.$to.pos,u))&&t.dispatch(t.state.tr.insertText(u).scrollIntoView()),n.preventDefault()}};function Pn(t){return{left:t.clientX,top:t.clientY}}function ec(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function nu(t,e,n,r,u){if(r==-1)return!1;let i=t.state.doc.resolve(r);for(let s=i.depth+1;s>0;s--)if(t.someProp(e,o=>s>i.depth?o(t,n,i.nodeAfter,i.before(s),u,!0):o(t,n,i.node(s),i.before(s),u,!1)))return!0;return!1}function pt(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function tc(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&w.isSelectable(r)?(pt(t,new w(n)),!0):!1}function nc(t,e){if(e==-1)return!1;let n=t.state.selection,r,u;n instanceof w&&(r=n.node);let i=t.state.doc.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s);if(w.isSelectable(o)){r&&n.$from.depth>0&&s>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?u=i.before(n.$from.depth):u=i.before(s);break}}return u!=null?(pt(t,w.create(t.state.doc,u)),!0):!1}function rc(t,e,n,r,u){return nu(t,"handleClickOn",e,n,r)||t.someProp("handleClick",i=>i(t,e,r))||(u?nc(t,n):tc(t,n))}function uc(t,e,n,r){return nu(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",u=>u(t,e,r))}function ic(t,e,n,r){return nu(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",u=>u(t,e,r))||sc(t,n,r)}function sc(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(pt(t,O.create(r,0,r.content.size)),!0):!1;let u=r.resolve(e);for(let i=u.depth+1;i>0;i--){let s=i>u.depth?u.nodeAfter:u.node(i),o=u.before(i);if(s.inlineContent)pt(t,O.create(r,o+1,o+1+s.content.size));else if(w.isSelectable(s))pt(t,w.create(r,o));else continue;return!0}}function ru(t){return En(t)}const Gs=ue?"metaKey":"ctrlKey";K.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=ru(t),u=Date.now(),i="singleClick";u-t.input.lastClick.time<500&&ec(n,t.input.lastClick)&&!n[Gs]&&(t.input.lastClick.type=="singleClick"?i="doubleClick":t.input.lastClick.type=="doubleClick"&&(i="tripleClick")),t.input.lastClick={time:u,x:n.clientX,y:n.clientY,type:i};let s=t.posAtCoords(Pn(n));s&&(i=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new oc(t,s,n,!!r)):(i=="doubleClick"?uc:ic)(t,s.pos,s.inside,n)?n.preventDefault():ze(t,"pointer"))};class oc{constructor(e,n,r,u){this.view=e,this.pos=n,this.event=r,this.flushed=u,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Gs],this.allowDefault=r.shiftKey;let i,s;if(n.inside>-1)i=e.state.doc.nodeAt(n.inside),s=n.inside;else{let c=e.state.doc.resolve(n.pos);i=c.parent,s=c.depth?c.before():0}const o=u?null:r.target,l=o?e.docView.nearestDesc(o,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:a}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||a instanceof w&&a.from<=s&&a.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&fe&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ze(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Se(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Pn(e))),this.updateAllowDefault(e),this.allowDefault||!n?ze(this.view,"pointer"):rc(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||U&&this.mightDrag&&!this.mightDrag.node.isAtom||J&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(pt(this.view,A.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):ze(this.view,"pointer")}move(e){this.updateAllowDefault(e),ze(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}K.touchstart=t=>{t.input.lastTouch=Date.now(),ru(t),ze(t,"pointer")};K.touchmove=t=>{t.input.lastTouch=Date.now(),ze(t,"pointer")};K.contextmenu=t=>ru(t);function Qs(t,e){return t.composing?!0:U&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const lc=Ee?5e3:-1;Z.compositionstart=Z.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof O&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),En(t,!0),t.markCursor=null;else if(En(t,!e.selection.empty),fe&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let u=r.focusNode,i=r.focusOffset;u&&u.nodeType==1&&i!=0;){let s=i<0?u.lastChild:u.childNodes[i-1];if(!s)break;if(s.nodeType==3){let o=t.domSelection();o&&o.collapse(s,s.nodeValue.length);break}else u=s,i=-1}}t.input.composing=!0}Ys(t,lc)};Z.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Ys(t,20))};function Ys(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>En(t),e))}function Xs(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=cc());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function ac(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=ta(e.focusNode,e.focusOffset),r=na(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let u=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!u||!u.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function cc(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function En(t,e=!1){if(!(Ee&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Xs(t),e||t.docView&&t.docView.dirty){let n=Yr(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!t.state.selection.empty?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function fc(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),u=document.createRange();u.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(u),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Wt=Y&&Le<15||yt&&oa<604;K.copy=Z.cut=(t,e)=>{let n=e,r=t.state.selection,u=n.type=="cut";if(r.empty)return;let i=Wt?null:n.clipboardData,s=r.content(),{dom:o,text:l}=eu(t,s);i?(n.preventDefault(),i.clearData(),i.setData("text/html",o.innerHTML),i.setData("text/plain",l)):fc(t,o),u&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function dc(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function hc(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let u=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Ht(t,r.value,null,u,e):Ht(t,r.textContent,r.innerHTML,u,e)},50)}function Ht(t,e,n,r,u){let i=Hs(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,u,i||k.empty)))return!0;if(!i)return!1;let s=dc(i),o=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(i);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function eo(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Z.paste=(t,e)=>{let n=e;if(t.composing&&!Ee)return;let r=Wt?null:n.clipboardData,u=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Ht(t,eo(r),r.getData("text/html"),u,n)?n.preventDefault():hc(t,n)};class to{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const no=ue?"altKey":"ctrlKey";K.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let u=t.state.selection,i=u.empty?null:t.posAtCoords(Pn(n)),s;if(!(i&&i.pos>=u.from&&i.pos<=(u instanceof w?u.to-1:u.to))){if(r&&r.mightDrag)s=w.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let f=t.docView.nearestDesc(n.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(s=w.create(t.state.doc,f.posBefore))}}let o=(s||t.state.selection).content(),{dom:l,text:a,slice:c}=eu(t,o);(!n.dataTransfer.files.length||!J||Ms>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Wt?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",Wt||n.dataTransfer.setData("text/plain",a),t.dragging=new to(c,!n[no],s)};K.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Z.dragover=Z.dragenter=(t,e)=>e.preventDefault();Z.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let u=t.posAtCoords(Pn(n));if(!u)return;let i=t.state.doc.resolve(u.pos),s=r&&r.slice;s?t.someProp("transformPasted",d=>{s=d(s,t)}):s=Hs(t,eo(n.dataTransfer),Wt?null:n.dataTransfer.getData("text/html"),!1,i);let o=!!(r&&!n[no]);if(t.someProp("handleDrop",d=>d(t,n,s||k.empty,o))){n.preventDefault();return}if(!s)return;n.preventDefault();let l=s?ys(t.state.doc,i.pos,s):i.pos;l==null&&(l=i.pos);let a=t.state.tr;if(o){let{node:d}=r;d?d.replace(a):a.deleteSelection()}let c=a.mapping.map(l),f=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=a.doc;if(f?a.replaceRangeWith(c,c,s.content.firstChild):a.replaceRange(c,c,s),a.doc.eq(h))return;let p=a.doc.resolve(c);if(f&&w.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))a.setSelection(new w(p));else{let d=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((m,g,b,y)=>d=y),a.setSelection(Xr(t,p,a.doc.resolve(d)))}t.focus(),t.dispatch(a.setMeta("uiEvent","drop"))};K.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Se(t)},20))};K.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};K.beforeinput=(t,e)=>{if(J&&Ee&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",i=>i(t,je(8,"Backspace")))))return;let{$cursor:u}=t.state.selection;u&&u.pos>0&&t.dispatch(t.state.tr.delete(u.pos-1,u.pos).scrollIntoView())},50)}};for(let t in Z)K[t]=Z[t];function Jt(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Sn{constructor(e,n){this.toDOM=e,this.spec=n||Ye,this.side=this.spec.side||0}map(e,n,r,u){let{pos:i,deleted:s}=e.mapResult(n.from+u,this.side<0?-1:1);return s?null:new oe(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Sn&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Jt(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ve{constructor(e,n){this.attrs=e,this.spec=n||Ye}map(e,n,r,u){let i=e.map(n.from+u,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+u,this.spec.inclusiveEnd?1:-1)-r;return i>=s?null:new oe(i,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Ve&&Jt(this.attrs,e.attrs)&&Jt(this.spec,e.spec)}static is(e){return e.type instanceof Ve}destroy(){}}class uu{constructor(e,n){this.attrs=e,this.spec=n||Ye}map(e,n,r,u){let i=e.mapResult(n.from+u,1);if(i.deleted)return null;let s=e.mapResult(n.to+u,-1);return s.deleted||s.pos<=i.pos?null:new oe(i.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:u}=e.content.findIndex(n.from),i;return u==n.from&&!(i=e.child(r)).isText&&u+i.nodeSize==n.to}eq(e){return this==e||e instanceof uu&&Jt(this.attrs,e.attrs)&&Jt(this.spec,e.spec)}destroy(){}}class oe{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new oe(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new oe(e,e,new Sn(n,r))}static inline(e,n,r,u){return new oe(e,n,new Ve(r,u))}static node(e,n,r,u){return new oe(e,n,new uu(r,u))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ve}get widget(){return this.type instanceof Sn}}const ct=[],Ye={};class I{constructor(e,n){this.local=e.length?e:ct,this.children=n.length?n:ct}static create(e,n){return n.length?An(n,e,0,Ye):W}find(e,n,r){let u=[];return this.findInner(e??0,n??1e9,u,0,r),u}findInner(e,n,r,u,i){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=n&&o.to>=e&&(!i||i(o.spec))&&r.push(o.copy(o.from+u,o.to+u))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,n-o,r,u+o,i)}}map(e,n,r){return this==W||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Ye)}mapInner(e,n,r,u,i){let s;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(e,r,u);l&&l.type.valid(n,l)?(s||(s=[])).push(l):i.onRemove&&i.onRemove(this.local[o].spec)}return this.children.length?pc(this.children,s||[],e,n,r,u,i):s?new I(s.sort(Xe),ct):W}add(e,n){return n.length?this==W?I.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let u,i=0;e.forEach((o,l)=>{let a=l+r,c;if(c=uo(n,o,a)){for(u||(u=this.children.slice());i<u.length&&u[i]<l;)i+=3;u[i]==l?u[i+2]=u[i+2].addInner(o,c,a+1):u.splice(i,0,l,l+o.nodeSize,An(c,o,a+1,Ye)),i+=3}});let s=ro(i?io(n):n,-r);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new I(s.length?this.local.concat(s).sort(Xe):this.local,u||this.children)}remove(e){return e.length==0||this==W?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,u=this.local;for(let i=0;i<r.length;i+=3){let s,o=r[i]+n,l=r[i+1]+n;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>o&&f.to<l&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let a=r[i+2].removeInner(s,o+1);a!=W?r[i+2]=a:(r.splice(i,3),i-=3)}if(u.length){for(let i=0,s;i<e.length;i++)if(s=e[i])for(let o=0;o<u.length;o++)u[o].eq(s,n)&&(u==this.local&&(u=this.local.slice()),u.splice(o--,1))}return r==this.children&&u==this.local?this:u.length||r.length?new I(u,r):W}forChild(e,n){if(this==W)return this;if(n.isLeaf)return I.empty;let r,u;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(r=this.children[o+2]);break}let i=e+1,s=i+n.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<s&&l.to>i&&l.type instanceof Ve){let a=Math.max(i,l.from)-i,c=Math.min(s,l.to)-i;a<c&&(u||(u=[])).push(l.copy(a,c))}}if(u){let o=new I(u.sort(Xe),ct);return r?new Ne([o,r]):o}return r||W}eq(e){if(this==e)return!0;if(!(e instanceof I)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return iu(this.localsInner(e))}localsInner(e){if(this==W)return ct;if(e.inlineContent||!this.local.some(Ve.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ve||n.push(this.local[r]);return n}forEachSet(e){e(this)}}I.empty=new I([],[]);I.removeOverlap=iu;const W=I.empty;class Ne{constructor(e){this.members=e}map(e,n){const r=this.members.map(u=>u.map(e,n,Ye));return Ne.from(r)}forChild(e,n){if(n.isLeaf)return I.empty;let r=[];for(let u=0;u<this.members.length;u++){let i=this.members[u].forChild(e,n);i!=W&&(i instanceof Ne?r=r.concat(i.members):r.push(i))}return Ne.from(r)}eq(e){if(!(e instanceof Ne)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let u=0;u<this.members.length;u++){let i=this.members[u].localsInner(e);if(i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(let s=0;s<i.length;s++)n.push(i[s])}}return n?iu(r?n:n.sort(Xe)):ct}static from(e){switch(e.length){case 0:return W;case 1:return e[0];default:return new Ne(e.every(n=>n instanceof I)?e:e.reduce((n,r)=>n.concat(r instanceof I?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function pc(t,e,n,r,u,i,s){let o=t.slice();for(let a=0,c=i;a<n.maps.length;a++){let f=0;n.maps[a].forEach((h,p,d,m)=>{let g=m-d-(p-h);for(let b=0;b<o.length;b+=3){let y=o[b+1];if(y<0||h>y+c-f)continue;let C=o[b]+c-f;p>=C?o[b+1]=h<=C?-2:-1:h>=c&&g&&(o[b]+=g,o[b+1]+=g)}f+=g}),c=n.maps[a].map(c,-1)}let l=!1;for(let a=0;a<o.length;a+=3)if(o[a+1]<0){if(o[a+1]==-2){l=!0,o[a+1]=-1;continue}let c=n.map(t[a]+i),f=c-u;if(f<0||f>=r.content.size){l=!0;continue}let h=n.map(t[a+1]+i,-1),p=h-u,{index:d,offset:m}=r.content.findIndex(f),g=r.maybeChild(d);if(g&&m==f&&m+g.nodeSize==p){let b=o[a+2].mapInner(n,g,c+1,t[a]+i+1,s);b!=W?(o[a]=f,o[a+1]=p,o[a+2]=b):(o[a+1]=-2,l=!0)}else l=!0}if(l){let a=mc(o,t,e,n,u,i,s),c=An(a,r,0,s);e=c.local;for(let f=0;f<o.length;f+=3)o[f+1]<0&&(o.splice(f,3),f-=3);for(let f=0,h=0;f<c.children.length;f+=3){let p=c.children[f];for(;h<o.length&&o[h]<p;)h+=3;o.splice(h,0,c.children[f],c.children[f+1],c.children[f+2])}}return new I(e.sort(Xe),o)}function ro(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let u=t[r];n.push(new oe(u.from+e,u.to+e,u.type))}return n}function mc(t,e,n,r,u,i,s){function o(l,a){for(let c=0;c<l.local.length;c++){let f=l.local[c].map(r,u,a);f?n.push(f):s.onRemove&&s.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)o(l.children[c+2],l.children[c]+a+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&o(t[l+2],e[l]+i+1);return n}function uo(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,u=null;for(let i=0,s;i<t.length;i++)(s=t[i])&&s.from>n&&s.to<r&&((u||(u=[])).push(s),t[i]=null);return u}function io(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function An(t,e,n,r){let u=[],i=!1;e.forEach((o,l)=>{let a=uo(t,o,l+n);if(a){i=!0;let c=An(a,o,n+l+1,r);c!=W&&u.push(l,l+o.nodeSize,c)}});let s=ro(i?io(t):t,-n).sort(Xe);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||(r.onRemove&&r.onRemove(s[o].spec),s.splice(o--,1));return s.length||u.length?new I(s,u):W}function Xe(t,e){return t.from-e.from||t.to-e.to}function iu(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let u=n+1;u<e.length;u++){let i=e[u];if(i.from==r.from){i.to!=r.to&&(e==t&&(e=t.slice()),e[u]=i.copy(i.from,r.to),si(e,u+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),si(e,u,r.copy(i.from,r.to)));break}}}return e}function si(t,e,n){for(;e<t.length&&Xe(n,t[e])>0;)e++;t.splice(e,0,n)}function nr(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=W&&e.push(r)}),t.cursorWrapper&&e.push(I.create(t.state.doc,[t.cursorWrapper.deco])),Ne.from(e)}const gc={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},bc=Y&&Le<=11;class xc{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class yc{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new xc,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let u=0;u<r.length;u++)this.queue.push(r[u]);Y&&Le<=11&&r.some(u=>u.type=="childList"&&u.removedNodes.length||u.type=="characterData"&&u.oldValue.length>u.target.nodeValue.length)?this.flushSoon():this.flush()}),bc&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,gc)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Yu(this.view)){if(this.suppressingSelectionUpdates)return Se(this.view);if(Y&&Le<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&nt(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let i=e.focusNode;i;i=xt(i))n.add(i);for(let i=e.anchorNode;i;i=xt(i))if(n.has(i)){r=i;break}let u=r&&this.view.docView.nearestDesc(r);if(u&&u.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),u=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Yu(e)&&!this.ignoreSelectionChange(r),i=-1,s=-1,o=!1,l=[];if(e.editable)for(let c=0;c<n.length;c++){let f=this.registerMutation(n[c],l);f&&(i=i<0?f.from:Math.min(f.from,i),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(o=!0))}if(fe&&l.length){let c=l.filter(f=>f.nodeName=="BR");if(c.length==2){let[f,h]=c;f.parentNode&&f.parentNode.parentNode==h.parentNode?h.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let h of c){let p=h.parentNode;p&&p.nodeName=="LI"&&(!f||Dc(e,f)!=p)&&h.remove()}}}let a=null;i<0&&u&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Bn(r)&&(a=Yr(e))&&a.eq(A.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Se(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||u)&&(i>-1&&(e.docView.markDirty(i,s),kc(e)),this.handleDOMChange(i,s,o,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Se(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let f=e.addedNodes[c];n.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let u=e.previousSibling,i=e.nextSibling;if(Y&&Le<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:h}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(u=f),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(i=h)}let s=u&&u.parentNode==e.target?L(u)+1:0,o=r.localPosFromDOM(e.target,s,-1),l=i&&i.parentNode==e.target?L(i):e.target.childNodes.length,a=r.localPosFromDOM(e.target,l,1);return{from:o,to:a}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let oi=new WeakMap,li=!1;function kc(t){if(!oi.has(t)&&(oi.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=fe,li)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),li=!0}}function ai(t,e){let n=e.startContainer,r=e.startOffset,u=e.endContainer,i=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return nt(s.node,s.offset,u,i)&&([n,r,u,i]=[u,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:u,focusOffset:i}}function Cc(t,e){if(e.getComposedRanges){let u=e.getComposedRanges(t.root)[0];if(u)return ai(t,u)}let n;function r(u){u.preventDefault(),u.stopImmediatePropagation(),n=u.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?ai(t,n):null}function Dc(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function wc(t,e,n){let{node:r,fromOffset:u,toOffset:i,from:s,to:o}=t.docView.parseRange(e,n),l=t.domSelectionRange(),a,c=l.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(a=[{node:c,offset:l.anchorOffset}],Bn(l)||a.push({node:l.focusNode,offset:l.focusOffset})),J&&t.input.lastKeyCode===8)for(let g=i;g>u;g--){let b=r.childNodes[g-1],y=b.pmViewDesc;if(b.nodeName=="BR"&&!y){i=g;break}if(!y||y.size)break}let f=t.state.doc,h=t.someProp("domParser")||Lt.fromSchema(t.state.schema),p=f.resolve(s),d=null,m=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:u,to:i,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:a,ruleFromNode:_c,context:p});if(a&&a[0].pos!=null){let g=a[0].pos,b=a[1]&&a[1].pos;b==null&&(b=g),d={anchor:g+s,head:b+s}}return{doc:m,sel:d,from:s,to:o}}function _c(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(U&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||U&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Ec=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Sc(t,e,n,r,u){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let S=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,G=Yr(t,S);if(G&&!t.state.selection.eq(G)){if(J&&Ee&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",Hn=>Hn(t,je(13,"Enter"))))return;let Ae=t.state.tr.setSelection(G);S=="pointer"?Ae.setMeta("pointer",!0):S=="key"&&Ae.scrollIntoView(),i&&Ae.setMeta("composition",i),t.dispatch(Ae)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(n);e=s.before(o+1),n=t.state.doc.resolve(n).after(o+1);let l=t.state.selection,a=wc(t,e,n),c=t.state.doc,f=c.slice(a.from,a.to),h,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,p="end"):(h=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let d=Oc(f.content,a.doc.content,a.from,h,p);if(d&&t.input.domChangeCount++,(yt&&t.input.lastIOSEnter>Date.now()-225||Ee)&&u.some(S=>S.nodeType==1&&!Ec.test(S.nodeName))&&(!d||d.endA>=d.endB)&&t.someProp("handleKeyDown",S=>S(t,je(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!d)if(r&&l instanceof O&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(a.sel&&a.sel.anchor!=a.sel.head))d={start:l.from,endA:l.to,endB:l.to};else{if(a.sel){let S=ci(t,t.state.doc,a.sel);if(S&&!S.eq(t.state.selection)){let G=t.state.tr.setSelection(S);i&&G.setMeta("composition",i),t.dispatch(G)}}return}t.state.selection.from<t.state.selection.to&&d.start==d.endB&&t.state.selection instanceof O&&(d.start>t.state.selection.from&&d.start<=t.state.selection.from+2&&t.state.selection.from>=a.from?d.start=t.state.selection.from:d.endA<t.state.selection.to&&d.endA>=t.state.selection.to-2&&t.state.selection.to<=a.to&&(d.endB+=t.state.selection.to-d.endA,d.endA=t.state.selection.to)),Y&&Le<=11&&d.endB==d.start+1&&d.endA==d.start&&d.start>a.from&&a.doc.textBetween(d.start-a.from-1,d.start-a.from+1)==" "&&(d.start--,d.endA--,d.endB--);let m=a.doc.resolveNoCache(d.start-a.from),g=a.doc.resolveNoCache(d.endB-a.from),b=c.resolve(d.start),y=m.sameParent(g)&&m.parent.inlineContent&&b.end()>=d.endA,C;if((yt&&t.input.lastIOSEnter>Date.now()-225&&(!y||u.some(S=>S.nodeName=="DIV"||S.nodeName=="P"))||!y&&m.pos<a.doc.content.size&&!m.sameParent(g)&&(C=A.findFrom(a.doc.resolve(m.pos+1),1,!0))&&C.head==g.pos)&&t.someProp("handleKeyDown",S=>S(t,je(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>d.start&&Mc(c,d.start,d.endA,m,g)&&t.someProp("handleKeyDown",S=>S(t,je(8,"Backspace")))){Ee&&J&&t.domObserver.suppressSelectionUpdates();return}J&&d.endB==d.start&&(t.input.lastChromeDelete=Date.now()),Ee&&!y&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&a.sel&&a.sel.anchor==a.sel.head&&a.sel.head==d.endA&&(d.endB-=2,g=a.doc.resolveNoCache(d.endB-a.from),setTimeout(()=>{t.someProp("handleKeyDown",function(S){return S(t,je(13,"Enter"))})},20));let D=d.start,_=d.endA,E,N,$;if(y){if(m.pos==g.pos)Y&&Le<=11&&m.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Se(t),20)),E=t.state.tr.delete(D,_),N=c.resolve(d.start).marksAcross(c.resolve(d.endA));else if(d.endA==d.endB&&($=Ac(m.parent.content.cut(m.parentOffset,g.parentOffset),b.parent.content.cut(b.parentOffset,d.endA-b.start()))))E=t.state.tr,$.type=="add"?E.addMark(D,_,$.mark):E.removeMark(D,_,$.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let S=m.parent.textBetween(m.parentOffset,g.parentOffset);if(t.someProp("handleTextInput",G=>G(t,D,_,S)))return;E=t.state.tr.insertText(S,D,_)}}if(E||(E=t.state.tr.replace(D,_,a.doc.slice(d.start-a.from,d.endB-a.from))),a.sel){let S=ci(t,E.doc,a.sel);S&&!(J&&t.composing&&S.empty&&(d.start!=d.endB||t.input.lastChromeDelete<Date.now()-100)&&(S.head==D||S.head==E.mapping.map(_)-1)||Y&&S.empty&&S.head==D)&&E.setSelection(S)}N&&E.ensureMarks(N),i&&E.setMeta("composition",i),t.dispatch(E.scrollIntoView())}function ci(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Xr(t,e.resolve(n.anchor),e.resolve(n.head))}function Ac(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,u=n,i=r,s,o,l;for(let c=0;c<r.length;c++)u=r[c].removeFromSet(u);for(let c=0;c<n.length;c++)i=n[c].removeFromSet(i);if(u.length==1&&i.length==0)o=u[0],s="add",l=c=>c.mark(o.addToSet(c.marks));else if(u.length==0&&i.length==1)o=i[0],s="remove",l=c=>c.mark(o.removeFromSet(c.marks));else return null;let a=[];for(let c=0;c<e.childCount;c++)a.push(l(e.child(c)));if(x.from(a).eq(t))return{mark:o,type:s}}function Mc(t,e,n,r,u){if(n-e<=u.pos-r.pos||rr(r,!0,!1)<u.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let o=i.nodeAfter;return o!=null&&n==e+o.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=t.resolve(rr(i,!0,!0));return!s.parent.isTextblock||s.pos>n||rr(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function rr(t,e,n){let r=t.depth,u=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,u++,e=!1;if(n){let i=t.node(r).maybeChild(t.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,u++}return u}function Oc(t,e,n,r,u){let i=t.findDiffStart(e,n);if(i==null)return null;let{a:s,b:o}=t.findDiffEnd(e,n+t.size,n+e.size);if(u=="end"){let l=Math.max(0,i-Math.min(s,o));r-=s+l-i}if(s<i&&t.size<e.size){let l=r<=i&&r>=s?i-r:0;i-=l,i&&i<e.size&&fi(e.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-s),s=i}else if(o<i){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<t.size&&fi(t.textBetween(i-1,i+1))&&(i+=l?1:-1),s=i+(s-o),o=i}return{start:i,endA:s,endB:o}}function fi(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class Tc{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Za,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(gi),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=pi(this),hi(this),this.nodeViews=mi(this),this.docView=ju(this.state.doc,di(this),nr(this),this.dom,this),this.domObserver=new yc(this,(r,u,i,s)=>Sc(this,r,u,i,s)),this.domObserver.start(),Ga(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ir(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(gi),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let u=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&(Xs(this),s=!0),this.state=e;let o=u.plugins!=e.plugins||this._props.plugins!=n.plugins;if(o||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=mi(this);Nc(p,this.nodeViews)&&(this.nodeViews=p,i=!0)}(o||n.handleDOMEvents!=this._props.handleDOMEvents)&&Ir(this),this.editable=pi(this),hi(this);let l=nr(this),a=di(this),c=u.plugins!=e.plugins&&!u.doc.eq(e.doc)?"reset":e.scrollToSelection>u.scrollToSelection?"to selection":"preserve",f=i||!this.docView.matchesNode(e.doc,a,l);(f||!e.selection.eq(u.selection))&&(s=!0);let h=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&ca(this);if(s){this.domObserver.stop();let p=f&&(Y||J)&&!this.composing&&!u.selection.empty&&!e.selection.empty&&Fc(u.selection,e.selection);if(f){let d=J?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=ac(this)),(i||!this.docView.update(e.doc,a,l,this))&&(this.docView.updateOuterDeco(a),this.docView.destroy(),this.docView=ju(e.doc,a,l,this.dom,this)),d&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Ia(this))?Se(this,p):(Vs(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(u),!((r=this.dragging)===null||r===void 0)&&r.node&&!u.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,u),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():h&&fa(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof w){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&qu(this,n.getBoundingClientRect(),e)}else qu(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,u=-1;if(this.state.doc.nodeAt(r.from)==r.node)u=r.from;else{let i=r.from+(this.state.doc.content.size-n.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(u=i)}this.dragging=new to(e.slice,e.move,u<0?void 0:w.create(this.state.doc,u))}someProp(e,n){let r=this._props&&this._props[e],u;if(r!=null&&(u=n?n(r):r))return u;for(let s=0;s<this.directPlugins.length;s++){let o=this.directPlugins[s].props[e];if(o!=null&&(u=n?n(o):o))return u}let i=this.state.plugins;if(i)for(let s=0;s<i.length;s++){let o=i[s].props[e];if(o!=null&&(u=n?n(o):o))return u}}hasFocus(){if(Y){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&da(this.dom),Se(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return ba(this,e)}coordsAtPos(e,n=1){return vs(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let u=this.docView.posFromDOM(e,n,r);if(u==null)throw new RangeError("DOM position not inside the editor");return u}endOfTextblock(e,n){return Da(this,n||this.state,e)}pasteHTML(e,n){return Ht(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Ht(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return eu(this,e)}destroy(){this.docView&&(Qa(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],nr(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Xl())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Xa(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?U&&this.root.nodeType===11&&ua(this.dom.ownerDocument)==this.dom&&Cc(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function di(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[oe.node(0,t.state.doc.content.size,e)]}function hi(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:oe.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function pi(t){return!t.someProp("editable",e=>e(t.state)===!1)}function Fc(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function mi(t){let e=Object.create(null);function n(r){for(let u in r)Object.prototype.hasOwnProperty.call(e,u)||(e[u]=r[u])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function Nc(t,e){let n=0,r=0;for(let u in t){if(t[u]!=e[u])return!0;n++}for(let u in e)r++;return n!=r}function gi(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}const bi={};function vc(t){let e=bi[t];if(e)return e;e=bi[t]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);e.push(r)}for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}function kt(t,e){typeof e!="string"&&(e=kt.defaultChars);const n=vc(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(r){let u="";for(let i=0,s=r.length;i<s;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){u+=n[o];continue}if((o&224)===192&&i+3<s){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const a=o<<6&1984|l&63;a<128?u+="":u+=String.fromCharCode(a),i+=3;continue}}if((o&240)===224&&i+6<s){const l=parseInt(r.slice(i+4,i+6),16),a=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(a&192)===128){const c=o<<12&61440|l<<6&4032|a&63;c<2048||c>=55296&&c<=57343?u+="":u+=String.fromCharCode(c),i+=6;continue}}if((o&248)===240&&i+9<s){const l=parseInt(r.slice(i+4,i+6),16),a=parseInt(r.slice(i+7,i+9),16),c=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(a&192)===128&&(c&192)===128){let f=o<<18&1835008|l<<12&258048|a<<6&4032|c&63;f<65536||f>1114111?u+="":(f-=65536,u+=String.fromCharCode(55296+(f>>10),56320+(f&1023))),i+=9;continue}}u+=""}return u})}kt.defaultChars=";/?:@&=+$,#";kt.componentChars="";const xi={};function Ic(t){let e=xi[t];if(e)return e;e=xi[t]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?e.push(r):e.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<t.length;n++)e[t.charCodeAt(n)]=t[n];return e}function nn(t,e,n){typeof e!="string"&&(n=e,e=nn.defaultChars),typeof n>"u"&&(n=!0);const r=Ic(e);let u="";for(let i=0,s=t.length;i<s;i++){const o=t.charCodeAt(i);if(n&&o===37&&i+2<s&&/^[0-9a-f]{2}$/i.test(t.slice(i+1,i+3))){u+=t.slice(i,i+3),i+=2;continue}if(o<128){u+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<s){const l=t.charCodeAt(i+1);if(l>=56320&&l<=57343){u+=encodeURIComponent(t[i]+t[i+1]),i++;continue}}u+="%EF%BF%BD";continue}u+=encodeURIComponent(t[i])}return u}nn.defaultChars=";/?:@&=+$,-_.!~*'()#";nn.componentChars="-_.!~*'()";function su(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&t.hostname.indexOf(":")!==-1?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function Mn(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const Rc=/^([a-z0-9.+-]+:)/i,Bc=/:[0-9]*$/,zc=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Pc=["<",">",'"',"`"," ","\r",`
`,"	"],Lc=["{","}","|","\\","^","`"].concat(Pc),qc=["'"].concat(Lc),yi=["%","/","?",";","#"].concat(qc),ki=["/","?","#"],Vc=255,Ci=/^[+a-z0-9A-Z_-]{0,63}$/,$c=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Di={javascript:!0,"javascript:":!0},wi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function ou(t,e){if(t&&t instanceof Mn)return t;const n=new Mn;return n.parse(t,e),n}Mn.prototype.parse=function(t,e){let n,r,u,i=t;if(i=i.trim(),!e&&t.split("#").length===1){const a=zc.exec(i);if(a)return this.pathname=a[1],a[2]&&(this.search=a[2]),this}let s=Rc.exec(i);if(s&&(s=s[0],n=s.toLowerCase(),this.protocol=s,i=i.substr(s.length)),(e||s||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(u=i.substr(0,2)==="//",u&&!(s&&Di[s])&&(i=i.substr(2),this.slashes=!0)),!Di[s]&&(u||s&&!wi[s])){let a=-1;for(let d=0;d<ki.length;d++)r=i.indexOf(ki[d]),r!==-1&&(a===-1||r<a)&&(a=r);let c,f;a===-1?f=i.lastIndexOf("@"):f=i.lastIndexOf("@",a),f!==-1&&(c=i.slice(0,f),i=i.slice(f+1),this.auth=c),a=-1;for(let d=0;d<yi.length;d++)r=i.indexOf(yi[d]),r!==-1&&(a===-1||r<a)&&(a=r);a===-1&&(a=i.length),i[a-1]===":"&&a--;const h=i.slice(0,a);i=i.slice(a),this.parseHost(h),this.hostname=this.hostname||"";const p=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!p){const d=this.hostname.split(/\./);for(let m=0,g=d.length;m<g;m++){const b=d[m];if(b&&!b.match(Ci)){let y="";for(let C=0,D=b.length;C<D;C++)b.charCodeAt(C)>127?y+="x":y+=b[C];if(!y.match(Ci)){const C=d.slice(0,m),D=d.slice(m+1),_=b.match($c);_&&(C.push(_[1]),D.unshift(_[2])),D.length&&(i=D.join(".")+i),this.hostname=C.join(".");break}}}}this.hostname.length>Vc&&(this.hostname=""),p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),wi[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};Mn.prototype.parseHost=function(t){let e=Bc.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const Wc=Object.freeze(Object.defineProperty({__proto__:null,decode:kt,encode:nn,format:su,parse:ou},Symbol.toStringTag,{value:"Module"})),so=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,oo=/[\0-\x1F\x7F-\x9F]/,Hc=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,lu=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,lo=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,ao=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Jc=Object.freeze(Object.defineProperty({__proto__:null,Any:so,Cc:oo,Cf:Hc,P:lu,S:lo,Z:ao},Symbol.toStringTag,{value:"Module"})),jc=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),Uc=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var ur;const Kc=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Zc=(ur=String.fromCodePoint)!==null&&ur!==void 0?ur:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function Gc(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=Kc.get(t))!==null&&e!==void 0?e:t}var B;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(B||(B={}));const Qc=32;var Pe;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Pe||(Pe={}));function Rr(t){return t>=B.ZERO&&t<=B.NINE}function Yc(t){return t>=B.UPPER_A&&t<=B.UPPER_F||t>=B.LOWER_A&&t<=B.LOWER_F}function Xc(t){return t>=B.UPPER_A&&t<=B.UPPER_Z||t>=B.LOWER_A&&t<=B.LOWER_Z||Rr(t)}function ef(t){return t===B.EQUALS||Xc(t)}var R;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(R||(R={}));var ve;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(ve||(ve={}));class tf{constructor(e,n,r){this.decodeTree=e,this.emitCodePoint=n,this.errors=r,this.state=R.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ve.Strict}startEntity(e){this.decodeMode=e,this.state=R.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case R.EntityStart:return e.charCodeAt(n)===B.NUM?(this.state=R.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=R.NamedEntity,this.stateNamedEntity(e,n));case R.NumericStart:return this.stateNumericStart(e,n);case R.NumericDecimal:return this.stateNumericDecimal(e,n);case R.NumericHex:return this.stateNumericHex(e,n);case R.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|Qc)===B.LOWER_X?(this.state=R.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=R.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,r,u){if(n!==r){const i=r-n;this.result=this.result*Math.pow(u,i)+parseInt(e.substr(n,i),u),this.consumed+=i}}stateNumericHex(e,n){const r=n;for(;n<e.length;){const u=e.charCodeAt(n);if(Rr(u)||Yc(u))n+=1;else return this.addToNumericResult(e,r,n,16),this.emitNumericEntity(u,3)}return this.addToNumericResult(e,r,n,16),-1}stateNumericDecimal(e,n){const r=n;for(;n<e.length;){const u=e.charCodeAt(n);if(Rr(u))n+=1;else return this.addToNumericResult(e,r,n,10),this.emitNumericEntity(u,2)}return this.addToNumericResult(e,r,n,10),-1}emitNumericEntity(e,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===B.SEMI)this.consumed+=1;else if(this.decodeMode===ve.Strict)return 0;return this.emitCodePoint(Gc(this.result),this.consumed),this.errors&&(e!==B.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:r}=this;let u=r[this.treeIndex],i=(u&Pe.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const s=e.charCodeAt(n);if(this.treeIndex=nf(r,u,this.treeIndex+Math.max(1,i),s),this.treeIndex<0)return this.result===0||this.decodeMode===ve.Attribute&&(i===0||ef(s))?0:this.emitNotTerminatedNamedEntity();if(u=r[this.treeIndex],i=(u&Pe.VALUE_LENGTH)>>14,i!==0){if(s===B.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ve.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:r}=this,u=(r[n]&Pe.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,u,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,r){const{decodeTree:u}=this;return this.emitCodePoint(n===1?u[e]&~Pe.VALUE_LENGTH:u[e+1],r),n===3&&this.emitCodePoint(u[e+2],r),r}end(){var e;switch(this.state){case R.NamedEntity:return this.result!==0&&(this.decodeMode!==ve.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case R.NumericDecimal:return this.emitNumericEntity(0,2);case R.NumericHex:return this.emitNumericEntity(0,3);case R.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case R.EntityStart:return 0}}}function co(t){let e="";const n=new tf(t,r=>e+=Zc(r));return function(u,i){let s=0,o=0;for(;(o=u.indexOf("&",o))>=0;){e+=u.slice(s,o),n.startEntity(i);const a=n.write(u,o+1);if(a<0){s=o+n.end();break}s=o+a,o=a===0?s+1:s}const l=e+u.slice(s);return e="",l}}function nf(t,e,n,r){const u=(e&Pe.BRANCH_LENGTH)>>7,i=e&Pe.JUMP_TABLE;if(u===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=u?-1:t[n+l]-1}let s=n,o=s+u-1;for(;s<=o;){const l=s+o>>>1,a=t[l];if(a<r)s=l+1;else if(a>r)o=l-1;else return t[l+u]}return-1}const rf=co(jc);co(Uc);function fo(t,e=ve.Legacy){return rf(t,e)}function uf(t){return Object.prototype.toString.call(t)}function au(t){return uf(t)==="[object String]"}const sf=Object.prototype.hasOwnProperty;function of(t,e){return sf.call(t,e)}function Ln(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){t[r]=n[r]})}}),t}function ho(t,e,n){return[].concat(t.slice(0,e),n,t.slice(e+1))}function cu(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function On(t){if(t>65535){t-=65536;const e=55296+(t>>10),n=56320+(t&1023);return String.fromCharCode(e,n)}return String.fromCharCode(t)}const po=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,lf=/&([a-z#][a-z0-9]{1,31});/gi,af=new RegExp(po.source+"|"+lf.source,"gi"),cf=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function ff(t,e){if(e.charCodeAt(0)===35&&cf.test(e)){const r=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return cu(r)?On(r):t}const n=fo(t);return n!==t?n:t}function df(t){return t.indexOf("\\")<0?t:t.replace(po,"$1")}function Ct(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(af,function(e,n,r){return n||ff(e,r)})}const hf=/[&<>"]/,pf=/[&<>"]/g,mf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function gf(t){return mf[t]}function $e(t){return hf.test(t)?t.replace(pf,gf):t}const bf=/[.?*+^$[\]\\(){}|-]/g;function xf(t){return t.replace(bf,"\\$&")}function T(t){switch(t){case 9:case 32:return!0}return!1}function jt(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Ut(t){return lu.test(t)||lo.test(t)}function Kt(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function qn(t){return t=t.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(t=t.replace(//g,"")),t.toLowerCase().toUpperCase()}const yf={mdurl:Wc,ucmicro:Jc},kf=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:ho,assign:Ln,escapeHtml:$e,escapeRE:xf,fromCodePoint:On,has:of,isMdAsciiPunct:Kt,isPunctChar:Ut,isSpace:T,isString:au,isValidEntityCode:cu,isWhiteSpace:jt,lib:yf,normalizeReference:qn,unescapeAll:Ct,unescapeMd:df},Symbol.toStringTag,{value:"Module"}));function Cf(t,e,n){let r,u,i,s;const o=t.posMax,l=t.pos;for(t.pos=e+1,r=1;t.pos<o;){if(i=t.src.charCodeAt(t.pos),i===93&&(r--,r===0)){u=!0;break}if(s=t.pos,t.md.inline.skipToken(t),i===91){if(s===t.pos-1)r++;else if(n)return t.pos=l,-1}}let a=-1;return u&&(a=t.pos),t.pos=l,a}function Df(t,e,n){let r,u=e;const i={ok:!1,pos:0,str:""};if(t.charCodeAt(u)===60){for(u++;u<n;){if(r=t.charCodeAt(u),r===10||r===60)return i;if(r===62)return i.pos=u+1,i.str=Ct(t.slice(e+1,u)),i.ok=!0,i;if(r===92&&u+1<n){u+=2;continue}u++}return i}let s=0;for(;u<n&&(r=t.charCodeAt(u),!(r===32||r<32||r===127));){if(r===92&&u+1<n){if(t.charCodeAt(u+1)===32)break;u+=2;continue}if(r===40&&(s++,s>32))return i;if(r===41){if(s===0)break;s--}u++}return e===u||s!==0||(i.str=Ct(t.slice(e,u)),i.pos=u,i.ok=!0),i}function wf(t,e,n,r){let u,i=e;const s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(i>=n)return s;let o=t.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return s;e++,i++,o===40&&(o=41),s.marker=o}for(;i<n;){if(u=t.charCodeAt(i),u===s.marker)return s.pos=i+1,s.str+=Ct(t.slice(e,i)),s.ok=!0,s;if(u===40&&s.marker===41)return s;u===92&&i+1<n&&i++,i++}return s.can_continue=!0,s.str+=Ct(t.slice(e,i)),s}const _f=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:Df,parseLinkLabel:Cf,parseLinkTitle:wf},Symbol.toStringTag,{value:"Module"})),ke={};ke.code_inline=function(t,e,n,r,u){const i=t[e];return"<code"+u.renderAttrs(i)+">"+$e(i.content)+"</code>"};ke.code_block=function(t,e,n,r,u){const i=t[e];return"<pre"+u.renderAttrs(i)+"><code>"+$e(t[e].content)+`</code></pre>
`};ke.fence=function(t,e,n,r,u){const i=t[e],s=i.info?Ct(i.info).trim():"";let o="",l="";if(s){const c=s.split(/(\s+)/g);o=c[0],l=c.slice(2).join("")}let a;if(n.highlight?a=n.highlight(i.content,o,l)||$e(i.content):a=$e(i.content),a.indexOf("<pre")===0)return a+`
`;if(s){const c=i.attrIndex("class"),f=i.attrs?i.attrs.slice():[];c<0?f.push(["class",n.langPrefix+o]):(f[c]=f[c].slice(),f[c][1]+=" "+n.langPrefix+o);const h={attrs:f};return`<pre><code${u.renderAttrs(h)}>${a}</code></pre>
`}return`<pre><code${u.renderAttrs(i)}>${a}</code></pre>
`};ke.image=function(t,e,n,r,u){const i=t[e];return i.attrs[i.attrIndex("alt")][1]=u.renderInlineAsText(i.children,n,r),u.renderToken(t,e,n)};ke.hardbreak=function(t,e,n){return n.xhtmlOut?`<br />
`:`<br>
`};ke.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};ke.text=function(t,e){return $e(t[e].content)};ke.html_block=function(t,e){return t[e].content};ke.html_inline=function(t,e){return t[e].content};function Et(){this.rules=Ln({},ke)}Et.prototype.renderAttrs=function(e){let n,r,u;if(!e.attrs)return"";for(u="",n=0,r=e.attrs.length;n<r;n++)u+=" "+$e(e.attrs[n][0])+'="'+$e(e.attrs[n][1])+'"';return u};Et.prototype.renderToken=function(e,n,r){const u=e[n];let i="";if(u.hidden)return"";u.block&&u.nesting!==-1&&n&&e[n-1].hidden&&(i+=`
`),i+=(u.nesting===-1?"</":"<")+u.tag,i+=this.renderAttrs(u),u.nesting===0&&r.xhtmlOut&&(i+=" /");let s=!1;if(u.block&&(s=!0,u.nesting===1&&n+1<e.length)){const o=e[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===u.tag)&&(s=!1)}return i+=s?`>
`:">",i};Et.prototype.renderInline=function(t,e,n){let r="";const u=this.rules;for(let i=0,s=t.length;i<s;i++){const o=t[i].type;typeof u[o]<"u"?r+=u[o](t,i,e,n,this):r+=this.renderToken(t,i,e)}return r};Et.prototype.renderInlineAsText=function(t,e,n){let r="";for(let u=0,i=t.length;u<i;u++)switch(t[u].type){case"text":r+=t[u].content;break;case"image":r+=this.renderInlineAsText(t[u].children,e,n);break;case"html_inline":case"html_block":r+=t[u].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};Et.prototype.render=function(t,e,n){let r="";const u=this.rules;for(let i=0,s=t.length;i<s;i++){const o=t[i].type;o==="inline"?r+=this.renderInline(t[i].children,e,n):typeof u[o]<"u"?r+=u[o](t,i,e,n,this):r+=this.renderToken(t,i,e,n)}return r};function X(){this.__rules__=[],this.__cache__=null}X.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1};X.prototype.__compile__=function(){const t=this,e=[""];t.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),t.__cache__={},e.forEach(function(n){t.__cache__[n]=[],t.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||t.__cache__[n].push(r.fn))})})};X.prototype.at=function(t,e,n){const r=this.__find__(t),u=n||{};if(r===-1)throw new Error("Parser rule not found: "+t);this.__rules__[r].fn=e,this.__rules__[r].alt=u.alt||[],this.__cache__=null};X.prototype.before=function(t,e,n,r){const u=this.__find__(t),i=r||{};if(u===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(u,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};X.prototype.after=function(t,e,n,r){const u=this.__find__(t),i=r||{};if(u===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(u+1,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};X.prototype.push=function(t,e,n){const r=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};X.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(r){const u=this.__find__(r);if(u<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[u].enabled=!0,n.push(r)},this),this.__cache__=null,n};X.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(t,e)};X.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(r){const u=this.__find__(r);if(u<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[u].enabled=!1,n.push(r)},this),this.__cache__=null,n};X.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};function de(t,e,n){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}de.prototype.attrIndex=function(e){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,u=n.length;r<u;r++)if(n[r][0]===e)return r;return-1};de.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};de.prototype.attrSet=function(e,n){const r=this.attrIndex(e),u=[e,n];r<0?this.attrPush(u):this.attrs[r]=u};de.prototype.attrGet=function(e){const n=this.attrIndex(e);let r=null;return n>=0&&(r=this.attrs[n][1]),r};de.prototype.attrJoin=function(e,n){const r=this.attrIndex(e);r<0?this.attrPush([e,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function mo(t,e,n){this.src=t,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=e}mo.prototype.Token=de;const Ef=/\r\n?|\n/g,Sf=/\0/g;function Af(t){let e;e=t.src.replace(Ef,`
`),e=e.replace(Sf,""),t.src=e}function Mf(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}function Of(t){const e=t.tokens;for(let n=0,r=e.length;n<r;n++){const u=e[n];u.type==="inline"&&t.md.inline.parse(u.content,t.md,t.env,u.children)}}function Tf(t){return/^<a[>\s]/i.test(t)}function Ff(t){return/^<\/a\s*>/i.test(t)}function Nf(t){const e=t.tokens;if(t.md.options.linkify)for(let n=0,r=e.length;n<r;n++){if(e[n].type!=="inline"||!t.md.linkify.pretest(e[n].content))continue;let u=e[n].children,i=0;for(let s=u.length-1;s>=0;s--){const o=u[s];if(o.type==="link_close"){for(s--;u[s].level!==o.level&&u[s].type!=="link_open";)s--;continue}if(o.type==="html_inline"&&(Tf(o.content)&&i>0&&i--,Ff(o.content)&&i++),!(i>0)&&o.type==="text"&&t.md.linkify.test(o.content)){const l=o.content;let a=t.md.linkify.match(l);const c=[];let f=o.level,h=0;a.length>0&&a[0].index===0&&s>0&&u[s-1].type==="text_special"&&(a=a.slice(1));for(let p=0;p<a.length;p++){const d=a[p].url,m=t.md.normalizeLink(d);if(!t.md.validateLink(m))continue;let g=a[p].text;a[p].schema?a[p].schema==="mailto:"&&!/^mailto:/i.test(g)?g=t.md.normalizeLinkText("mailto:"+g).replace(/^mailto:/,""):g=t.md.normalizeLinkText(g):g=t.md.normalizeLinkText("http://"+g).replace(/^http:\/\//,"");const b=a[p].index;if(b>h){const _=new t.Token("text","",0);_.content=l.slice(h,b),_.level=f,c.push(_)}const y=new t.Token("link_open","a",1);y.attrs=[["href",m]],y.level=f++,y.markup="linkify",y.info="auto",c.push(y);const C=new t.Token("text","",0);C.content=g,C.level=f,c.push(C);const D=new t.Token("link_close","a",-1);D.level=--f,D.markup="linkify",D.info="auto",c.push(D),h=a[p].lastIndex}if(h<l.length){const p=new t.Token("text","",0);p.content=l.slice(h),p.level=f,c.push(p)}e[n].children=u=ho(u,s,c)}}}}const go=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,vf=/\((c|tm|r)\)/i,If=/\((c|tm|r)\)/ig,Rf={c:"",r:"",tm:""};function Bf(t,e){return Rf[e.toLowerCase()]}function zf(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];r.type==="text"&&!e&&(r.content=r.content.replace(If,Bf)),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function Pf(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];r.type==="text"&&!e&&go.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function Lf(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)t.tokens[e].type==="inline"&&(vf.test(t.tokens[e].content)&&zf(t.tokens[e].children),go.test(t.tokens[e].content)&&Pf(t.tokens[e].children))}const qf=/['"]/,_i=/['"]/g,Ei="";function ln(t,e,n){return t.slice(0,e)+n+t.slice(e+1)}function Vf(t,e){let n;const r=[];for(let u=0;u<t.length;u++){const i=t[u],s=t[u].level;for(n=r.length-1;n>=0&&!(r[n].level<=s);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,a=o.length;e:for(;l<a;){_i.lastIndex=l;const c=_i.exec(o);if(!c)break;let f=!0,h=!0;l=c.index+1;const p=c[0]==="'";let d=32;if(c.index-1>=0)d=o.charCodeAt(c.index-1);else for(n=u-1;n>=0&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n--)if(t[n].content){d=t[n].content.charCodeAt(t[n].content.length-1);break}let m=32;if(l<a)m=o.charCodeAt(l);else for(n=u+1;n<t.length&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n++)if(t[n].content){m=t[n].content.charCodeAt(0);break}const g=Kt(d)||Ut(String.fromCharCode(d)),b=Kt(m)||Ut(String.fromCharCode(m)),y=jt(d),C=jt(m);if(C?f=!1:b&&(y||g||(f=!1)),y?h=!1:g&&(C||b||(h=!1)),m===34&&c[0]==='"'&&d>=48&&d<=57&&(h=f=!1),f&&h&&(f=g,h=b),!f&&!h){p&&(i.content=ln(i.content,c.index,Ei));continue}if(h)for(n=r.length-1;n>=0;n--){let D=r[n];if(r[n].level<s)break;if(D.single===p&&r[n].level===s){D=r[n];let _,E;p?(_=e.md.options.quotes[2],E=e.md.options.quotes[3]):(_=e.md.options.quotes[0],E=e.md.options.quotes[1]),i.content=ln(i.content,c.index,E),t[D.token].content=ln(t[D.token].content,D.pos,_),l+=E.length-1,D.token===u&&(l+=_.length-1),o=i.content,a=o.length,r.length=n;continue e}}f?r.push({token:u,pos:c.index,single:p,level:s}):h&&p&&(i.content=ln(i.content,c.index,Ei))}}}function $f(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)t.tokens[e].type!=="inline"||!qf.test(t.tokens[e].content)||Vf(t.tokens[e].children,t)}function Wf(t){let e,n;const r=t.tokens,u=r.length;for(let i=0;i<u;i++){if(r[i].type!=="inline")continue;const s=r[i].children,o=s.length;for(e=0;e<o;e++)s[e].type==="text_special"&&(s[e].type="text");for(e=n=0;e<o;e++)s[e].type==="text"&&e+1<o&&s[e+1].type==="text"?s[e+1].content=s[e].content+s[e+1].content:(e!==n&&(s[n]=s[e]),n++);e!==n&&(s.length=n)}}const ir=[["normalize",Af],["block",Mf],["inline",Of],["linkify",Nf],["replacements",Lf],["smartquotes",$f],["text_join",Wf]];function fu(){this.ruler=new X;for(let t=0;t<ir.length;t++)this.ruler.push(ir[t][0],ir[t][1])}fu.prototype.process=function(t){const e=this.ruler.getRules("");for(let n=0,r=e.length;n<r;n++)e[n](t)};fu.prototype.State=mo;function Ce(t,e,n,r){this.src=t,this.md=e,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const u=this.src;for(let i=0,s=0,o=0,l=0,a=u.length,c=!1;s<a;s++){const f=u.charCodeAt(s);if(!c)if(T(f)){o++,f===9?l+=4-l%4:l++;continue}else c=!0;(f===10||s===a-1)&&(f!==10&&s++,this.bMarks.push(i),this.eMarks.push(s),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),c=!1,o=0,l=0,i=s+1)}this.bMarks.push(u.length),this.eMarks.push(u.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Ce.prototype.push=function(t,e,n){const r=new de(t,e,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};Ce.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Ce.prototype.skipEmptyLines=function(e){for(let n=this.lineMax;e<n&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Ce.prototype.skipSpaces=function(e){for(let n=this.src.length;e<n;e++){const r=this.src.charCodeAt(e);if(!T(r))break}return e};Ce.prototype.skipSpacesBack=function(e,n){if(e<=n)return e;for(;e>n;)if(!T(this.src.charCodeAt(--e)))return e+1;return e};Ce.prototype.skipChars=function(e,n){for(let r=this.src.length;e<r&&this.src.charCodeAt(e)===n;e++);return e};Ce.prototype.skipCharsBack=function(e,n,r){if(e<=r)return e;for(;e>r;)if(n!==this.src.charCodeAt(--e))return e+1;return e};Ce.prototype.getLines=function(e,n,r,u){if(e>=n)return"";const i=new Array(n-e);for(let s=0,o=e;o<n;o++,s++){let l=0;const a=this.bMarks[o];let c=a,f;for(o+1<n||u?f=this.eMarks[o]+1:f=this.eMarks[o];c<f&&l<r;){const h=this.src.charCodeAt(c);if(T(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(c-a<this.tShift[o])l++;else break;c++}l>r?i[s]=new Array(l-r+1).join(" ")+this.src.slice(c,f):i[s]=this.src.slice(c,f)}return i.join("")};Ce.prototype.Token=de;const Hf=65536;function sr(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];return t.src.slice(n,r)}function Si(t){const e=[],n=t.length;let r=0,u=t.charCodeAt(r),i=!1,s=0,o="";for(;r<n;)u===124&&(i?(o+=t.substring(s,r-1),s=r):(e.push(o+t.substring(s,r)),o="",s=r+1)),i=u===92,r++,u=t.charCodeAt(r);return e.push(o+t.substring(s)),e}function Jf(t,e,n,r){if(e+2>n)return!1;let u=e+1;if(t.sCount[u]<t.blkIndent||t.sCount[u]-t.blkIndent>=4)return!1;let i=t.bMarks[u]+t.tShift[u];if(i>=t.eMarks[u])return!1;const s=t.src.charCodeAt(i++);if(s!==124&&s!==45&&s!==58||i>=t.eMarks[u])return!1;const o=t.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!T(o)||s===45&&T(o))return!1;for(;i<t.eMarks[u];){const D=t.src.charCodeAt(i);if(D!==124&&D!==45&&D!==58&&!T(D))return!1;i++}let l=sr(t,e+1),a=l.split("|");const c=[];for(let D=0;D<a.length;D++){const _=a[D].trim();if(!_){if(D===0||D===a.length-1)continue;return!1}if(!/^:?-+:?$/.test(_))return!1;_.charCodeAt(_.length-1)===58?c.push(_.charCodeAt(0)===58?"center":"right"):_.charCodeAt(0)===58?c.push("left"):c.push("")}if(l=sr(t,e).trim(),l.indexOf("|")===-1||t.sCount[e]-t.blkIndent>=4)return!1;a=Si(l),a.length&&a[0]===""&&a.shift(),a.length&&a[a.length-1]===""&&a.pop();const f=a.length;if(f===0||f!==c.length)return!1;if(r)return!0;const h=t.parentType;t.parentType="table";const p=t.md.block.ruler.getRules("blockquote"),d=t.push("table_open","table",1),m=[e,0];d.map=m;const g=t.push("thead_open","thead",1);g.map=[e,e+1];const b=t.push("tr_open","tr",1);b.map=[e,e+1];for(let D=0;D<a.length;D++){const _=t.push("th_open","th",1);c[D]&&(_.attrs=[["style","text-align:"+c[D]]]);const E=t.push("inline","",0);E.content=a[D].trim(),E.children=[],t.push("th_close","th",-1)}t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let y,C=0;for(u=e+2;u<n&&!(t.sCount[u]<t.blkIndent);u++){let D=!1;for(let E=0,N=p.length;E<N;E++)if(p[E](t,u,n,!0)){D=!0;break}if(D||(l=sr(t,u).trim(),!l)||t.sCount[u]-t.blkIndent>=4||(a=Si(l),a.length&&a[0]===""&&a.shift(),a.length&&a[a.length-1]===""&&a.pop(),C+=f-a.length,C>Hf))break;if(u===e+2){const E=t.push("tbody_open","tbody",1);E.map=y=[e+2,0]}const _=t.push("tr_open","tr",1);_.map=[u,u+1];for(let E=0;E<f;E++){const N=t.push("td_open","td",1);c[E]&&(N.attrs=[["style","text-align:"+c[E]]]);const $=t.push("inline","",0);$.content=a[E]?a[E].trim():"",$.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return y&&(t.push("tbody_close","tbody",-1),y[1]=u),t.push("table_close","table",-1),m[1]=u,t.parentType=h,t.line=u,!0}function jf(t,e,n){if(t.sCount[e]-t.blkIndent<4)return!1;let r=e+1,u=r;for(;r<n;){if(t.isEmpty(r)){r++;continue}if(t.sCount[r]-t.blkIndent>=4){r++,u=r;continue}break}t.line=u;const i=t.push("code_block","code",0);return i.content=t.getLines(e,u,4+t.blkIndent,!1)+`
`,i.map=[e,t.line],!0}function Uf(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||u+3>i)return!1;const s=t.src.charCodeAt(u);if(s!==126&&s!==96)return!1;let o=u;u=t.skipChars(u,s);let l=u-o;if(l<3)return!1;const a=t.src.slice(o,u),c=t.src.slice(u,i);if(s===96&&c.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let f=e,h=!1;for(;f++,!(f>=n||(u=o=t.bMarks[f]+t.tShift[f],i=t.eMarks[f],u<i&&t.sCount[f]<t.blkIndent));)if(t.src.charCodeAt(u)===s&&!(t.sCount[f]-t.blkIndent>=4)&&(u=t.skipChars(u,s),!(u-o<l)&&(u=t.skipSpaces(u),!(u<i)))){h=!0;break}l=t.sCount[e],t.line=f+(h?1:0);const p=t.push("fence","code",0);return p.info=c,p.content=t.getLines(e+1,f,l,!0),p.markup=a,p.map=[e,t.line],!0}function Kf(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];const s=t.lineMax;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(u)!==62)return!1;if(r)return!0;const o=[],l=[],a=[],c=[],f=t.md.block.ruler.getRules("blockquote"),h=t.parentType;t.parentType="blockquote";let p=!1,d;for(d=e;d<n;d++){const C=t.sCount[d]<t.blkIndent;if(u=t.bMarks[d]+t.tShift[d],i=t.eMarks[d],u>=i)break;if(t.src.charCodeAt(u++)===62&&!C){let _=t.sCount[d]+1,E,N;t.src.charCodeAt(u)===32?(u++,_++,N=!1,E=!0):t.src.charCodeAt(u)===9?(E=!0,(t.bsCount[d]+_)%4===3?(u++,_++,N=!1):N=!0):E=!1;let $=_;for(o.push(t.bMarks[d]),t.bMarks[d]=u;u<i;){const S=t.src.charCodeAt(u);if(T(S))S===9?$+=4-($+t.bsCount[d]+(N?1:0))%4:$++;else break;u++}p=u>=i,l.push(t.bsCount[d]),t.bsCount[d]=t.sCount[d]+1+(E?1:0),a.push(t.sCount[d]),t.sCount[d]=$-_,c.push(t.tShift[d]),t.tShift[d]=u-t.bMarks[d];continue}if(p)break;let D=!1;for(let _=0,E=f.length;_<E;_++)if(f[_](t,d,n,!0)){D=!0;break}if(D){t.lineMax=d,t.blkIndent!==0&&(o.push(t.bMarks[d]),l.push(t.bsCount[d]),c.push(t.tShift[d]),a.push(t.sCount[d]),t.sCount[d]-=t.blkIndent);break}o.push(t.bMarks[d]),l.push(t.bsCount[d]),c.push(t.tShift[d]),a.push(t.sCount[d]),t.sCount[d]=-1}const m=t.blkIndent;t.blkIndent=0;const g=t.push("blockquote_open","blockquote",1);g.markup=">";const b=[e,0];g.map=b,t.md.block.tokenize(t,e,d);const y=t.push("blockquote_close","blockquote",-1);y.markup=">",t.lineMax=s,t.parentType=h,b[1]=t.line;for(let C=0;C<c.length;C++)t.bMarks[C+e]=o[C],t.tShift[C+e]=c[C],t.sCount[C+e]=a[C],t.bsCount[C+e]=l[C];return t.blkIndent=m,!0}function Zf(t,e,n,r){const u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let i=t.bMarks[e]+t.tShift[e];const s=t.src.charCodeAt(i++);if(s!==42&&s!==45&&s!==95)return!1;let o=1;for(;i<u;){const a=t.src.charCodeAt(i++);if(a!==s&&!T(a))return!1;a===s&&o++}if(o<3)return!1;if(r)return!0;t.line=e+1;const l=t.push("hr","hr",0);return l.map=[e,t.line],l.markup=Array(o+1).join(String.fromCharCode(s)),!0}function Ai(t,e){const n=t.eMarks[e];let r=t.bMarks[e]+t.tShift[e];const u=t.src.charCodeAt(r++);if(u!==42&&u!==45&&u!==43)return-1;if(r<n){const i=t.src.charCodeAt(r);if(!T(i))return-1}return r}function Mi(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];let u=n;if(u+1>=r)return-1;let i=t.src.charCodeAt(u++);if(i<48||i>57)return-1;for(;;){if(u>=r)return-1;if(i=t.src.charCodeAt(u++),i>=48&&i<=57){if(u-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return u<r&&(i=t.src.charCodeAt(u),!T(i))?-1:u}function Gf(t,e){const n=t.level+2;for(let r=e+2,u=t.tokens.length-2;r<u;r++)t.tokens[r].level===n&&t.tokens[r].type==="paragraph_open"&&(t.tokens[r+2].hidden=!0,t.tokens[r].hidden=!0,r+=2)}function Qf(t,e,n,r){let u,i,s,o,l=e,a=!0;if(t.sCount[l]-t.blkIndent>=4||t.listIndent>=0&&t.sCount[l]-t.listIndent>=4&&t.sCount[l]<t.blkIndent)return!1;let c=!1;r&&t.parentType==="paragraph"&&t.sCount[l]>=t.blkIndent&&(c=!0);let f,h,p;if((p=Mi(t,l))>=0){if(f=!0,s=t.bMarks[l]+t.tShift[l],h=Number(t.src.slice(s,p-1)),c&&h!==1)return!1}else if((p=Ai(t,l))>=0)f=!1;else return!1;if(c&&t.skipSpaces(p)>=t.eMarks[l])return!1;if(r)return!0;const d=t.src.charCodeAt(p-1),m=t.tokens.length;f?(o=t.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=t.push("bullet_list_open","ul",1);const g=[l,0];o.map=g,o.markup=String.fromCharCode(d);let b=!1;const y=t.md.block.ruler.getRules("list"),C=t.parentType;for(t.parentType="list";l<n;){i=p,u=t.eMarks[l];const D=t.sCount[l]+p-(t.bMarks[l]+t.tShift[l]);let _=D;for(;i<u;){const it=t.src.charCodeAt(i);if(it===9)_+=4-(_+t.bsCount[l])%4;else if(it===32)_++;else break;i++}const E=i;let N;E>=u?N=1:N=_-D,N>4&&(N=1);const $=D+N;o=t.push("list_item_open","li",1),o.markup=String.fromCharCode(d);const S=[l,0];o.map=S,f&&(o.info=t.src.slice(s,p-1));const G=t.tight,Ae=t.tShift[l],Hn=t.sCount[l],el=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=$,t.tight=!0,t.tShift[l]=E-t.bMarks[l],t.sCount[l]=_,E>=u&&t.isEmpty(l+1)?t.line=Math.min(t.line+2,n):t.md.block.tokenize(t,l,n,!0),(!t.tight||b)&&(a=!1),b=t.line-l>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=el,t.tShift[l]=Ae,t.sCount[l]=Hn,t.tight=G,o=t.push("list_item_close","li",-1),o.markup=String.fromCharCode(d),l=t.line,S[1]=l,l>=n||t.sCount[l]<t.blkIndent||t.sCount[l]-t.blkIndent>=4)break;let bu=!1;for(let it=0,tl=y.length;it<tl;it++)if(y[it](t,l,n,!0)){bu=!0;break}if(bu)break;if(f){if(p=Mi(t,l),p<0)break;s=t.bMarks[l]+t.tShift[l]}else if(p=Ai(t,l),p<0)break;if(d!==t.src.charCodeAt(p-1))break}return f?o=t.push("ordered_list_close","ol",-1):o=t.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(d),g[1]=l,t.line=l,t.parentType=C,a&&Gf(t,m),!0}function Yf(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e],s=e+1;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(u)!==91)return!1;function o(y){const C=t.lineMax;if(y>=C||t.isEmpty(y))return null;let D=!1;if(t.sCount[y]-t.blkIndent>3&&(D=!0),t.sCount[y]<0&&(D=!0),!D){const N=t.md.block.ruler.getRules("reference"),$=t.parentType;t.parentType="reference";let S=!1;for(let G=0,Ae=N.length;G<Ae;G++)if(N[G](t,y,C,!0)){S=!0;break}if(t.parentType=$,S)return null}const _=t.bMarks[y]+t.tShift[y],E=t.eMarks[y];return t.src.slice(_,E+1)}let l=t.src.slice(u,i+1);i=l.length;let a=-1;for(u=1;u<i;u++){const y=l.charCodeAt(u);if(y===91)return!1;if(y===93){a=u;break}else if(y===10){const C=o(s);C!==null&&(l+=C,i=l.length,s++)}else if(y===92&&(u++,u<i&&l.charCodeAt(u)===10)){const C=o(s);C!==null&&(l+=C,i=l.length,s++)}}if(a<0||l.charCodeAt(a+1)!==58)return!1;for(u=a+2;u<i;u++){const y=l.charCodeAt(u);if(y===10){const C=o(s);C!==null&&(l+=C,i=l.length,s++)}else if(!T(y))break}const c=t.md.helpers.parseLinkDestination(l,u,i);if(!c.ok)return!1;const f=t.md.normalizeLink(c.str);if(!t.md.validateLink(f))return!1;u=c.pos;const h=u,p=s,d=u;for(;u<i;u++){const y=l.charCodeAt(u);if(y===10){const C=o(s);C!==null&&(l+=C,i=l.length,s++)}else if(!T(y))break}let m=t.md.helpers.parseLinkTitle(l,u,i);for(;m.can_continue;){const y=o(s);if(y===null)break;l+=y,u=i,i=l.length,s++,m=t.md.helpers.parseLinkTitle(l,u,i,m)}let g;for(u<i&&d!==u&&m.ok?(g=m.str,u=m.pos):(g="",u=h,s=p);u<i;){const y=l.charCodeAt(u);if(!T(y))break;u++}if(u<i&&l.charCodeAt(u)!==10&&g)for(g="",u=h,s=p;u<i;){const y=l.charCodeAt(u);if(!T(y))break;u++}if(u<i&&l.charCodeAt(u)!==10)return!1;const b=qn(l.slice(1,a));return b?(r||(typeof t.env.references>"u"&&(t.env.references={}),typeof t.env.references[b]>"u"&&(t.env.references[b]={title:g,href:f}),t.line=s),!0):!1}const Xf=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],e0="[a-zA-Z_:][a-zA-Z0-9:._-]*",t0="[^\"'=<>`\\x00-\\x20]+",n0="'[^']*'",r0='"[^"]*"',u0="(?:"+t0+"|"+n0+"|"+r0+")",i0="(?:\\s+"+e0+"(?:\\s*=\\s*"+u0+")?)",bo="<[A-Za-z][A-Za-z0-9\\-]*"+i0+"*\\s*\\/?>",xo="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",s0="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",o0="<[?][\\s\\S]*?[?]>",l0="<![A-Za-z][^>]*>",a0="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",c0=new RegExp("^(?:"+bo+"|"+xo+"|"+s0+"|"+o0+"|"+l0+"|"+a0+")"),f0=new RegExp("^(?:"+bo+"|"+xo+")"),lt=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Xf.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(f0.source+"\\s*$"),/^$/,!1]];function d0(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||!t.md.options.html||t.src.charCodeAt(u)!==60)return!1;let s=t.src.slice(u,i),o=0;for(;o<lt.length&&!lt[o][0].test(s);o++);if(o===lt.length)return!1;if(r)return lt[o][2];let l=e+1;if(!lt[o][1].test(s)){for(;l<n&&!(t.sCount[l]<t.blkIndent);l++)if(u=t.bMarks[l]+t.tShift[l],i=t.eMarks[l],s=t.src.slice(u,i),lt[o][1].test(s)){s.length!==0&&l++;break}}t.line=l;const a=t.push("html_block","",0);return a.map=[e,l],a.content=t.getLines(e,l,t.blkIndent,!0),!0}function h0(t,e,n,r){let u=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.src.charCodeAt(u);if(s!==35||u>=i)return!1;let o=1;for(s=t.src.charCodeAt(++u);s===35&&u<i&&o<=6;)o++,s=t.src.charCodeAt(++u);if(o>6||u<i&&!T(s))return!1;if(r)return!0;i=t.skipSpacesBack(i,u);const l=t.skipCharsBack(i,35,u);l>u&&T(t.src.charCodeAt(l-1))&&(i=l),t.line=e+1;const a=t.push("heading_open","h"+String(o),1);a.markup="########".slice(0,o),a.map=[e,t.line];const c=t.push("inline","",0);c.content=t.src.slice(u,i).trim(),c.map=[e,t.line],c.children=[];const f=t.push("heading_close","h"+String(o),-1);return f.markup="########".slice(0,o),!0}function p0(t,e,n){const r=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;const u=t.parentType;t.parentType="paragraph";let i=0,s,o=e+1;for(;o<n&&!t.isEmpty(o);o++){if(t.sCount[o]-t.blkIndent>3)continue;if(t.sCount[o]>=t.blkIndent){let p=t.bMarks[o]+t.tShift[o];const d=t.eMarks[o];if(p<d&&(s=t.src.charCodeAt(p),(s===45||s===61)&&(p=t.skipChars(p,s),p=t.skipSpaces(p),p>=d))){i=s===61?1:2;break}}if(t.sCount[o]<0)continue;let h=!1;for(let p=0,d=r.length;p<d;p++)if(r[p](t,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=t.getLines(e,o,t.blkIndent,!1).trim();t.line=o+1;const a=t.push("heading_open","h"+String(i),1);a.markup=String.fromCharCode(s),a.map=[e,t.line];const c=t.push("inline","",0);c.content=l,c.map=[e,t.line-1],c.children=[];const f=t.push("heading_close","h"+String(i),-1);return f.markup=String.fromCharCode(s),t.parentType=u,!0}function m0(t,e,n){const r=t.md.block.ruler.getRules("paragraph"),u=t.parentType;let i=e+1;for(t.parentType="paragraph";i<n&&!t.isEmpty(i);i++){if(t.sCount[i]-t.blkIndent>3||t.sCount[i]<0)continue;let a=!1;for(let c=0,f=r.length;c<f;c++)if(r[c](t,i,n,!0)){a=!0;break}if(a)break}const s=t.getLines(e,i,t.blkIndent,!1).trim();t.line=i;const o=t.push("paragraph_open","p",1);o.map=[e,t.line];const l=t.push("inline","",0);return l.content=s,l.map=[e,t.line],l.children=[],t.push("paragraph_close","p",-1),t.parentType=u,!0}const an=[["table",Jf,["paragraph","reference"]],["code",jf],["fence",Uf,["paragraph","reference","blockquote","list"]],["blockquote",Kf,["paragraph","reference","blockquote","list"]],["hr",Zf,["paragraph","reference","blockquote","list"]],["list",Qf,["paragraph","reference","blockquote"]],["reference",Yf],["html_block",d0,["paragraph","reference","blockquote"]],["heading",h0,["paragraph","reference","blockquote"]],["lheading",p0],["paragraph",m0]];function Vn(){this.ruler=new X;for(let t=0;t<an.length;t++)this.ruler.push(an[t][0],an[t][1],{alt:(an[t][2]||[]).slice()})}Vn.prototype.tokenize=function(t,e,n){const r=this.ruler.getRules(""),u=r.length,i=t.md.options.maxNesting;let s=e,o=!1;for(;s<n&&(t.line=s=t.skipEmptyLines(s),!(s>=n||t.sCount[s]<t.blkIndent));){if(t.level>=i){t.line=n;break}const l=t.line;let a=!1;for(let c=0;c<u;c++)if(a=r[c](t,s,n,!1),a){if(l>=t.line)throw new Error("block rule didn't increment state.line");break}if(!a)throw new Error("none of the block rules matched");t.tight=!o,t.isEmpty(t.line-1)&&(o=!0),s=t.line,s<n&&t.isEmpty(s)&&(o=!0,s++,t.line=s)}};Vn.prototype.parse=function(t,e,n,r){if(!t)return;const u=new this.State(t,e,n,r);this.tokenize(u,u.line,u.lineMax)};Vn.prototype.State=Ce;function rn(t,e,n,r){this.src=t,this.env=n,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}rn.prototype.pushPending=function(){const t=new de("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t};rn.prototype.push=function(t,e,n){this.pending&&this.pushPending();const r=new de(t,e,n);let u=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],u={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(u),r};rn.prototype.scanDelims=function(t,e){const n=this.posMax,r=this.src.charCodeAt(t),u=t>0?this.src.charCodeAt(t-1):32;let i=t;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const s=i-t,o=i<n?this.src.charCodeAt(i):32,l=Kt(u)||Ut(String.fromCharCode(u)),a=Kt(o)||Ut(String.fromCharCode(o)),c=jt(u),f=jt(o),h=!f&&(!a||c||l),p=!c&&(!l||f||a);return{can_open:h&&(e||!p||l),can_close:p&&(e||!h||a),length:s}};rn.prototype.Token=de;function g0(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function b0(t,e){let n=t.pos;for(;n<t.posMax&&!g0(t.src.charCodeAt(n));)n++;return n===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}const x0=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function y0(t,e){if(!t.md.options.linkify||t.linkLevel>0)return!1;const n=t.pos,r=t.posMax;if(n+3>r||t.src.charCodeAt(n)!==58||t.src.charCodeAt(n+1)!==47||t.src.charCodeAt(n+2)!==47)return!1;const u=t.pending.match(x0);if(!u)return!1;const i=u[1],s=t.md.linkify.matchAtStart(t.src.slice(n-i.length));if(!s)return!1;let o=s.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=t.md.normalizeLink(o);if(!t.md.validateLink(l))return!1;if(!e){t.pending=t.pending.slice(0,-i.length);const a=t.push("link_open","a",1);a.attrs=[["href",l]],a.markup="linkify",a.info="auto";const c=t.push("text","",0);c.content=t.md.normalizeLinkText(o);const f=t.push("link_close","a",-1);f.markup="linkify",f.info="auto"}return t.pos+=o.length-i.length,!0}function k0(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==10)return!1;const r=t.pending.length-1,u=t.posMax;if(!e)if(r>=0&&t.pending.charCodeAt(r)===32)if(r>=1&&t.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&t.pending.charCodeAt(i-1)===32;)i--;t.pending=t.pending.slice(0,i),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(n++;n<u&&T(t.src.charCodeAt(n));)n++;return t.pos=n,!0}const du=[];for(let t=0;t<256;t++)du.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){du[t.charCodeAt(0)]=1});function C0(t,e){let n=t.pos;const r=t.posMax;if(t.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let u=t.src.charCodeAt(n);if(u===10){for(e||t.push("hardbreak","br",0),n++;n<r&&(u=t.src.charCodeAt(n),!!T(u));)n++;return t.pos=n,!0}let i=t.src[n];if(u>=55296&&u<=56319&&n+1<r){const o=t.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=t.src[n+1],n++)}const s="\\"+i;if(!e){const o=t.push("text_special","",0);u<256&&du[u]!==0?o.content=i:o.content=s,o.markup=s,o.info="escape"}return t.pos=n+1,!0}function D0(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==96)return!1;const u=n;n++;const i=t.posMax;for(;n<i&&t.src.charCodeAt(n)===96;)n++;const s=t.src.slice(u,n),o=s.length;if(t.backticksScanned&&(t.backticks[o]||0)<=u)return e||(t.pending+=s),t.pos+=o,!0;let l=n,a;for(;(a=t.src.indexOf("`",l))!==-1;){for(l=a+1;l<i&&t.src.charCodeAt(l)===96;)l++;const c=l-a;if(c===o){if(!e){const f=t.push("code_inline","code",0);f.markup=s,f.content=t.src.slice(n,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=l,!0}t.backticks[c]=a}return t.backticksScanned=!0,e||(t.pending+=s),t.pos+=o,!0}function w0(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e||r!==126)return!1;const u=t.scanDelims(t.pos,!0);let i=u.length;const s=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=t.push("text","",0),o.content=s,i--);for(let l=0;l<i;l+=2)o=t.push("text","",0),o.content=s+s,t.delimiters.push({marker:r,length:0,token:t.tokens.length-1,end:-1,open:u.can_open,close:u.can_close});return t.pos+=u.length,!0}function Oi(t,e){let n;const r=[],u=e.length;for(let i=0;i<u;i++){const s=e[i];if(s.marker!==126||s.end===-1)continue;const o=e[s.end];n=t.tokens[s.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=t.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",t.tokens[o.token-1].type==="text"&&t.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let s=i+1;for(;s<t.tokens.length&&t.tokens[s].type==="s_close";)s++;s--,i!==s&&(n=t.tokens[s],t.tokens[s]=t.tokens[i],t.tokens[i]=n)}}function _0(t){const e=t.tokens_meta,n=t.tokens_meta.length;Oi(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Oi(t,e[r].delimiters)}const yo={tokenize:w0,postProcess:_0};function E0(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e||r!==95&&r!==42)return!1;const u=t.scanDelims(t.pos,r===42);for(let i=0;i<u.length;i++){const s=t.push("text","",0);s.content=String.fromCharCode(r),t.delimiters.push({marker:r,length:u.length,token:t.tokens.length-1,end:-1,open:u.can_open,close:u.can_close})}return t.pos+=u.length,!0}function Ti(t,e){const n=e.length;for(let r=n-1;r>=0;r--){const u=e[r];if(u.marker!==95&&u.marker!==42||u.end===-1)continue;const i=e[u.end],s=r>0&&e[r-1].end===u.end+1&&e[r-1].marker===u.marker&&e[r-1].token===u.token-1&&e[u.end+1].token===i.token+1,o=String.fromCharCode(u.marker),l=t.tokens[u.token];l.type=s?"strong_open":"em_open",l.tag=s?"strong":"em",l.nesting=1,l.markup=s?o+o:o,l.content="";const a=t.tokens[i.token];a.type=s?"strong_close":"em_close",a.tag=s?"strong":"em",a.nesting=-1,a.markup=s?o+o:o,a.content="",s&&(t.tokens[e[r-1].token].content="",t.tokens[e[u.end+1].token].content="",r--)}}function S0(t){const e=t.tokens_meta,n=t.tokens_meta.length;Ti(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Ti(t,e[r].delimiters)}const ko={tokenize:E0,postProcess:S0};function A0(t,e){let n,r,u,i,s="",o="",l=t.pos,a=!0;if(t.src.charCodeAt(t.pos)!==91)return!1;const c=t.pos,f=t.posMax,h=t.pos+1,p=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(p<0)return!1;let d=p+1;if(d<f&&t.src.charCodeAt(d)===40){for(a=!1,d++;d<f&&(n=t.src.charCodeAt(d),!(!T(n)&&n!==10));d++);if(d>=f)return!1;if(l=d,u=t.md.helpers.parseLinkDestination(t.src,d,t.posMax),u.ok){for(s=t.md.normalizeLink(u.str),t.md.validateLink(s)?d=u.pos:s="",l=d;d<f&&(n=t.src.charCodeAt(d),!(!T(n)&&n!==10));d++);if(u=t.md.helpers.parseLinkTitle(t.src,d,t.posMax),d<f&&l!==d&&u.ok)for(o=u.str,d=u.pos;d<f&&(n=t.src.charCodeAt(d),!(!T(n)&&n!==10));d++);}(d>=f||t.src.charCodeAt(d)!==41)&&(a=!0),d++}if(a){if(typeof t.env.references>"u")return!1;if(d<f&&t.src.charCodeAt(d)===91?(l=d+1,d=t.md.helpers.parseLinkLabel(t,d),d>=0?r=t.src.slice(l,d++):d=p+1):d=p+1,r||(r=t.src.slice(h,p)),i=t.env.references[qn(r)],!i)return t.pos=c,!1;s=i.href,o=i.title}if(!e){t.pos=h,t.posMax=p;const m=t.push("link_open","a",1),g=[["href",s]];m.attrs=g,o&&g.push(["title",o]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=d,t.posMax=f,!0}function M0(t,e){let n,r,u,i,s,o,l,a,c="";const f=t.pos,h=t.posMax;if(t.src.charCodeAt(t.pos)!==33||t.src.charCodeAt(t.pos+1)!==91)return!1;const p=t.pos+2,d=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(d<0)return!1;if(i=d+1,i<h&&t.src.charCodeAt(i)===40){for(i++;i<h&&(n=t.src.charCodeAt(i),!(!T(n)&&n!==10));i++);if(i>=h)return!1;for(a=i,o=t.md.helpers.parseLinkDestination(t.src,i,t.posMax),o.ok&&(c=t.md.normalizeLink(o.str),t.md.validateLink(c)?i=o.pos:c=""),a=i;i<h&&(n=t.src.charCodeAt(i),!(!T(n)&&n!==10));i++);if(o=t.md.helpers.parseLinkTitle(t.src,i,t.posMax),i<h&&a!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=t.src.charCodeAt(i),!(!T(n)&&n!==10));i++);else l="";if(i>=h||t.src.charCodeAt(i)!==41)return t.pos=f,!1;i++}else{if(typeof t.env.references>"u")return!1;if(i<h&&t.src.charCodeAt(i)===91?(a=i+1,i=t.md.helpers.parseLinkLabel(t,i),i>=0?u=t.src.slice(a,i++):i=d+1):i=d+1,u||(u=t.src.slice(p,d)),s=t.env.references[qn(u)],!s)return t.pos=f,!1;c=s.href,l=s.title}if(!e){r=t.src.slice(p,d);const m=[];t.md.inline.parse(r,t.md,t.env,m);const g=t.push("image","img",0),b=[["src",c],["alt",""]];g.attrs=b,g.children=m,g.content=r,l&&b.push(["title",l])}return t.pos=i,t.posMax=h,!0}const O0=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,T0=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function F0(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==60)return!1;const r=t.pos,u=t.posMax;for(;;){if(++n>=u)return!1;const s=t.src.charCodeAt(n);if(s===60)return!1;if(s===62)break}const i=t.src.slice(r+1,n);if(T0.test(i)){const s=t.md.normalizeLink(i);if(!t.md.validateLink(s))return!1;if(!e){const o=t.push("link_open","a",1);o.attrs=[["href",s]],o.markup="autolink",o.info="auto";const l=t.push("text","",0);l.content=t.md.normalizeLinkText(i);const a=t.push("link_close","a",-1);a.markup="autolink",a.info="auto"}return t.pos+=i.length+2,!0}if(O0.test(i)){const s=t.md.normalizeLink("mailto:"+i);if(!t.md.validateLink(s))return!1;if(!e){const o=t.push("link_open","a",1);o.attrs=[["href",s]],o.markup="autolink",o.info="auto";const l=t.push("text","",0);l.content=t.md.normalizeLinkText(i);const a=t.push("link_close","a",-1);a.markup="autolink",a.info="auto"}return t.pos+=i.length+2,!0}return!1}function N0(t){return/^<a[>\s]/i.test(t)}function v0(t){return/^<\/a\s*>/i.test(t)}function I0(t){const e=t|32;return e>=97&&e<=122}function R0(t,e){if(!t.md.options.html)return!1;const n=t.posMax,r=t.pos;if(t.src.charCodeAt(r)!==60||r+2>=n)return!1;const u=t.src.charCodeAt(r+1);if(u!==33&&u!==63&&u!==47&&!I0(u))return!1;const i=t.src.slice(r).match(c0);if(!i)return!1;if(!e){const s=t.push("html_inline","",0);s.content=i[0],N0(s.content)&&t.linkLevel++,v0(s.content)&&t.linkLevel--}return t.pos+=i[0].length,!0}const B0=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,z0=/^&([a-z][a-z0-9]{1,31});/i;function P0(t,e){const n=t.pos,r=t.posMax;if(t.src.charCodeAt(n)!==38||n+1>=r)return!1;if(t.src.charCodeAt(n+1)===35){const i=t.src.slice(n).match(B0);if(i){if(!e){const s=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=t.push("text_special","",0);o.content=cu(s)?On(s):On(65533),o.markup=i[0],o.info="entity"}return t.pos+=i[0].length,!0}}else{const i=t.src.slice(n).match(z0);if(i){const s=fo(i[0]);if(s!==i[0]){if(!e){const o=t.push("text_special","",0);o.content=s,o.markup=i[0],o.info="entity"}return t.pos+=i[0].length,!0}}}return!1}function Fi(t){const e={},n=t.length;if(!n)return;let r=0,u=-2;const i=[];for(let s=0;s<n;s++){const o=t[s];if(i.push(0),(t[r].marker!==o.marker||u!==o.token-1)&&(r=s),u=o.token,o.length=o.length||0,!o.close)continue;e.hasOwnProperty(o.marker)||(e[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=e[o.marker][(o.open?3:0)+o.length%3];let a=r-i[r]-1,c=a;for(;a>l;a-=i[a]+1){const f=t[a];if(f.marker===o.marker&&f.open&&f.end<0){let h=!1;if((f.close||o.open)&&(f.length+o.length)%3===0&&(f.length%3!==0||o.length%3!==0)&&(h=!0),!h){const p=a>0&&!t[a-1].open?i[a-1]+1:0;i[s]=s-a+p,i[a]=p,o.open=!1,f.end=s,f.close=!1,c=-1,u=-2;break}}}c!==-1&&(e[o.marker][(o.open?3:0)+(o.length||0)%3]=c)}}function L0(t){const e=t.tokens_meta,n=t.tokens_meta.length;Fi(t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Fi(e[r].delimiters)}function q0(t){let e,n,r=0;const u=t.tokens,i=t.tokens.length;for(e=n=0;e<i;e++)u[e].nesting<0&&r--,u[e].level=r,u[e].nesting>0&&r++,u[e].type==="text"&&e+1<i&&u[e+1].type==="text"?u[e+1].content=u[e].content+u[e+1].content:(e!==n&&(u[n]=u[e]),n++);e!==n&&(u.length=n)}const or=[["text",b0],["linkify",y0],["newline",k0],["escape",C0],["backticks",D0],["strikethrough",yo.tokenize],["emphasis",ko.tokenize],["link",A0],["image",M0],["autolink",F0],["html_inline",R0],["entity",P0]],lr=[["balance_pairs",L0],["strikethrough",yo.postProcess],["emphasis",ko.postProcess],["fragments_join",q0]];function un(){this.ruler=new X;for(let t=0;t<or.length;t++)this.ruler.push(or[t][0],or[t][1]);this.ruler2=new X;for(let t=0;t<lr.length;t++)this.ruler2.push(lr[t][0],lr[t][1])}un.prototype.skipToken=function(t){const e=t.pos,n=this.ruler.getRules(""),r=n.length,u=t.md.options.maxNesting,i=t.cache;if(typeof i[e]<"u"){t.pos=i[e];return}let s=!1;if(t.level<u){for(let o=0;o<r;o++)if(t.level++,s=n[o](t,!0),t.level--,s){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;s||t.pos++,i[e]=t.pos};un.prototype.tokenize=function(t){const e=this.ruler.getRules(""),n=e.length,r=t.posMax,u=t.md.options.maxNesting;for(;t.pos<r;){const i=t.pos;let s=!1;if(t.level<u){for(let o=0;o<n;o++)if(s=e[o](t,!1),s){if(i>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}if(s){if(t.pos>=r)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};un.prototype.parse=function(t,e,n,r){const u=new this.State(t,e,n,r);this.tokenize(u);const i=this.ruler2.getRules(""),s=i.length;for(let o=0;o<s;o++)i[o](u)};un.prototype.State=rn;function V0(t){const e={};t=t||{},e.src_Any=so.source,e.src_Cc=oo.source,e.src_Z=ao.source,e.src_P=lu.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const n="[><]";return e.src_pseudo_letter="(?:(?!"+n+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+n+"|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function Br(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){t[r]=n[r]})}),t}function $n(t){return Object.prototype.toString.call(t)}function $0(t){return $n(t)==="[object String]"}function W0(t){return $n(t)==="[object Object]"}function H0(t){return $n(t)==="[object RegExp]"}function Ni(t){return $n(t)==="[object Function]"}function J0(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const Co={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function j0(t){return Object.keys(t||{}).reduce(function(e,n){return e||Co.hasOwnProperty(n)},!1)}const U0={"http:":{validate:function(t,e,n){const r=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){const r=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?e>=3&&t[e-3]===":"||e>=3&&t[e-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){const r=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},K0="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Z0="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function G0(t){t.__index__=-1,t.__text_cache__=""}function Q0(t){return function(e,n){const r=e.slice(n);return t.test(r)?r.match(t)[0].length:0}}function vi(){return function(t,e){e.normalize(t)}}function Tn(t){const e=t.re=V0(t.__opts__),n=t.__tlds__.slice();t.onCompile(),t.__tlds_replaced__||n.push(K0),n.push(e.src_xn),e.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const u=[];t.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(t.__schemas__).forEach(function(o){const l=t.__schemas__[o];if(l===null)return;const a={validate:null,link:null};if(t.__compiled__[o]=a,W0(l)){H0(l.validate)?a.validate=Q0(l.validate):Ni(l.validate)?a.validate=l.validate:i(o,l),Ni(l.normalize)?a.normalize=l.normalize:l.normalize?i(o,l):a.normalize=vi();return}if($0(l)){u.push(o);return}i(o,l)}),u.forEach(function(o){t.__compiled__[t.__schemas__[o]]&&(t.__compiled__[o].validate=t.__compiled__[t.__schemas__[o]].validate,t.__compiled__[o].normalize=t.__compiled__[t.__schemas__[o]].normalize)}),t.__compiled__[""]={validate:null,normalize:vi()};const s=Object.keys(t.__compiled__).filter(function(o){return o.length>0&&t.__compiled__[o]}).map(J0).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),G0(t)}function Y0(t,e){const n=t.__index__,r=t.__last_index__,u=t.__text_cache__.slice(n,r);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=r+e,this.raw=u,this.text=u,this.url=u}function zr(t,e){const n=new Y0(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function re(t,e){if(!(this instanceof re))return new re(t,e);e||j0(t)&&(e=t,t={}),this.__opts__=Br({},Co,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Br({},U0,t),this.__compiled__={},this.__tlds__=Z0,this.__tlds_replaced__=!1,this.re={},Tn(this)}re.prototype.add=function(e,n){return this.__schemas__[e]=n,Tn(this),this};re.prototype.set=function(e){return this.__opts__=Br(this.__opts__,e),this};re.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let n,r,u,i,s,o,l,a,c;if(this.re.schema_test.test(e)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(e))!==null;)if(i=this.testSchemaAt(e,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(a=e.search(this.re.host_fuzzy_test),a>=0&&(this.__index__<0||a<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(s=r.index+r[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&(u=e.match(this.re.email_fuzzy))!==null&&(s=u.index+u[1].length,o=u.index+u[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=o))),this.__index__>=0};re.prototype.pretest=function(e){return this.re.pretest.test(e)};re.prototype.testSchemaAt=function(e,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(e,r,this):0};re.prototype.match=function(e){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===e&&(n.push(zr(this,r)),r=this.__last_index__);let u=r?e.slice(r):e;for(;this.test(u);)n.push(zr(this,r)),u=u.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};re.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const n=this.re.schema_at_start.exec(e);if(!n)return null;const r=this.testSchemaAt(e,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,zr(this,0)):null};re.prototype.tlds=function(e,n){return e=Array.isArray(e)?e:[e],n?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,u,i){return r!==i[u-1]}).reverse(),Tn(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,Tn(this),this)};re.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};re.prototype.onCompile=function(){};const mt=2147483647,ge=36,hu=1,Zt=26,X0=38,ed=700,Do=72,wo=128,_o="-",td=/^xn--/,nd=/[^\0-\x7F]/,rd=/[\x2E\u3002\uFF0E\uFF61]/g,ud={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ar=ge-hu,be=Math.floor,cr=String.fromCharCode;function Te(t){throw new RangeError(ud[t])}function id(t,e){const n=[];let r=t.length;for(;r--;)n[r]=e(t[r]);return n}function Eo(t,e){const n=t.split("@");let r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(rd,".");const u=t.split("."),i=id(u,e).join(".");return r+i}function So(t){const e=[];let n=0;const r=t.length;for(;n<r;){const u=t.charCodeAt(n++);if(u>=55296&&u<=56319&&n<r){const i=t.charCodeAt(n++);(i&64512)==56320?e.push(((u&1023)<<10)+(i&1023)+65536):(e.push(u),n--)}else e.push(u)}return e}const sd=t=>String.fromCodePoint(...t),od=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:ge},Ii=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},Ao=function(t,e,n){let r=0;for(t=n?be(t/ed):t>>1,t+=be(t/e);t>ar*Zt>>1;r+=ge)t=be(t/ar);return be(r+(ar+1)*t/(t+X0))},Mo=function(t){const e=[],n=t.length;let r=0,u=wo,i=Do,s=t.lastIndexOf(_o);s<0&&(s=0);for(let o=0;o<s;++o)t.charCodeAt(o)>=128&&Te("not-basic"),e.push(t.charCodeAt(o));for(let o=s>0?s+1:0;o<n;){const l=r;for(let c=1,f=ge;;f+=ge){o>=n&&Te("invalid-input");const h=od(t.charCodeAt(o++));h>=ge&&Te("invalid-input"),h>be((mt-r)/c)&&Te("overflow"),r+=h*c;const p=f<=i?hu:f>=i+Zt?Zt:f-i;if(h<p)break;const d=ge-p;c>be(mt/d)&&Te("overflow"),c*=d}const a=e.length+1;i=Ao(r-l,a,l==0),be(r/a)>mt-u&&Te("overflow"),u+=be(r/a),r%=a,e.splice(r++,0,u)}return String.fromCodePoint(...e)},Oo=function(t){const e=[];t=So(t);const n=t.length;let r=wo,u=0,i=Do;for(const l of t)l<128&&e.push(cr(l));const s=e.length;let o=s;for(s&&e.push(_o);o<n;){let l=mt;for(const c of t)c>=r&&c<l&&(l=c);const a=o+1;l-r>be((mt-u)/a)&&Te("overflow"),u+=(l-r)*a,r=l;for(const c of t)if(c<r&&++u>mt&&Te("overflow"),c===r){let f=u;for(let h=ge;;h+=ge){const p=h<=i?hu:h>=i+Zt?Zt:h-i;if(f<p)break;const d=f-p,m=ge-p;e.push(cr(Ii(p+d%m,0))),f=be(d/m)}e.push(cr(Ii(f,0))),i=Ao(u,a,o===s),u=0,++o}++u,++r}return e.join("")},ld=function(t){return Eo(t,function(e){return td.test(e)?Mo(e.slice(4).toLowerCase()):e})},ad=function(t){return Eo(t,function(e){return nd.test(e)?"xn--"+Oo(e):e})},To={version:"2.3.1",ucs2:{decode:So,encode:sd},decode:Mo,encode:Oo,toASCII:ad,toUnicode:ld},cd={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},fd={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},dd={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},hd={default:cd,zero:fd,commonmark:dd},pd=/^(vbscript|javascript|file|data):/,md=/^data:image\/(gif|png|jpeg|webp);/;function gd(t){const e=t.trim().toLowerCase();return pd.test(e)?md.test(e):!0}const Fo=["http:","https:","mailto:"];function bd(t){const e=ou(t,!0);if(e.hostname&&(!e.protocol||Fo.indexOf(e.protocol)>=0))try{e.hostname=To.toASCII(e.hostname)}catch{}return nn(su(e))}function xd(t){const e=ou(t,!0);if(e.hostname&&(!e.protocol||Fo.indexOf(e.protocol)>=0))try{e.hostname=To.toUnicode(e.hostname)}catch{}return kt(su(e),kt.defaultChars+"%")}function ae(t,e){if(!(this instanceof ae))return new ae(t,e);e||au(t)||(e=t||{},t="default"),this.inline=new un,this.block=new Vn,this.core=new fu,this.renderer=new Et,this.linkify=new re,this.validateLink=gd,this.normalizeLink=bd,this.normalizeLinkText=xd,this.utils=kf,this.helpers=Ln({},_f),this.options={},this.configure(t),e&&this.set(e)}ae.prototype.set=function(t){return Ln(this.options,t),this};ae.prototype.configure=function(t){const e=this;if(au(t)){const n=t;if(t=hd[n],!t)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enableOnly(t.components[n].rules),t.components[n].rules2&&e[n].ruler2.enableOnly(t.components[n].rules2)}),this};ae.prototype.enable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(u){n=n.concat(this[u].ruler.enable(t,!0))},this),n=n.concat(this.inline.ruler2.enable(t,!0));const r=t.filter(function(u){return n.indexOf(u)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};ae.prototype.disable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(u){n=n.concat(this[u].ruler.disable(t,!0))},this),n=n.concat(this.inline.ruler2.disable(t,!0));const r=t.filter(function(u){return n.indexOf(u)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};ae.prototype.use=function(t){const e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this};ae.prototype.parse=function(t,e){if(typeof t!="string")throw new Error("Input data should be a String");const n=new this.core.State(t,this,e);return this.core.process(n),n.tokens};ae.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};ae.prototype.parseInline=function(t,e){const n=new this.core.State(t,this,e);return n.inlineMode=!0,this.core.process(n),n.tokens};ae.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};const No=new xl({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(t){return["h"+t.attrs.level,0]}},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:t=>({params:t.getAttribute("data-params")||""})}],toDOM(t){return["pre",t.attrs.params?{"data-params":t.attrs.params}:{},["code",0]]}},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs(t){return{order:t.hasAttribute("start")?+t.getAttribute("start"):1,tight:t.hasAttribute("data-tight")}}}],toDOM(t){return["ol",{start:t.attrs.order==1?null:t.attrs.order,"data-tight":t.attrs.tight?"true":null},0]}},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:t=>({tight:t.hasAttribute("data-tight")})}],toDOM(t){return["ul",{"data-tight":t.attrs.tight?"true":null},0]}},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM(){return["li",0]}},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs(t){return{src:t.getAttribute("src"),title:t.getAttribute("title"),alt:t.getAttribute("alt")}}}],toDOM(t){return["img",t.attrs]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return["br"]}}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:t=>t.type.name=="em"}],toDOM(){return["em"]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name=="strong"},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],toDOM(){return["strong"]}},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(t){return{href:t.getAttribute("href"),title:t.getAttribute("title")}}}],toDOM(t){return["a",t.attrs]}},code:{code:!0,parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}});function yd(t,e){if(t.isText&&e.isText&&M.sameSet(t.marks,e.marks))return t.withText(t.text+e.text)}class kd{constructor(e,n){this.schema=e,this.tokenHandlers=n,this.stack=[{type:e.topNodeType,attrs:null,content:[],marks:M.none}]}top(){return this.stack[this.stack.length-1]}push(e){this.stack.length&&this.top().content.push(e)}addText(e){if(!e)return;let n=this.top(),r=n.content,u=r[r.length-1],i=this.schema.text(e,n.marks),s;u&&(s=yd(u,i))?r[r.length-1]=s:r.push(i)}openMark(e){let n=this.top();n.marks=e.addToSet(n.marks)}closeMark(e){let n=this.top();n.marks=e.removeFromSet(n.marks)}parseTokens(e){for(let n=0;n<e.length;n++){let r=e[n],u=this.tokenHandlers[r.type];if(!u)throw new Error("Token type `"+r.type+"` not supported by Markdown parser");u(this,r,e,n)}}addNode(e,n,r){let u=this.top(),i=e.createAndFill(n,r,u?u.marks:[]);return i?(this.push(i),i):null}openNode(e,n){this.stack.push({type:e,attrs:n,content:[],marks:M.none})}closeNode(){let e=this.stack.pop();return this.addNode(e.type,e.attrs,e.content)}}function At(t,e,n,r){return t.getAttrs?t.getAttrs(e,n,r):t.attrs instanceof Function?t.attrs(e):t.attrs}function fr(t,e){return t.noCloseToken||e=="code_inline"||e=="code_block"||e=="fence"}function Ri(t){return t[t.length-1]==`
`?t.slice(0,t.length-1):t}function dr(){}function Cd(t,e){let n=Object.create(null);for(let r in e){let u=e[r];if(u.block){let i=t.nodeType(u.block);fr(u,r)?n[r]=(s,o,l,a)=>{s.openNode(i,At(u,o,l,a)),s.addText(Ri(o.content)),s.closeNode()}:(n[r+"_open"]=(s,o,l,a)=>s.openNode(i,At(u,o,l,a)),n[r+"_close"]=s=>s.closeNode())}else if(u.node){let i=t.nodeType(u.node);n[r]=(s,o,l,a)=>s.addNode(i,At(u,o,l,a))}else if(u.mark){let i=t.marks[u.mark];fr(u,r)?n[r]=(s,o,l,a)=>{s.openMark(i.create(At(u,o,l,a))),s.addText(Ri(o.content)),s.closeMark(i)}:(n[r+"_open"]=(s,o,l,a)=>s.openMark(i.create(At(u,o,l,a))),n[r+"_close"]=s=>s.closeMark(i))}else if(u.ignore)fr(u,r)?n[r]=dr:(n[r+"_open"]=dr,n[r+"_close"]=dr);else throw new RangeError("Unrecognized parsing spec "+JSON.stringify(u))}return n.text=(r,u)=>r.addText(u.content),n.inline=(r,u)=>r.parseTokens(u.children),n.softbreak=n.softbreak||(r=>r.addText(" ")),n}class Dd{constructor(e,n,r){this.schema=e,this.tokenizer=n,this.tokens=r,this.tokenHandlers=Cd(e,r)}parse(e,n={}){let r=new kd(this.schema,this.tokenHandlers),u;r.parseTokens(this.tokenizer.parse(e,n));do u=r.closeNode();while(r.stack.length);return u||this.schema.topNodeType.createAndFill()}}function Bi(t,e){for(;++e<t.length;)if(t[e].type!="list_item_open")return t[e].hidden;return!1}const wd=new Dd(No,ae("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:(t,e,n)=>({tight:Bi(e,n)})},ordered_list:{block:"ordered_list",getAttrs:(t,e,n)=>({order:+t.attrGet("start")||1,tight:Bi(e,n)})},heading:{block:"heading",getAttrs:t=>({level:+t.tag.slice(1)})},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:t=>({params:t.info||""}),noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:t=>({src:t.attrGet("src"),title:t.attrGet("title")||null,alt:t.children[0]&&t.children[0].content||null})},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:t=>({href:t.attrGet("href"),title:t.attrGet("title")||null})},code_inline:{mark:"code",noCloseToken:!0}}),_d={open:"",close:"",mixable:!0};class Ed{constructor(e,n,r={}){this.nodes=e,this.marks=n,this.options=r}serialize(e,n={}){n=Object.assign({},this.options,n);let r=new Md(this.nodes,this.marks,n);return r.renderContent(e),r.out}}const Sd=new Ed({blockquote(t,e){t.wrapBlock("> ",null,e,()=>t.renderContent(e))},code_block(t,e){const n=e.textContent.match(/`{3,}/gm),r=n?n.sort().slice(-1)[0]+"`":"```";t.write(r+(e.attrs.params||"")+`
`),t.text(e.textContent,!1),t.write(`
`),t.write(r),t.closeBlock(e)},heading(t,e){t.write(t.repeat("#",e.attrs.level)+" "),t.renderInline(e,!1),t.closeBlock(e)},horizontal_rule(t,e){t.write(e.attrs.markup||"---"),t.closeBlock(e)},bullet_list(t,e){t.renderList(e,"  ",()=>(e.attrs.bullet||"*")+" ")},ordered_list(t,e){let n=e.attrs.order||1,r=String(n+e.childCount-1).length,u=t.repeat(" ",r+2);t.renderList(e,u,i=>{let s=String(n+i);return t.repeat(" ",r-s.length)+s+". "})},list_item(t,e){t.renderContent(e)},paragraph(t,e){t.renderInline(e),t.closeBlock(e)},image(t,e){t.write("!["+t.esc(e.attrs.alt||"")+"]("+e.attrs.src.replace(/[\(\)]/g,"\\$&")+(e.attrs.title?' "'+e.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break(t,e,n,r){for(let u=r+1;u<n.childCount;u++)if(n.child(u).type!=e.type){t.write(`\\
`);return}},text(t,e){t.text(e.text,!t.inAutolink)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open(t,e,n,r){return t.inAutolink=Ad(e,n,r),t.inAutolink?"<":"["},close(t,e,n,r){let{inAutolink:u}=t;return t.inAutolink=void 0,u?">":"]("+e.attrs.href.replace(/[\(\)"]/g,"\\$&")+(e.attrs.title?` "${e.attrs.title.replace(/"/g,'\\"')}"`:"")+")"},mixable:!0},code:{open(t,e,n,r){return zi(n.child(r),-1)},close(t,e,n,r){return zi(n.child(r-1),1)},escape:!1}});function zi(t,e){let n=/`+/g,r,u=0;if(t.isText)for(;r=n.exec(t.text);)u=Math.max(u,r[0].length);let i=u>0&&e>0?" `":"`";for(let s=0;s<u;s++)i+="`";return u>0&&e<0&&(i+=" "),i}function Ad(t,e,n){if(t.attrs.title||!/^\w+:/.test(t.attrs.href))return!1;let r=e.child(n);return!r.isText||r.text!=t.attrs.href||r.marks[r.marks.length-1]!=t?!1:n==e.childCount-1||!t.isInSet(e.child(n+1).marks)}class Md{constructor(e,n,r){this.nodes=e,this.marks=n,this.options=r,this.delim="",this.out="",this.closed=null,this.inAutolink=void 0,this.atBlockStart=!1,this.inTightList=!1,typeof this.options.tightLists>"u"&&(this.options.tightLists=!1),typeof this.options.hardBreakNodeName>"u"&&(this.options.hardBreakNodeName="hard_break")}flushClose(e=2){if(this.closed){if(this.atBlank()||(this.out+=`
`),e>1){let n=this.delim,r=/\s+$/.exec(n);r&&(n=n.slice(0,n.length-r[0].length));for(let u=1;u<e;u++)this.out+=n+`
`}this.closed=null}}getMark(e){let n=this.marks[e];if(!n){if(this.options.strict!==!1)throw new Error(`Mark type \`${e}\` not supported by Markdown renderer`);n=_d}return n}wrapBlock(e,n,r,u){let i=this.delim;this.write(n??e),this.delim+=e,u(),this.delim=i,this.closeBlock(r)}atBlank(){return/(^|\n)$/.test(this.out)}ensureNewLine(){this.atBlank()||(this.out+=`
`)}write(e){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),e&&(this.out+=e)}closeBlock(e){this.closed=e}text(e,n=!0){let r=e.split(`
`);for(let u=0;u<r.length;u++)this.write(),!n&&r[u][0]=="["&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=n?this.esc(r[u],this.atBlockStart):r[u],u!=r.length-1&&(this.out+=`
`)}render(e,n,r){if(this.nodes[e.type.name])this.nodes[e.type.name](this,e,n,r);else{if(this.options.strict!==!1)throw new Error("Token type `"+e.type.name+"` not supported by Markdown renderer");e.type.isLeaf||(e.type.inlineContent?this.renderInline(e):this.renderContent(e),e.isBlock&&this.closeBlock(e))}}renderContent(e){e.forEach((n,r,u)=>this.render(n,e,u))}renderInline(e,n=!0){this.atBlockStart=n;let r=[],u="",i=(s,o,l)=>{let a=s?s.marks:[];s&&s.type.name===this.options.hardBreakNodeName&&(a=a.filter(m=>{if(l+1==e.childCount)return!1;let g=e.child(l+1);return m.isInSet(g.marks)&&(!g.isText||/\S/.test(g.text))}));let c=u;if(u="",s&&s.isText&&a.some(m=>{let g=this.getMark(m.type.name);return g&&g.expelEnclosingWhitespace&&!m.isInSet(r)})){let[m,g,b]=/^(\s*)(.*)$/m.exec(s.text);g&&(c+=g,s=b?s.withText(b):null,s||(a=r))}if(s&&s.isText&&a.some(m=>{let g=this.getMark(m.type.name);return g&&g.expelEnclosingWhitespace&&(l==e.childCount-1||!m.isInSet(e.child(l+1).marks))})){let[m,g,b]=/^(.*?)(\s*)$/m.exec(s.text);b&&(u=b,s=g?s.withText(g):null,s||(a=r))}let f=a.length?a[a.length-1]:null,h=f&&this.getMark(f.type.name).escape===!1,p=a.length-(h?1:0);e:for(let m=0;m<p;m++){let g=a[m];if(!this.getMark(g.type.name).mixable)break;for(let b=0;b<r.length;b++){let y=r[b];if(!this.getMark(y.type.name).mixable)break;if(g.eq(y)){m>b?a=a.slice(0,b).concat(g).concat(a.slice(b,m)).concat(a.slice(m+1,p)):b>m&&(a=a.slice(0,m).concat(a.slice(m+1,b)).concat(g).concat(a.slice(b,p)));continue e}}}let d=0;for(;d<Math.min(r.length,p)&&a[d].eq(r[d]);)++d;for(;d<r.length;)this.text(this.markString(r.pop(),!1,e,l),!1);if(c&&this.text(c),s){for(;r.length<p;){let m=a[r.length];r.push(m),this.text(this.markString(m,!0,e,l),!1),this.atBlockStart=!1}h&&s.isText?this.text(this.markString(f,!0,e,l)+s.text+this.markString(f,!1,e,l+1),!1):this.render(s,e,l),this.atBlockStart=!1}s?.isText&&s.nodeSize>0&&(this.atBlockStart=!1)};e.forEach(i),i(null,0,e.childCount),this.atBlockStart=!1}renderList(e,n,r){this.closed&&this.closed.type==e.type?this.flushClose(3):this.inTightList&&this.flushClose(1);let u=typeof e.attrs.tight<"u"?e.attrs.tight:this.options.tightLists,i=this.inTightList;this.inTightList=u,e.forEach((s,o,l)=>{l&&u&&this.flushClose(1),this.wrapBlock(n,r(l),e,()=>this.render(s,e,l))}),this.inTightList=i}esc(e,n=!1){return e=e.replace(/[`*\\~\[\]_]/g,(r,u)=>r=="_"&&u>0&&u+1<e.length&&e[u-1].match(/\w/)&&e[u+1].match(/\w/)?r:"\\"+r),n&&(e=e.replace(/^(\+[ ]|[\-*>])/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(e=e.replace(this.options.escapeExtraCharacters,"\\$&")),e}quote(e){let n=e.indexOf('"')==-1?'""':e.indexOf("'")==-1?"''":"()";return n[0]+e+n[1]}repeat(e,n){let r="";for(let u=0;u<n;u++)r+=e;return r}markString(e,n,r,u){let i=this.getMark(e.type.name),s=n?i.open:i.close;return typeof s=="string"?s:s(this,e,r,u)}getEnclosingWhitespace(e){return{leading:(e.match(/^(\s+)/)||[void 0])[0],trailing:(e.match(/(\s+)$/)||[void 0])[0]}}}var We={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Fn={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Od=typeof navigator<"u"&&/Mac/.test(navigator.platform),Td=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var q=0;q<10;q++)We[48+q]=We[96+q]=String(q);for(var q=1;q<=24;q++)We[q+111]="F"+q;for(var q=65;q<=90;q++)We[q]=String.fromCharCode(q+32),Fn[q]=String.fromCharCode(q);for(var hr in We)Fn.hasOwnProperty(hr)||(Fn[hr]=We[hr]);function Fd(t){var e=Od&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Td&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Fn:We)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const Nd=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function vd(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,u,i,s;for(let o=0;o<e.length-1;o++){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))u=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Nd?s=!0:u=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),u&&(n="Ctrl-"+n),s&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function Id(t){let e=Object.create(null);for(let n in t)e[vd(n)]=t[n];return e}function pr(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function Pi(t){return new ut({props:{handleKeyDown:vo(t)}})}function vo(t){let e=Id(t);return function(n,r){let u=Fd(r),i,s=e[pr(u,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(u.length==1&&u!=" "){if(r.shiftKey){let o=e[pr(u,r,!1)];if(o&&o(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||u.charCodeAt(0)>127)&&(i=We[r.keyCode])&&i!=u){let o=e[pr(i,r)];if(o&&o(n.state,n.dispatch,n))return!0}}return!1}}var Nn=200,z=function(){};z.prototype.append=function(e){return e.length?(e=z.from(e),!this.length&&e||e.length<Nn&&this.leafAppend(e)||this.length<Nn&&e.leafPrepend(this)||this.appendInner(e)):this};z.prototype.prepend=function(e){return e.length?z.from(e).append(this):this};z.prototype.appendInner=function(e){return new Rd(this,e)};z.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?z.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};z.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};z.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};z.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var u=[];return this.forEach(function(i,s){return u.push(e(i,s))},n,r),u};z.from=function(e){return e instanceof z?e:e&&e.length?new Io(e):z.empty};var Io=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(u,i){return u==0&&i==this.length?this:new e(this.values.slice(u,i))},e.prototype.getInner=function(u){return this.values[u]},e.prototype.forEachInner=function(u,i,s,o){for(var l=i;l<s;l++)if(u(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(u,i,s,o){for(var l=i-1;l>=s;l--)if(u(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(u){if(this.length+u.length<=Nn)return new e(this.values.concat(u.flatten()))},e.prototype.leafPrepend=function(u){if(this.length+u.length<=Nn)return new e(u.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(z);z.empty=new Io([]);var Rd=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,u,i,s){var o=this.left.length;if(u<o&&this.left.forEachInner(r,u,Math.min(i,o),s)===!1||i>o&&this.right.forEachInner(r,Math.max(u-o,0),Math.min(this.length,i)-o,s+o)===!1)return!1},e.prototype.forEachInvertedInner=function(r,u,i,s){var o=this.left.length;if(u>o&&this.right.forEachInvertedInner(r,u-o,Math.max(i,o)-o,s+o)===!1||i<o&&this.left.forEachInvertedInner(r,Math.min(u,o),i,s)===!1)return!1},e.prototype.sliceInner=function(r,u){if(r==0&&u==this.length)return this;var i=this.left.length;return u<=i?this.left.slice(r,u):r>=i?this.right.slice(r-i,u-i):this.left.slice(r,i).append(this.right.slice(0,u-i))},e.prototype.leafAppend=function(r){var u=this.right.leafAppend(r);if(u)return new e(this.left,u)},e.prototype.leafPrepend=function(r){var u=this.left.leafPrepend(r);if(u)return new e(u,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(z);const Bd=500;class ce{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let u,i;n&&(u=this.remapping(r,this.items.length),i=u.maps.length);let s=e.tr,o,l,a=[],c=[];return this.items.forEach((f,h)=>{if(!f.step){u||(u=this.remapping(r,h+1),i=u.maps.length),i--,c.push(f);return}if(u){c.push(new pe(f.map));let p=f.step.map(u.slice(i)),d;p&&s.maybeStep(p).doc&&(d=s.mapping.maps[s.mapping.maps.length-1],a.push(new pe(d,void 0,void 0,a.length+c.length))),i--,d&&u.appendMap(d,i)}else s.maybeStep(f.step);if(f.selection)return o=u?f.selection.map(u.slice(i)):f.selection,l=new ce(this.items.slice(0,r).append(c.reverse().concat(a)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:o}}addTransform(e,n,r,u){let i=[],s=this.eventCount,o=this.items,l=!u&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let f=e.steps[c].invert(e.docs[c]),h=new pe(e.mapping.maps[c],f,n),p;(p=l&&l.merge(h))&&(h=p,c?i.pop():o=o.slice(0,o.length-1)),i.push(h),n&&(s++,n=void 0),u||(l=h)}let a=s-r.depth;return a>Pd&&(o=zd(o,a),s-=a),new ce(o.append(i),s)}remapping(e,n){let r=new Vt;return this.items.forEach((u,i)=>{let s=u.mirrorOffset!=null&&i-u.mirrorOffset>=e?r.maps.length-u.mirrorOffset:void 0;r.appendMap(u.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new ce(this.items.append(e.map(n=>new pe(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],u=Math.max(0,this.items.length-n),i=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(h=>{h.selection&&o--},u);let l=n;this.items.forEach(h=>{let p=i.getMirror(--l);if(p==null)return;s=Math.min(s,p);let d=i.maps[p];if(h.step){let m=e.steps[p].invert(e.docs[p]),g=h.selection&&h.selection.map(i.slice(l+1,p));g&&o++,r.push(new pe(d,m,g))}else r.push(new pe(d))},u);let a=[];for(let h=n;h<s;h++)a.push(new pe(i.maps[h]));let c=this.items.slice(0,u).append(a).append(r),f=new ce(c,o);return f.emptyItemCount()>Bd&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,u=[],i=0;return this.items.forEach((s,o)=>{if(o>=e)u.push(s),s.selection&&i++;else if(s.step){let l=s.step.map(n.slice(r)),a=l&&l.getMap();if(r--,a&&n.appendMap(a,r),l){let c=s.selection&&s.selection.map(n.slice(r));c&&i++;let f=new pe(a.invert(),l,c),h,p=u.length-1;(h=u.length&&u[p].merge(f))?u[p]=h:u.push(f)}}else s.map&&r--},this.items.length,0),new ce(z.from(u.reverse()),i)}}ce.empty=new ce(z.empty,0);function zd(t,e){let n;return t.forEach((r,u)=>{if(r.selection&&e--==0)return n=u,!1}),t.slice(n)}class pe{constructor(e,n,r,u){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=u}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new pe(n.getMap().invert(),n,this.selection)}}}class Fe{constructor(e,n,r,u,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=u,this.prevComposition=i}}const Pd=20;function Ld(t,e,n,r){let u=n.getMeta(et),i;if(u)return u.historyState;n.getMeta($d)&&(t=new Fe(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(et))return s.getMeta(et).redo?new Fe(t.done.addTransform(n,void 0,r,gn(e)),t.undone,Li(n.mapping.maps),t.prevTime,t.prevComposition):new Fe(t.done,t.undone.addTransform(n,void 0,r,gn(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let o=n.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=o&&(t.prevTime<(n.time||0)-r.newGroupDelay||!qd(n,t.prevRanges)),a=s?mr(t.prevRanges,n.mapping):Li(n.mapping.maps);return new Fe(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,gn(e)),ce.empty,a,n.time,o??t.prevComposition)}else return(i=n.getMeta("rebased"))?new Fe(t.done.rebased(n,i),t.undone.rebased(n,i),mr(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Fe(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),mr(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function qd(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,u)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&u>=e[i]&&(n=!0)}),n}function Li(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,u,i,s)=>e.push(i,s));return e}function mr(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let u=e.map(t[r],1),i=e.map(t[r+1],-1);u<=i&&n.push(u,i)}return n}function Vd(t,e,n){let r=gn(e),u=et.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),o=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),u,r),l=new Fe(n?o:i.remaining,n?i.remaining:o,null,0,-1);return i.transform.setSelection(s).setMeta(et,{redo:n,historyState:l})}let gr=!1,qi=null;function gn(t){let e=t.plugins;if(qi!=e){gr=!1,qi=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){gr=!0;break}}return gr}const et=new Ss("history"),$d=new Ss("closeHistory");function Wd(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new ut({key:et,state:{init(){return new Fe(ce.empty,ce.empty,null,0,-1)},apply(e,n,r){return Ld(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,u=r=="historyUndo"?vn:r=="historyRedo"?Gt:null;return u?(n.preventDefault(),u(e.state,e.dispatch)):!1}}}})}function Ro(t,e){return(n,r)=>{let u=et.getState(n);if(!u||(t?u.undone:u.done).eventCount==0)return!1;if(r){let i=Vd(u,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const vn=Ro(!1,!0),Gt=Ro(!0,!0),Bo=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Hd(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Jd=(t,e,n)=>{let r=Hd(t,n);if(!r)return!1;let u=zo(r);if(!u){let s=r.blockRange(),o=s&&Yt(s);return o==null?!1:(e&&e(t.tr.lift(s,o).scrollIntoView()),!0)}let i=u.nodeBefore;if(qo(t,u,e,-1))return!0;if(r.parent.content.size==0&&(Dt(i,"end")||w.isSelectable(i)))for(let s=r.depth;;s--){let o=Zr(t.doc,r.before(s),r.after(s),k.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Dt(i,"end")?A.findFrom(l.doc.resolve(l.mapping.map(u.pos,-1)),-1):w.create(l.doc,u.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return i.isAtom&&u.depth==r.depth-1?(e&&e(t.tr.delete(u.pos-i.nodeSize,u.pos).scrollIntoView()),!0):!1};function Dt(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const jd=(t,e,n)=>{let{$head:r,empty:u}=t.selection,i=r;if(!u)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=zo(r)}let s=i&&i.nodeBefore;return!s||!w.isSelectable(s)?!1:(e&&e(t.tr.setSelection(w.create(t.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function zo(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Ud(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Kd=(t,e,n)=>{let r=Ud(t,n);if(!r)return!1;let u=Po(r);if(!u)return!1;let i=u.nodeAfter;if(qo(t,u,e,1))return!0;if(r.parent.content.size==0&&(Dt(i,"start")||w.isSelectable(i))){let s=Zr(t.doc,r.before(),r.after(),k.empty);if(s&&s.slice.size<s.to-s.from){if(e){let o=t.tr.step(s);o.setSelection(Dt(i,"start")?A.findFrom(o.doc.resolve(o.mapping.map(u.pos)),1):w.create(o.doc,o.mapping.map(u.pos))),e(o.scrollIntoView())}return!0}}return i.isAtom&&u.depth==r.depth-1?(e&&e(t.tr.delete(u.pos,u.pos+i.nodeSize).scrollIntoView()),!0):!1},Zd=(t,e,n)=>{let{$head:r,empty:u}=t.selection,i=r;if(!u)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=Po(r)}let s=i&&i.nodeAfter;return!s||!w.isSelectable(s)?!1:(e&&e(t.tr.setSelection(w.create(t.doc,i.pos)).scrollIntoView()),!0)};function Po(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const Pr=(t,e)=>{let n=t.selection,r=n instanceof w,u;if(r){if(n.node.isTextblock||!_t(t.doc,n.from))return!1;u=n.from}else if(u=xs(t.doc,n.from,-1),u==null)return!1;if(e){let i=t.tr.join(u);r&&i.setSelection(w.create(i.doc,u-t.doc.resolve(u).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},Gd=(t,e)=>{let n=t.selection,r;if(n instanceof w){if(n.node.isTextblock||!_t(t.doc,n.to))return!1;r=n.to}else if(r=xs(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},Lr=(t,e)=>{let{$from:n,$to:r}=t.selection,u=n.blockRange(r),i=u&&Yt(u);return i==null?!1:(e&&e(t.tr.lift(u,i).scrollIntoView()),!0)},Qd=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function pu(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const Lo=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let u=n.node(-1),i=n.indexAfter(-1),s=pu(u.contentMatchAt(i));if(!s||!u.canReplaceWith(i,i,s))return!1;if(e){let o=n.after(),l=t.tr.replaceWith(o,o,s.createAndFill());l.setSelection(A.near(l.doc.resolve(o),1)),e(l.scrollIntoView())}return!0},Yd=(t,e)=>{let n=t.selection,{$from:r,$to:u}=n;if(n instanceof te||r.parent.inlineContent||u.parent.inlineContent)return!1;let i=pu(u.parent.contentMatchAt(u.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let s=(!r.parentOffset&&u.index()<u.parent.childCount?r:u).pos,o=t.tr.insert(s,i.createAndFill());o.setSelection(O.create(o.doc,s+1)),e(o.scrollIntoView())}return!0},Xd=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(dt(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let r=n.blockRange(),u=r&&Yt(r);return u==null?!1:(e&&e(t.tr.lift(r,u).scrollIntoView()),!0)};function eh(t){return(e,n)=>{let{$from:r,$to:u}=e.selection;if(e.selection instanceof w&&e.selection.node.isBlock)return!r.parentOffset||!dt(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],s,o,l=!1,a=!1;for(let p=r.depth;;p--)if(r.node(p).isBlock){l=r.end(p)==r.pos+(r.depth-p),a=r.start(p)==r.pos-(r.depth-p),o=pu(r.node(p-1).contentMatchAt(r.indexAfter(p-1))),i.unshift(l&&o?{type:o}:null),s=p;break}else{if(p==1)return!1;i.unshift(null)}let c=e.tr;(e.selection instanceof O||e.selection instanceof te)&&c.deleteSelection();let f=c.mapping.map(r.pos),h=dt(c.doc,f,i.length,i);if(h||(i[0]=o?{type:o}:null,h=dt(c.doc,f,i.length,i)),c.split(f,i.length,i),!l&&a&&r.node(s).type!=o){let p=c.mapping.map(r.before(s)),d=c.doc.resolve(p);o&&r.node(s-1).canReplaceWith(d.index(),d.index()+1,o)&&c.setNodeMarkup(c.mapping.map(r.before(s)),o)}return n&&n(c.scrollIntoView()),!0}}const th=eh(),qr=(t,e)=>{let{$from:n,to:r}=t.selection,u,i=n.sharedDepth(r);return i==0?!1:(u=n.before(i),e&&e(t.tr.setSelection(w.create(t.doc,u))),!0)},nh=(t,e)=>(e&&e(t.tr.setSelection(new te(t.doc))),!0);function rh(t,e,n){let r=e.nodeBefore,u=e.nodeAfter,i=e.index();return!r||!u||!r.type.compatibleContent(u.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(u.isTextblock||_t(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function qo(t,e,n,r){let u=e.nodeBefore,i=e.nodeAfter,s,o,l=u.type.spec.isolating||i.type.spec.isolating;if(!l&&rh(t,e,n))return!0;let a=!l&&e.parent.canReplace(e.index(),e.index()+1);if(a&&(s=(o=u.contentMatchAt(u.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(n){let p=e.pos+i.nodeSize,d=x.empty;for(let b=s.length-1;b>=0;b--)d=x.from(s[b].create(null,d));d=x.from(u.copy(d));let m=t.tr.step(new V(e.pos-1,p,e.pos,p,new k(d,1,0),s.length,!0)),g=m.doc.resolve(p+2*s.length);g.nodeAfter&&g.nodeAfter.type==u.type&&_t(m.doc,g.pos)&&m.join(g.pos),n(m.scrollIntoView())}return!0}let c=i.type.spec.isolating||r>0&&l?null:A.findFrom(e,1),f=c&&c.$from.blockRange(c.$to),h=f&&Yt(f);if(h!=null&&h>=e.depth)return n&&n(t.tr.lift(f,h).scrollIntoView()),!0;if(a&&Dt(i,"start",!0)&&Dt(u,"end")){let p=u,d=[];for(;d.push(p),!p.isTextblock;)p=p.lastChild;let m=i,g=1;for(;!m.isTextblock;m=m.firstChild)g++;if(p.canReplace(p.childCount,p.childCount,m.content)){if(n){let b=x.empty;for(let C=d.length-1;C>=0;C--)b=x.from(d[C].copy(b));let y=t.tr.step(new V(e.pos-d.length,e.pos+i.nodeSize,e.pos+g,e.pos+i.nodeSize-g,new k(b,d.length,0),0,!0));n(y.scrollIntoView())}return!0}}return!1}function Vo(t){return function(e,n){let r=e.selection,u=t<0?r.$from:r.$to,i=u.depth;for(;u.node(i).isInline;){if(!i)return!1;i--}return u.node(i).isTextblock?(n&&n(e.tr.setSelection(O.create(e.doc,t<0?u.start(i):u.end(i)))),!0):!1}}const uh=Vo(-1),ih=Vo(1);function Vr(t,e=null){return function(n,r){let{$from:u,$to:i}=n.selection,s=u.blockRange(i),o=s&&Kr(s,t,e);return o?(r&&r(n.tr.wrap(s,o).scrollIntoView()),!0):!1}}function bn(t,e=null){return function(n,r){let u=!1;for(let i=0;i<n.selection.ranges.length&&!u;i++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[i];n.doc.nodesBetween(s,o,(l,a)=>{if(u)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)u=!0;else{let c=n.doc.resolve(a),f=c.index();u=c.parent.canReplaceWith(f,f+1,t)}})}if(!u)return!1;if(r){let i=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[s];i.setBlockType(o,l,t,e)}r(i.scrollIntoView())}return!0}}function sh(t,e,n,r){for(let u=0;u<e.length;u++){let{$from:i,$to:s}=e[u],o=i.depth==0?t.inlineContent&&t.type.allowsMarkType(n):!1;if(t.nodesBetween(i.pos,s.pos,(l,a)=>{if(o)return!1;o=l.inlineContent&&l.type.allowsMarkType(n)}),o)return!0}return!1}function Ie(t,e=null,n){return function(r,u){let{empty:i,$cursor:s,ranges:o}=r.selection;if(i&&!s||!sh(r.doc,o,t))return!1;if(u)if(s)t.isInSet(r.storedMarks||s.marks())?u(r.tr.removeStoredMark(t)):u(r.tr.addStoredMark(t.create(e)));else{let l,a=r.tr;l=!o.some(c=>r.doc.rangeHasMark(c.$from.pos,c.$to.pos,t));for(let c=0;c<o.length;c++){let{$from:f,$to:h}=o[c];if(!l)a.removeMark(f.pos,h.pos,t);else{let p=f.pos,d=h.pos,m=f.nodeAfter,g=h.nodeBefore,b=m&&m.isText?/^\s*/.exec(m.text)[0].length:0,y=g&&g.isText?/\s*$/.exec(g.text)[0].length:0;p+b<d&&(p+=b,d-=y),a.addMark(p,d,t.create(e))}}u(a.scrollIntoView())}return!0}}function Wn(...t){return function(e,n,r){for(let u=0;u<t.length;u++)if(t[u](e,n,r))return!0;return!1}}let br=Wn(Bo,Jd,jd),Vi=Wn(Bo,Kd,Zd);const _e={Enter:Wn(Qd,Yd,Xd,th),"Mod-Enter":Lo,Backspace:br,"Mod-Backspace":br,"Shift-Backspace":br,Delete:Vi,"Mod-Delete":Vi,"Mod-a":nh},$o={"Ctrl-h":_e.Backspace,"Alt-Backspace":_e["Mod-Backspace"],"Ctrl-d":_e.Delete,"Ctrl-Alt-Backspace":_e["Mod-Delete"],"Alt-Delete":_e["Mod-Delete"],"Alt-d":_e["Mod-Delete"],"Ctrl-a":uh,"Ctrl-e":ih};for(let t in _e)$o[t]=_e[t];const oh=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,lh=oh?$o:_e;function ah(t={}){return new ut({view(e){return new ch(e,t)}})}class ch{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(u=>{let i=s=>{this[u](s)};return e.dom.addEventListener(u,i),{name:u,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r;if(n){let o=e.nodeBefore,l=e.nodeAfter;if(o||l){let a=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0));if(a){let c=a.getBoundingClientRect(),f=o?c.bottom:c.top;o&&l&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:c.left,right:c.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!r){let o=this.editorView.coordsAtPos(this.cursorPos);r={left:o.left-this.width/2,right:o.left+this.width/2,top:o.top,bottom:o.bottom}}let u=this.editorView.dom.offsetParent;this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let i,s;if(!u||u==document.body&&getComputedStyle(u).position=="static")i=-pageXOffset,s=-pageYOffset;else{let o=u.getBoundingClientRect();i=o.left-u.scrollLeft,s=o.top-u.scrollTop}this.element.style.left=r.left-i+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),u=r&&r.type.spec.disableDropCursor,i=typeof u=="function"?u(this.editorView,n,e):u;if(n&&!i){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=ys(this.editorView.state.doc,s,this.editorView.dragging.slice);o!=null&&(s=o)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}class F extends A{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return F.valid(r)?new F(r):A.near(r)}content(){return k.empty}eq(e){return e instanceof F&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new F(e.resolve(n.pos))}getBookmark(){return new mu(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!fh(e)||!dh(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let u=n.contentMatchAt(e.index()).defaultType;return u&&u.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&F.valid(e))return e;let u=e.pos,i=null;for(let s=e.depth;;s--){let o=e.node(s);if(n>0?e.indexAfter(s)<o.childCount:e.index(s)>0){i=o.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;u+=n;let l=e.doc.resolve(u);if(F.valid(l))return l}for(;;){let s=n>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!w.isSelectable(i)){e=e.doc.resolve(u+i.nodeSize*n),r=!1;continue e}break}i=s,u+=n;let o=e.doc.resolve(u);if(F.valid(o))return o}return null}}}F.prototype.visible=!1;F.findFrom=F.findGapCursorFrom;A.jsonID("gapcursor",F);class mu{constructor(e){this.pos=e}map(e){return new mu(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return F.valid(n)?new F(n):A.near(n)}}function fh(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let u=r.child(n-1);;u=u.lastChild){if(u.childCount==0&&!u.inlineContent||u.isAtom||u.type.spec.isolating)return!0;if(u.inlineContent)return!1}}return!0}function dh(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let u=r.child(n);;u=u.firstChild){if(u.childCount==0&&!u.inlineContent||u.isAtom||u.type.spec.isolating)return!0;if(u.inlineContent)return!1}}return!0}function hh(){return new ut({props:{decorations:bh,createSelectionBetween(t,e,n){return e.pos==n.pos&&F.valid(n)?new F(n):null},handleClick:mh,handleKeyDown:ph,handleDOMEvents:{beforeinput:gh}}})}const ph=vo({ArrowLeft:cn("horiz",-1),ArrowRight:cn("horiz",1),ArrowUp:cn("vert",-1),ArrowDown:cn("vert",1)});function cn(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,u,i){let s=r.selection,o=e>0?s.$to:s.$from,l=s.empty;if(s instanceof O){if(!i.endOfTextblock(n)||o.depth==0)return!1;l=!1,o=r.doc.resolve(e>0?o.after():o.before())}let a=F.findGapCursorFrom(o,e,l);return a?(u&&u(r.tr.setSelection(new F(a))),!0):!1}}function mh(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!F.valid(r))return!1;let u=t.posAtCoords({left:n.clientX,top:n.clientY});return u&&u.inside>-1&&w.isSelectable(t.state.doc.nodeAt(u.inside))?!1:(t.dispatch(t.state.tr.setSelection(new F(r))),!0)}function gh(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof F))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let u=x.empty;for(let s=r.length-1;s>=0;s--)u=x.from(r[s].createAndFill(null,u));let i=t.state.tr.replace(n.pos,n.pos,new k(u,0,0));return i.setSelection(O.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function bh(t){if(!(t.selection instanceof F))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",I.create(t.doc,[oe.widget(t.selection.head,e,{key:"gapcursor"})])}function ne(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var u=n[r];typeof u=="string"?t.setAttribute(r,u):u!=null&&(t[r]=u)}e++}for(;e<arguments.length;e++)Wo(t,arguments[e]);return t}function Wo(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)Wo(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const Rt="http://www.w3.org/2000/svg",xh="http://www.w3.org/1999/xlink",$r="ProseMirror-icon";function yh(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n)|0;return e}function kh(t,e){let n=(t.nodeType==9?t:t.ownerDocument)||document,r=n.createElement("div");if(r.className=$r,e.path){let{path:u,width:i,height:s}=e,o="pm-icon-"+yh(u).toString(16);n.getElementById(o)||Ch(t,o,e);let l=r.appendChild(n.createElementNS(Rt,"svg"));l.style.width=i/s+"em",l.appendChild(n.createElementNS(Rt,"use")).setAttributeNS(xh,"href",/([^#]*)/.exec(n.location.toString())[1]+"#"+o)}else if(e.dom)r.appendChild(e.dom.cloneNode(!0));else{let{text:u,css:i}=e;r.appendChild(n.createElement("span")).textContent=u||"",i&&(r.firstChild.style.cssText=i)}return r}function Ch(t,e,n){let[r,u]=t.nodeType==9?[t,t.body]:[t.ownerDocument||document,t],i=r.getElementById($r+"-collection");i||(i=r.createElementNS(Rt,"svg"),i.id=$r+"-collection",i.style.display="none",u.insertBefore(i,u.firstChild));let s=r.createElementNS(Rt,"symbol");s.id=e,s.setAttribute("viewBox","0 0 "+n.width+" "+n.height),s.appendChild(r.createElementNS(Rt,"path")).setAttribute("d",n.path),i.appendChild(s)}const Q="ProseMirror-menu";class he{constructor(e){this.spec=e}render(e){let n=this.spec,r=n.render?n.render(e):n.icon?kh(e.root,n.icon):n.label?ne("div",null,Qt(e,n.label)):null;if(!r)throw new RangeError("MenuItem without icon or label property");if(n.title){const i=typeof n.title=="function"?n.title(e.state):n.title;r.setAttribute("title",Qt(e,i))}n.class&&r.classList.add(n.class),n.css&&(r.style.cssText+=n.css),r.addEventListener("mousedown",i=>{i.preventDefault(),r.classList.contains(Q+"-disabled")||n.run(e.state,e.dispatch,e,i)});function u(i){if(n.select){let o=n.select(i);if(r.style.display=o?"":"none",!o)return!1}let s=!0;if(n.enable&&(s=n.enable(i)||!1,Wr(r,Q+"-disabled",!s)),n.active){let o=s&&n.active(i)||!1;Wr(r,Q+"-active",o)}return!0}return{dom:r,update:u}}}function Qt(t,e){return t._props.translate?t._props.translate(e):e}let Bt={time:0,node:null};function Ho(t){Bt.time=Date.now(),Bt.node=t.target}function Jo(t){return Date.now()-100<Bt.time&&Bt.node&&t.contains(Bt.node)}class $i{constructor(e,n={}){this.options=n,this.options=n||{},this.content=Array.isArray(e)?e:[e]}render(e){let n=jo(this.content,e),r=e.dom.ownerDocument.defaultView||window,u=ne("div",{class:Q+"-dropdown "+(this.options.class||""),style:this.options.css},Qt(e,this.options.label||""));this.options.title&&u.setAttribute("title",Qt(e,this.options.title));let i=ne("div",{class:Q+"-dropdown-wrap"},u),s=null,o=null,l=()=>{s&&s.close()&&(s=null,r.removeEventListener("mousedown",o))};u.addEventListener("mousedown",c=>{c.preventDefault(),Ho(c),s?l():(s=this.expand(i,n.dom),r.addEventListener("mousedown",o=()=>{Jo(i)||l()}))});function a(c){let f=n.update(c);return i.style.display=f?"":"none",f}return{dom:i,update:a}}expand(e,n){let r=ne("div",{class:Q+"-dropdown-menu "+(this.options.class||"")},n),u=!1;function i(){return u?!1:(u=!0,e.removeChild(r),!0)}return e.appendChild(r),{close:i,node:r}}}function jo(t,e){let n=[],r=[];for(let u=0;u<t.length;u++){let{dom:i,update:s}=t[u].render(e);n.push(ne("div",{class:Q+"-dropdown-item"},i)),r.push(s)}return{dom:n,update:Uo(r,n)}}function Uo(t,e){return n=>{let r=!1;for(let u=0;u<t.length;u++){let i=t[u](n);e[u].style.display=i?"":"none",i&&(r=!0)}return r}}class Dh{constructor(e,n={}){this.options=n,this.content=Array.isArray(e)?e:[e]}render(e){let n=jo(this.content,e),r=e.dom.ownerDocument.defaultView||window,u=ne("div",{class:Q+"-submenu-label"},Qt(e,this.options.label||"")),i=ne("div",{class:Q+"-submenu-wrap"},u,ne("div",{class:Q+"-submenu"},n.dom)),s=null;u.addEventListener("mousedown",l=>{l.preventDefault(),Ho(l),Wr(i,Q+"-submenu-wrap-active",!1),s||r.addEventListener("mousedown",s=()=>{Jo(i)||(i.classList.remove(Q+"-submenu-wrap-active"),r.removeEventListener("mousedown",s),s=null)})});function o(l){let a=n.update(l);return i.style.display=a?"":"none",a}return{dom:i,update:o}}}function wh(t,e){let n=document.createDocumentFragment(),r=[],u=[];for(let s=0;s<e.length;s++){let o=e[s],l=[],a=[];for(let c=0;c<o.length;c++){let{dom:f,update:h}=o[c].render(t),p=ne("span",{class:Q+"item"},f);n.appendChild(p),a.push(p),l.push(h)}l.length&&(r.push(Uo(l,a)),s<e.length-1&&u.push(n.appendChild(_h())))}function i(s){let o=!1,l=!1;for(let a=0;a<r.length;a++){let c=r[a](s);a&&(u[a-1].style.display=l&&c?"":"none"),l=c,c&&(o=!0)}return o}return{dom:n,update:i}}function _h(){return ne("span",{class:Q+"separator"})}const ie={join:{width:800,height:900,path:"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z"},lift:{width:1024,height:1024,path:"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z"},selectParentNode:{text:"",css:"font-weight: bold"},undo:{width:1024,height:1024,path:"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z"},redo:{width:1024,height:1024,path:"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z"},strong:{width:805,height:1024,path:"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z"},em:{width:585,height:1024,path:"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z"},code:{width:896,height:1024,path:"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z"},link:{width:951,height:1024,path:"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z"},bulletList:{width:768,height:896,path:"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z"},orderedList:{width:768,height:896,path:"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z"},blockquote:{width:640,height:896,path:"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z"}},Eh=new he({title:"Join with above block",run:Pr,select:t=>Pr(t),icon:ie.join}),Sh=new he({title:"Lift out of enclosing block",run:Lr,select:t=>Lr(t),icon:ie.lift}),Ah=new he({title:"Select parent node",run:qr,select:t=>qr(t),icon:ie.selectParentNode});let Mh=new he({title:"Undo last change",run:vn,enable:t=>vn(t),icon:ie.undo}),Oh=new he({title:"Redo last undone change",run:Gt,enable:t=>Gt(t),icon:ie.redo});function Th(t,e){let n={run(r,u){return Vr(t,e.attrs)(r,u)},select(r){return Vr(t,e.attrs)(r)}};for(let r in e)n[r]=e[r];return new he(n)}function xr(t,e){let n=bn(t,e.attrs),r={run:n,enable(u){return n(u)},active(u){let{$from:i,to:s,node:o}=u.selection;return o?o.hasMarkup(t,e.attrs):s<=i.end()&&i.parent.hasMarkup(t,e.attrs)}};for(let u in e)r[u]=e[u];return new he(r)}function Wr(t,e,n){n?t.classList.add(e):t.classList.remove(e)}const fn="ProseMirror-menubar";function Fh(){if(typeof navigator>"u")return!1;let t=navigator.userAgent;return!/Edge\/\d/.test(t)&&/AppleWebKit/.test(t)&&/Mobile\/\w+/.test(t)}function Nh(t){return new ut({view(e){return new vh(e,t)}})}class vh{constructor(e,n){this.editorView=e,this.options=n,this.spacer=null,this.maxHeight=0,this.widthForMaxHeight=0,this.floating=!1,this.scrollHandler=null,this.wrapper=ne("div",{class:fn+"-wrapper"}),this.menu=this.wrapper.appendChild(ne("div",{class:fn})),this.menu.className=fn,e.dom.parentNode&&e.dom.parentNode.replaceChild(this.wrapper,e.dom),this.wrapper.appendChild(e.dom);let{dom:r,update:u}=wh(this.editorView,this.options.content);if(this.contentUpdate=u,this.menu.appendChild(r),this.update(),n.floating&&!Fh()){this.updateFloat();let i=Bh(this.wrapper);this.scrollHandler=s=>{let o=this.editorView.root;(o.body||o).contains(this.wrapper)?this.updateFloat(s.target.getBoundingClientRect?s.target:void 0):i.forEach(l=>l.removeEventListener("scroll",this.scrollHandler))},i.forEach(s=>s.addEventListener("scroll",this.scrollHandler))}}update(){this.contentUpdate(this.editorView.state),this.floating?this.updateScrollCursor():(this.menu.offsetWidth!=this.widthForMaxHeight&&(this.widthForMaxHeight=this.menu.offsetWidth,this.maxHeight=0),this.menu.offsetHeight>this.maxHeight&&(this.maxHeight=this.menu.offsetHeight,this.menu.style.minHeight=this.maxHeight+"px"))}updateScrollCursor(){let e=this.editorView.root.getSelection();if(!e.focusNode)return;let n=e.getRangeAt(0).getClientRects(),r=n[Ih(e)?0:n.length-1];if(!r)return;let u=this.menu.getBoundingClientRect();if(r.top<u.bottom&&r.bottom>u.top){let i=Rh(this.wrapper);i&&(i.scrollTop-=u.bottom-r.top)}}updateFloat(e){let n=this.wrapper,r=n.getBoundingClientRect(),u=e?Math.max(0,e.getBoundingClientRect().top):0;if(this.floating)if(r.top>=u||r.bottom<this.menu.offsetHeight+10)this.floating=!1,this.menu.style.position=this.menu.style.left=this.menu.style.top=this.menu.style.width="",this.menu.style.display="",this.spacer.parentNode.removeChild(this.spacer),this.spacer=null;else{let i=(n.offsetWidth-n.clientWidth)/2;this.menu.style.left=r.left+i+"px",this.menu.style.display=r.top>(this.editorView.dom.ownerDocument.defaultView||window).innerHeight?"none":"",e&&(this.menu.style.top=u+"px")}else if(r.top<u&&r.bottom>=this.menu.offsetHeight+10){this.floating=!0;let i=this.menu.getBoundingClientRect();this.menu.style.left=i.left+"px",this.menu.style.width=i.width+"px",e&&(this.menu.style.top=u+"px"),this.menu.style.position="fixed",this.spacer=ne("div",{class:fn+"-spacer",style:`height: ${i.height}px`}),n.insertBefore(this.spacer,this.menu)}}destroy(){this.wrapper.parentNode&&this.wrapper.parentNode.replaceChild(this.editorView.dom,this.wrapper)}}function Ih(t){return t.anchorNode==t.focusNode?t.anchorOffset>t.focusOffset:t.anchorNode.compareDocumentPosition(t.focusNode)==Node.DOCUMENT_POSITION_FOLLOWING}function Rh(t){for(let e=t.parentNode;e;e=e.parentNode)if(e.scrollHeight>e.clientHeight)return e}function Bh(t){let e=[t.ownerDocument.defaultView||window];for(let n=t.parentNode;n;n=n.parentNode)e.push(n);return e}function Hr(t,e=null){return function(n,r){let{$from:u,$to:i}=n.selection,s=u.blockRange(i);if(!s)return!1;let o=r?n.tr:null;return zh(o,s,t,e)?(r&&r(o.scrollIntoView()),!0):!1}}function zh(t,e,n,r=null){let u=!1,i=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);i=new Cn(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Cn(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),u=!0}let o=Kr(i,n,r,e);return o?(t&&Ph(t,e,o,u,n),!0):!1}function Ph(t,e,n,r,u){let i=x.empty;for(let c=n.length-1;c>=0;c--)i=x.from(n[c].type.create(n[c].attrs,i));t.step(new V(e.start-(r?2:0),e.end,e.start,e.end,new k(i,0,0),n.length,!0));let s=0;for(let c=0;c<n.length;c++)n[c].type==u&&(s=c+1);let o=n.length-s,l=e.start+n.length-(r?2:0),a=e.parent;for(let c=e.startIndex,f=e.endIndex,h=!0;c<f;c++,h=!1)!h&&dt(t.doc,l,o)&&(t.split(l,o),l+=2*o),l+=a.child(c).nodeSize;return t}function Lh(t,e){return function(n,r){let{$from:u,$to:i,node:s}=n.selection;if(s&&s.isBlock||u.depth<2||!u.sameParent(i))return!1;let o=u.node(-1);if(o.type!=t)return!1;if(u.parent.content.size==0&&u.node(-1).childCount==u.indexAfter(-1)){if(u.depth==3||u.node(-3).type!=t||u.index(-2)!=u.node(-2).childCount-1)return!1;if(r){let f=x.empty,h=u.index(-1)?1:u.index(-2)?2:3;for(let b=u.depth-h;b>=u.depth-3;b--)f=x.from(u.node(b).copy(f));let p=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3;f=f.append(x.from(t.createAndFill()));let d=u.before(u.depth-(h-1)),m=n.tr.replace(d,u.after(-p),new k(f,4-h,0)),g=-1;m.doc.nodesBetween(d,m.doc.content.size,(b,y)=>{if(g>-1)return!1;b.isTextblock&&b.content.size==0&&(g=y+1)}),g>-1&&m.setSelection(A.near(m.doc.resolve(g))),r(m.scrollIntoView())}return!0}let l=i.pos==u.end()?o.contentMatchAt(0).defaultType:null,a=n.tr.delete(u.pos,i.pos),c=l?[null,{type:l}]:void 0;return dt(a.doc,u.pos,2,c)?(r&&r(a.split(u.pos,2,c).scrollIntoView()),!0):!1}}function qh(t){return function(e,n){let{$from:r,$to:u}=e.selection,i=r.blockRange(u,s=>s.childCount>0&&s.firstChild.type==t);return i?n?r.node(i.depth-1).type==t?Vh(e,n,t,i):$h(e,n,i):!0:!1}}function Vh(t,e,n,r){let u=t.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(u.step(new V(i-1,s,i,s,new k(x.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Cn(u.doc.resolve(r.$from.pos),u.doc.resolve(s),r.depth));const o=Yt(r);if(o==null)return!1;u.lift(r,o);let l=u.doc.resolve(u.mapping.map(i,-1)-1);return _t(u.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&u.join(l.pos),e(u.scrollIntoView()),!0}function $h(t,e,n){let r=t.tr,u=n.parent;for(let p=n.end,d=n.endIndex-1,m=n.startIndex;d>m;d--)p-=u.child(d).nodeSize,r.delete(p-1,p+1);let i=r.doc.resolve(n.start),s=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let o=n.startIndex==0,l=n.endIndex==u.childCount,a=i.node(-1),c=i.index(-1);if(!a.canReplace(c+(o?0:1),c+1,s.content.append(l?x.empty:x.from(u))))return!1;let f=i.pos,h=f+s.nodeSize;return r.step(new V(f-(o?1:0),h+(l?1:0),f+1,h-1,new k((o?x.empty:x.from(u.copy(x.empty))).append(l?x.empty:x.from(u.copy(x.empty))),o?0:1,l?0:1),o?0:1)),e(r.scrollIntoView()),!0}function Wh(t){return function(e,n){let{$from:r,$to:u}=e.selection,i=r.blockRange(u,a=>a.childCount>0&&a.firstChild.type==t);if(!i)return!1;let s=i.startIndex;if(s==0)return!1;let o=i.parent,l=o.child(s-1);if(l.type!=t)return!1;if(n){let a=l.lastChild&&l.lastChild.type==o.type,c=x.from(a?t.create():null),f=new k(x.from(t.create(null,x.from(o.type.create(null,c)))),a?3:1,0),h=i.start,p=i.end;n(e.tr.step(new V(h-(a?3:1),p,h,p,f,1,!0)).scrollIntoView())}return!0}}class Je{constructor(e,n,r={}){this.match=e,this.match=e,this.handler=typeof n=="string"?Hh(n):n,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1,this.inCodeMark=r.inCodeMark!==!1}}function Hh(t){return function(e,n,r,u){let i=t;if(n[1]){let s=n[0].lastIndexOf(n[1]);i+=n[0].slice(s+n[1].length),r+=s;let o=r-u;o>0&&(i=n[0].slice(s-o,s)+i,r=u)}return e.tr.insertText(i,r,u)}}const Jh=500;function jh({rules:t}){let e=new ut({state:{init(){return null},apply(n,r){let u=n.getMeta(this);return u||(n.selectionSet||n.docChanged?null:r)}},props:{handleTextInput(n,r,u,i){return Wi(n,r,u,i,t,e)},handleDOMEvents:{compositionend:n=>{setTimeout(()=>{let{$cursor:r}=n.state.selection;r&&Wi(n,r.pos,r.pos,"",t,e)})}}},isInputRules:!0});return e}function Wi(t,e,n,r,u,i){if(t.composing)return!1;let s=t.state,o=s.doc.resolve(e),l=o.parent.textBetween(Math.max(0,o.parentOffset-Jh),o.parentOffset,null,"")+r;for(let a=0;a<u.length;a++){let c=u[a];if(!c.inCodeMark&&o.marks().some(p=>p.type.spec.code))continue;if(o.parent.type.spec.code){if(!c.inCode)continue}else if(c.inCode==="only")continue;let f=c.match.exec(l),h=f&&f[0].length>=r.length&&c.handler(s,f,e-(f[0].length-r.length),n);if(h)return c.undoable&&h.setMeta(i,{transform:h,from:e,to:n,text:r}),t.dispatch(h),!0}return!1}const Uh=(t,e)=>{let n=t.plugins;for(let r=0;r<n.length;r++){let u=n[r],i;if(u.spec.isInputRules&&(i=u.getState(t))){if(e){let s=t.tr,o=i.transform;for(let l=o.steps.length-1;l>=0;l--)s.step(o.steps[l].invert(o.docs[l]));if(i.text){let l=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,t.schema.text(i.text,l))}else s.delete(i.from,i.to);e(s)}return!0}}return!1},Kh=new Je(/--$/,"",{inCodeMark:!1}),Zh=new Je(/\.\.\.$/,"",{inCodeMark:!1}),Gh=new Je(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"",{inCodeMark:!1}),Qh=new Je(/"$/,"",{inCodeMark:!1}),Yh=new Je(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"",{inCodeMark:!1}),Xh=new Je(/'$/,"",{inCodeMark:!1}),ep=[Gh,Qh,Yh,Xh];function gu(t,e,n=null,r){return new Je(t,(u,i,s,o)=>{let l=n instanceof Function?n(i):n,a=u.tr.delete(s,o),c=a.doc.resolve(s),f=c.blockRange(),h=f&&Kr(f,e,l);if(!h)return null;a.wrap(f,h);let p=a.doc.resolve(s-1).nodeBefore;return p&&p.type==e&&_t(a.doc,s-1)&&(!r||r(i,p))&&a.join(s-1),a})}function Ko(t,e,n=null){return new Je(t,(r,u,i,s)=>{let o=r.doc.resolve(i),l=n instanceof Function?n(u):n;return o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),e)?r.tr.delete(i,s).setBlockType(i,i,e,l):null})}const dn="ProseMirror-prompt";function Zo(t){let e=document.body.appendChild(document.createElement("div"));e.className=dn;let n=h=>{e.contains(h.target)||r()};setTimeout(()=>window.addEventListener("mousedown",n),50);let r=()=>{window.removeEventListener("mousedown",n),e.parentNode&&e.parentNode.removeChild(e)},u=[];for(let h in t.fields)u.push(t.fields[h].render());let i=document.createElement("button");i.type="submit",i.className=dn+"-submit",i.textContent="OK";let s=document.createElement("button");s.type="button",s.className=dn+"-cancel",s.textContent="Cancel",s.addEventListener("click",r);let o=e.appendChild(document.createElement("form"));t.title&&(o.appendChild(document.createElement("h5")).textContent=t.title),u.forEach(h=>{o.appendChild(document.createElement("div")).appendChild(h)});let l=o.appendChild(document.createElement("div"));l.className=dn+"-buttons",l.appendChild(i),l.appendChild(document.createTextNode(" ")),l.appendChild(s);let a=e.getBoundingClientRect();e.style.top=(window.innerHeight-a.height)/2+"px",e.style.left=(window.innerWidth-a.width)/2+"px";let c=()=>{let h=tp(t.fields,u);h&&(r(),t.callback(h))};o.addEventListener("submit",h=>{h.preventDefault(),c()}),o.addEventListener("keydown",h=>{h.keyCode==27?(h.preventDefault(),r()):h.keyCode==13&&!(h.ctrlKey||h.metaKey||h.shiftKey)?(h.preventDefault(),c()):h.keyCode==9&&window.setTimeout(()=>{e.contains(document.activeElement)||r()},500)});let f=o.elements[0];f&&f.focus()}function tp(t,e){let n=Object.create(null),r=0;for(let u in t){let i=t[u],s=e[r++],o=i.read(s),l=i.validate(o);if(l)return np(s,l),null;n[u]=i.clean(o)}return n}function np(t,e){let n=t.parentNode,r=n.appendChild(document.createElement("div"));r.style.left=t.offsetLeft+t.offsetWidth+2+"px",r.style.top=t.offsetTop-5+"px",r.className="ProseMirror-invalid",r.textContent=e,setTimeout(()=>n.removeChild(r),1500)}class rp{constructor(e){this.options=e}read(e){return e.value}validateType(e){return null}validate(e){return!e&&this.options.required?"Required field":this.validateType(e)||(this.options.validate?this.options.validate(e):null)}clean(e){return this.options.clean?this.options.clean(e):e}}class zt extends rp{render(){let e=document.createElement("input");return e.type="text",e.placeholder=this.options.label,e.value=this.options.value||"",e.autocomplete="off",e}}function Go(t,e){let n=t.selection.$from;for(let r=n.depth;r>=0;r--){let u=n.index(r);if(n.node(r).canReplaceWith(u,u,e))return!0}return!1}function up(t){return new he({title:"Insert image",label:"Image",enable(e){return Go(e,t)},run(e,n,r){let{from:u,to:i}=e.selection,s=null;e.selection instanceof w&&e.selection.node.type==t&&(s=e.selection.node.attrs),Zo({title:"Insert image",fields:{src:new zt({label:"Location",required:!0,value:s&&s.src}),title:new zt({label:"Title",value:s&&s.title}),alt:new zt({label:"Description",value:s?s.alt:e.doc.textBetween(u,i," ")})},callback(o){r.dispatch(r.state.tr.replaceSelectionWith(t.createAndFill(o))),r.focus()}})}})}function Qo(t,e){let n={label:e.title,run:t};for(let r in e)n[r]=e[r];return!e.enable&&!e.select&&(n[e.enable?"enable":"select"]=r=>t(r)),new he(n)}function Jr(t,e){let{from:n,$from:r,to:u,empty:i}=t.selection;return i?!!e.isInSet(t.storedMarks||r.marks()):t.doc.rangeHasMark(n,u,e)}function yr(t,e){let n={active(r){return Jr(r,t)}};for(let r in e)n[r]=e[r];return Qo(Ie(t),n)}function ip(t){return new he({title:"Add or remove link",icon:ie.link,active(e){return Jr(e,t)},enable(e){return!e.selection.empty},run(e,n,r){if(Jr(e,t))return Ie(t)(e,n),!0;Zo({title:"Create a link",fields:{href:new zt({label:"Link target",required:!0}),title:new zt({label:"Title"})},callback(u){Ie(t,u)(r.state,r.dispatch),r.focus()}})}})}function Hi(t,e){return Qo(Hr(t,e.attrs),e)}function sp(t){let e={},n;(n=t.marks.strong)&&(e.toggleStrong=yr(n,{title:"Toggle strong style",icon:ie.strong})),(n=t.marks.em)&&(e.toggleEm=yr(n,{title:"Toggle emphasis",icon:ie.em})),(n=t.marks.code)&&(e.toggleCode=yr(n,{title:"Toggle code font",icon:ie.code})),(n=t.marks.link)&&(e.toggleLink=ip(n));let r;if((r=t.nodes.image)&&(e.insertImage=up(r)),(r=t.nodes.bullet_list)&&(e.wrapBulletList=Hi(r,{title:"Wrap in bullet list",icon:ie.bulletList})),(r=t.nodes.ordered_list)&&(e.wrapOrderedList=Hi(r,{title:"Wrap in ordered list",icon:ie.orderedList})),(r=t.nodes.blockquote)&&(e.wrapBlockQuote=Th(r,{title:"Wrap in block quote",icon:ie.blockquote})),(r=t.nodes.paragraph)&&(e.makeParagraph=xr(r,{title:"Change to paragraph",label:"Plain"})),(r=t.nodes.code_block)&&(e.makeCodeBlock=xr(r,{title:"Change to code block",label:"Code"})),r=t.nodes.heading)for(let i=1;i<=10;i++)e["makeHead"+i]=xr(r,{title:"Change to heading "+i,label:"Level "+i,attrs:{level:i}});if(r=t.nodes.horizontal_rule){let i=r;e.insertHorizontalRule=new he({title:"Insert horizontal rule",label:"Horizontal rule",enable(s){return Go(s,i)},run(s,o){o(s.tr.replaceSelectionWith(i.create()))}})}let u=i=>i.filter(s=>s);return e.insertMenu=new $i(u([e.insertImage,e.insertHorizontalRule]),{label:"Insert"}),e.typeMenu=new $i(u([e.makeParagraph,e.makeCodeBlock,e.makeHead1&&new Dh(u([e.makeHead1,e.makeHead2,e.makeHead3,e.makeHead4,e.makeHead5,e.makeHead6]),{label:"Heading"})]),{label:"Type..."}),e.inlineMenu=[u([e.toggleStrong,e.toggleEm,e.toggleCode,e.toggleLink])],e.blockMenu=[u([e.wrapBulletList,e.wrapOrderedList,e.wrapBlockQuote,Eh,Sh,Ah])],e.fullMenu=e.inlineMenu.concat([[e.insertMenu,e.typeMenu]],[[Mh,Oh]],e.blockMenu),e}const Ji=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function op(t,e){let n={},r;function u(i,s){if(e){let o=e[i];if(o===!1)return;o&&(i=o)}n[i]=s}if(u("Mod-z",vn),u("Shift-Mod-z",Gt),u("Backspace",Uh),Ji||u("Mod-y",Gt),u("Alt-ArrowUp",Pr),u("Alt-ArrowDown",Gd),u("Mod-BracketLeft",Lr),u("Escape",qr),(r=t.marks.strong)&&(u("Mod-b",Ie(r)),u("Mod-B",Ie(r))),(r=t.marks.em)&&(u("Mod-i",Ie(r)),u("Mod-I",Ie(r))),(r=t.marks.code)&&u("Mod-`",Ie(r)),(r=t.nodes.bullet_list)&&u("Shift-Ctrl-8",Hr(r)),(r=t.nodes.ordered_list)&&u("Shift-Ctrl-9",Hr(r)),(r=t.nodes.blockquote)&&u("Ctrl->",Vr(r)),r=t.nodes.hard_break){let i=r,s=Wn(Lo,(o,l)=>(l&&l(o.tr.replaceSelectionWith(i.create()).scrollIntoView()),!0));u("Mod-Enter",s),u("Shift-Enter",s),Ji&&u("Ctrl-Enter",s)}if((r=t.nodes.list_item)&&(u("Enter",Lh(r)),u("Mod-[",qh(r)),u("Mod-]",Wh(r))),(r=t.nodes.paragraph)&&u("Shift-Ctrl-0",bn(r)),(r=t.nodes.code_block)&&u("Shift-Ctrl-\\",bn(r)),r=t.nodes.heading)for(let i=1;i<=6;i++)u("Shift-Ctrl-"+i,bn(r,{level:i}));if(r=t.nodes.horizontal_rule){let i=r;u("Mod-_",(s,o)=>(o&&o(s.tr.replaceSelectionWith(i.create()).scrollIntoView()),!0))}return n}function lp(t){return gu(/^\s*>\s$/,t)}function ap(t){return gu(/^(\d+)\.\s$/,t,e=>({order:+e[1]}),(e,n)=>n.childCount+n.attrs.order==+e[1])}function cp(t){return gu(/^\s*([-+*])\s$/,t)}function fp(t){return Ko(/^```$/,t)}function dp(t,e){return Ko(new RegExp("^(#{1,"+e+"})\\s$"),t,n=>({level:n[1].length}))}function hp(t){let e=ep.concat(Zh,Kh),n;return(n=t.nodes.blockquote)&&e.push(lp(n)),(n=t.nodes.ordered_list)&&e.push(ap(n)),(n=t.nodes.bullet_list)&&e.push(cp(n)),(n=t.nodes.code_block)&&e.push(fp(n)),(n=t.nodes.heading)&&e.push(dp(n,6)),jh({rules:e})}function pp(t){let e=[hp(t.schema),Pi(op(t.schema,t.mapKeys)),Pi(lh),ah(),hh()];return t.menuBar!==!1&&e.push(Nh({floating:t.floatingMenu!==!1,content:t.menuContent||sp(t.schema).fullMenu})),t.history!==!1&&e.push(Wd()),e.concat(new ut({props:{attributes:{class:"ProseMirror-example-setup-style"}}}))}class Yo{constructor(e,n){this.textarea=e.appendChild(document.createElement("textarea")),this.textarea.value=n}get content(){return this.textarea.value}focus(){this.textarea.focus()}destroy(){this.textarea.remove()}}class mp{constructor(e,n){this.view=new Tc(e,{state:ft.create({doc:wd.parse(n),plugins:pp({schema:No})})})}get content(){return Sd.serialize(this.view.state.doc)}focus(){this.view.focus()}destroy(){this.view.destroy()}}let Xo=document.querySelector("#editor"),Mt=new Yo(Xo,document.querySelector("#content").value);document.querySelectorAll("input[type=radio]").forEach(t=>{t.addEventListener("change",()=>{if(!t.checked)return;let e=t.value=="markdown"?Yo:mp;if(Mt instanceof e)return;let n=Mt.content;Mt.destroy(),Mt=new e(Xo,n),Mt.focus()})});
